<!DOCTYPE html>
<html>
<head>
    <title>svg2planck Demo</title>
    <meta charset='utf-8' />
    <meta name='viewport' content='user-scalable=no' />

    <script src="./pages/planck-with-testbed.min.js"></script>
</head>
<body>
    <script>
    const world = planck.World()
    let testbed
    planck.testbed('svg2planck', _testbed => {
        testbed = _testbed
        testbed.scaleY = 1
        return world
    })

    window.addEventListener('message', ({data: {viewBox, meterPerPixelRatio, worldJson}}) => {
        if(viewBox && viewBox.length === 4) {
            testbed.x = (viewBox[0] + viewBox[2] / 2) * meterPerPixelRatio
            testbed.y = (viewBox[1] + viewBox[3] / 2) * meterPerPixelRatio
            testbed.width = viewBox[2] * meterPerPixelRatio
            testbed.height = viewBox[3] * meterPerPixelRatio
        }
        
        for(let b = world.getBodyList(); b; b = b.getNext()) {
            world.destroyBody(b)
        }
        Object.assign(world, planck.Serializer.fromJson(worldJson))
    }, false);
    </script>
</body>
</html>