/*! For license information please see buildWorld.worker.js.LICENSE.txt */
(()=>{var t={9742:(t,e)=>{"use strict";e.byteLength=function(t){var e=h(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,o=h(t),s=o[0],a=o[1],c=new r(function(t,e,i){return 3*(e+i)/4-i}(0,s,a)),u=0,l=a>0?s-4:s;for(i=0;i<l;i+=4)e=n[t.charCodeAt(i)]<<18|n[t.charCodeAt(i+1)]<<12|n[t.charCodeAt(i+2)]<<6|n[t.charCodeAt(i+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=255&e;return 2===a&&(e=n[t.charCodeAt(i)]<<2|n[t.charCodeAt(i+1)]>>4,c[u++]=255&e),1===a&&(e=n[t.charCodeAt(i)]<<10|n[t.charCodeAt(i+1)]<<4|n[t.charCodeAt(i+2)]>>2,c[u++]=e>>8&255,c[u++]=255&e),c},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,o=[],s=16383,a=0,h=n-r;a<h;a+=s)o.push(c(t,a,a+s>h?h:a+s));return 1===r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),o.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)i[s]=o[s],n[o.charCodeAt(s)]=s;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function c(t,e,n){for(var r,o,s=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8764:(t,e,i)=>{"use strict";const n=i(9742),r=i(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=h,e.SlowBuffer=function(t){return+t!=t&&(t=0),h.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,h.prototype),e}function h(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return c(t,e,i)}function c(t,e,i){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!h.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const i=0|_(t,e);let n=a(i);const r=n.write(t,e);return r!==i&&(n=n.slice(0,r)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(J(t,Uint8Array)){const e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return m(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(J(t,ArrayBuffer)||t&&J(t.buffer,ArrayBuffer))return p(t,e,i);if("undefined"!=typeof SharedArrayBuffer&&(J(t,SharedArrayBuffer)||t&&J(t.buffer,SharedArrayBuffer)))return p(t,e,i);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return h.from(n,e,i);const r=function(t){if(h.isBuffer(t)){const e=0|d(t.length),i=a(e);return 0===i.length||t.copy(i,0,0,e),i}return void 0!==t.length?"number"!=typeof t.length||X(t.length)?a(0):m(t):"Buffer"===t.type&&Array.isArray(t.data)?m(t.data):void 0}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return h.from(t[Symbol.toPrimitive]("string"),e,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function l(t){return u(t),a(t<0?0:0|d(t))}function m(t){const e=t.length<0?0:0|d(t.length),i=a(e);for(let n=0;n<e;n+=1)i[n]=255&t[n];return i}function p(t,e,i){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(i||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i),Object.setPrototypeOf(n,h.prototype),n}function d(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function _(t,e){if(h.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||J(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const i=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;let r=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return W(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return $(t).length;default:if(r)return n?-1:W(t).length;e=(""+e).toLowerCase(),r=!0}}function f(t,e,i){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,i);case"utf8":case"utf-8":return E(this,e,i);case"ascii":return S(this,e,i);case"latin1":case"binary":return I(this,e,i);case"base64":return T(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function v(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),X(i=+i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=h.from(e,n)),h.isBuffer(e))return 0===e.length?-1:g(t,e,i,n,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):g(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function g(t,e,i,n,r){let o,s=1,a=t.length,h=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,h/=2,i/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){let n=-1;for(o=i;o<a;o++)if(c(t,o)===c(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===h)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(i+h>a&&(i=a-h),o=i;o>=0;o--){let i=!0;for(let n=0;n<h;n++)if(c(t,o+n)!==c(e,n)){i=!1;break}if(i)return o}return-1}function b(t,e,i,n){i=Number(i)||0;const r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(X(n))return s;t[i+s]=n}return s}function x(t,e,i,n){return H(W(e,t.length-i),t,i,n)}function A(t,e,i,n){return H(function(t){const e=[];for(let i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function w(t,e,i,n){return H($(e),t,i,n)}function B(t,e,i,n){return H(function(t,e){let i,n,r;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)i=t.charCodeAt(s),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function T(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function E(t,e,i){i=Math.min(t.length,i);const n=[];let r=e;for(;r<i;){const e=t[r];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(r+s<=i){let i,n,a,h;switch(s){case 1:e<128&&(o=e);break;case 2:i=t[r+1],128==(192&i)&&(h=(31&e)<<6|63&i,h>127&&(o=h));break;case 3:i=t[r+1],n=t[r+2],128==(192&i)&&128==(192&n)&&(h=(15&e)<<12|(63&i)<<6|63&n,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:i=t[r+1],n=t[r+2],a=t[r+3],128==(192&i)&&128==(192&n)&&128==(192&a)&&(h=(15&e)<<18|(63&i)<<12|(63&n)<<6|63&a,h>65535&&h<1114112&&(o=h))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),r+=s}return function(t){const e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);let i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=C));return i}(n)}e.kMaxLength=s,h.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),h.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(t,e,i){return c(t,e,i)},Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(t,e,i){return function(t,e,i){return u(t),t<=0?a(t):void 0!==e?"string"==typeof i?a(t).fill(e,i):a(t).fill(e):a(t)}(t,e,i)},h.allocUnsafe=function(t){return l(t)},h.allocUnsafeSlow=function(t){return l(t)},h.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==h.prototype},h.compare=function(t,e){if(J(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),J(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let i=t.length,n=e.length;for(let r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);let i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;const n=h.allocUnsafe(e);let r=0;for(i=0;i<t.length;++i){let e=t[i];if(J(e,Uint8Array))r+e.length>n.length?(h.isBuffer(e)||(e=h.from(e)),e.copy(n,r)):Uint8Array.prototype.set.call(n,e,r);else{if(!h.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,r)}r+=e.length}return n},h.byteLength=_,h.prototype._isBuffer=!0,h.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},h.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},h.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},h.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?E(this,0,t):f.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){let t="";const i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},o&&(h.prototype[o]=h.prototype.inspect),h.prototype.compare=function(t,e,i,n,r){if(J(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;let o=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(e>>>=0);const a=Math.min(o,s),c=this.slice(n,r),u=t.slice(e,i);for(let t=0;t<a;++t)if(c[t]!==u[t]){o=c[t],s=u[t];break}return o<s?-1:s<o?1:0},h.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},h.prototype.indexOf=function(t,e,i){return v(this,t,e,i,!0)},h.prototype.lastIndexOf=function(t,e,i){return v(this,t,e,i,!1)},h.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}const r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return b(this,t,e,i);case"utf8":case"utf-8":return x(this,t,e,i);case"ascii":case"latin1":case"binary":return A(this,t,e,i);case"base64":return w(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function S(t,e,i){let n="";i=Math.min(t.length,i);for(let r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function I(t,e,i){let n="";i=Math.min(t.length,i);for(let r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function M(t,e,i){const n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);let r="";for(let n=e;n<i;++n)r+=K[t[n]];return r}function P(t,e,i){const n=t.slice(e,i);let r="";for(let t=0;t<n.length-1;t+=2)r+=String.fromCharCode(n[t]+256*n[t+1]);return r}function D(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,i,n,r,o){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function L(t,e,i,n,r){q(e,n,r,t,i,7);let o=Number(e&BigInt(4294967295));t[i++]=o,o>>=8,t[i++]=o,o>>=8,t[i++]=o,o>>=8,t[i++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[i++]=s,s>>=8,t[i++]=s,s>>=8,t[i++]=s,s>>=8,t[i++]=s,i}function N(t,e,i,n,r){q(e,n,r,t,i,7);let o=Number(e&BigInt(4294967295));t[i+7]=o,o>>=8,t[i+6]=o,o>>=8,t[i+5]=o,o>>=8,t[i+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[i+3]=s,s>>=8,t[i+2]=s,s>>=8,t[i+1]=s,s>>=8,t[i]=s,i+8}function V(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function R(t,e,i,n,o){return e=+e,i>>>=0,o||V(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function F(t,e,i,n,o){return e=+e,i>>>=0,o||V(t,0,i,8),r.write(t,e,i,n,52,8),i+8}h.prototype.slice=function(t,e){const i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,h.prototype),n},h.prototype.readUintLE=h.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let n=this[t],r=1,o=0;for(;++o<e&&(r*=256);)n+=this[t+o]*r;return n},h.prototype.readUintBE=h.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let n=this[t+--e],r=1;for(;e>0&&(r*=256);)n+=this[t+--e]*r;return n},h.prototype.readUint8=h.prototype.readUInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),this[t]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readBigUInt64LE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,r=this[++t]+256*this[++t]+65536*this[++t]+i*2**24;return BigInt(n)+(BigInt(r)<<BigInt(32))})),h.prototype.readBigUInt64BE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],r=this[++t]*2**24+65536*this[++t]+256*this[++t]+i;return(BigInt(n)<<BigInt(32))+BigInt(r)})),h.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let n=this[t],r=1,o=0;for(;++o<e&&(r*=256);)n+=this[t+o]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*e)),n},h.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let n=e,r=1,o=this[t+--n];for(;n>0&&(r*=256);)o+=this[t+--n]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},h.prototype.readInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){t>>>=0,e||D(t,2,this.length);const i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt16BE=function(t,e){t>>>=0,e||D(t,2,this.length);const i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readBigInt64LE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),h.prototype.readBigInt64BE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+i)})),h.prototype.readFloatLE=function(t,e){return t>>>=0,e||D(t,4,this.length),r.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return t>>>=0,e||D(t,4,this.length),r.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return t>>>=0,e||D(t,8,this.length),r.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return t>>>=0,e||D(t,8,this.length),r.read(this,t,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(t,e,i,n){t=+t,e>>>=0,i>>>=0,n||O(this,t,e,i,Math.pow(2,8*i)-1,0);let r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(t,e,i,n){t=+t,e>>>=0,i>>>=0,n||O(this,t,e,i,Math.pow(2,8*i)-1,0);let r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},h.prototype.writeUint8=h.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,1,255,0),this[e]=255&t,e+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeBigUInt64LE=Z((function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeBigUInt64BE=Z((function(t,e=0){return N(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*i-1);O(this,t,e,i,n-1,-n)}let r=0,o=1,s=0;for(this[e]=255&t;++r<i&&(o*=256);)t<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(t/o>>0)-s&255;return e+i},h.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*i-1);O(this,t,e,i,n-1,-n)}let r=i-1,o=1,s=0;for(this[e+r]=255&t;--r>=0&&(o*=256);)t<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(t/o>>0)-s&255;return e+i},h.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},h.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeBigInt64LE=Z((function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeBigInt64BE=Z((function(t,e=0){return N(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeFloatLE=function(t,e,i){return R(this,t,e,!0,i)},h.prototype.writeFloatBE=function(t,e,i){return R(this,t,e,!1,i)},h.prototype.writeDoubleLE=function(t,e,i){return F(this,t,e,!0,i)},h.prototype.writeDoubleBE=function(t,e,i){return F(this,t,e,!1,i)},h.prototype.copy=function(t,e,i,n){if(!h.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);const r=n-i;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,i,n):Uint8Array.prototype.set.call(t,this.subarray(i,n),e),r},h.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!h.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;let r;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(r=e;r<i;++r)this[r]=t;else{const o=h.isBuffer(t)?t:h.from(t,n),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(r=0;r<i-e;++r)this[r+e]=o[r%s]}return this};const z={};function k(t,e,i){z[t]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function j(t){let e="",i=t.length;const n="-"===t[0]?1:0;for(;i>=n+4;i-=3)e=`_${t.slice(i-3,i)}${e}`;return`${t.slice(0,i)}${e}`}function q(t,e,i,n,r,o){if(t>i||t<e){const n="bigint"==typeof e?"n":"";let r;throw r=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${i}${n}`,new z.ERR_OUT_OF_RANGE("value",r,t)}!function(t,e,i){U(e,"offset"),void 0!==t[e]&&void 0!==t[e+i]||G(e,t.length-(i+1))}(n,r,o)}function U(t,e){if("number"!=typeof t)throw new z.ERR_INVALID_ARG_TYPE(e,"number",t)}function G(t,e,i){if(Math.floor(t)!==t)throw U(t,i),new z.ERR_OUT_OF_RANGE(i||"offset","an integer",t);if(e<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${e}`,t)}k("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),k("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),k("ERR_OUT_OF_RANGE",(function(t,e,i){let n=`The value of "${t}" is out of range.`,r=i;return Number.isInteger(i)&&Math.abs(i)>2**32?r=j(String(i)):"bigint"==typeof i&&(r=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(r=j(r)),r+="n"),n+=` It must be ${e}. Received ${r}`,n}),RangeError);const Y=/[^+/0-9A-Za-z-_]/g;function W(t,e){let i;e=e||1/0;const n=t.length;let r=null;const o=[];for(let s=0;s<n;++s){if(i=t.charCodeAt(s),i>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function $(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(Y,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,i,n){let r;for(r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}function J(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function X(t){return t!=t}const K=function(){const t="0123456789abcdef",e=new Array(256);for(let i=0;i<16;++i){const n=16*i;for(let r=0;r<16;++r)e[n+r]=t[i]+t[r]}return e}();function Z(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}},7187:t=>{"use strict";var e,i="object"==typeof Reflect?Reflect:null,n=i&&"function"==typeof i.apply?i.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};e=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(i,n){function r(){void 0!==o&&t.removeListener("error",o),i([].slice.call(arguments))}var o;"error"!==e&&(o=function(i){t.removeListener(e,r),n(i)},t.once("error",o)),t.once(e,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function c(t,e,i,n){var r,o,s,c;if(a(i),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),o=t._events),s=o[e]),void 0===s)s=o[e]=i,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(r=h(t))>0&&s.length>r&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=u.bind(n);return r.listener=i,n.wrapFn=r,r}function m(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):d(r,r.length)}function p(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function d(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var h=o[t];if(void 0===h)return!1;if("function"==typeof h)n(h,this,e);else{var c=h.length,u=d(h,c);for(i=0;i<c;++i)n(u[i],this,e)}return!0},o.prototype.addListener=function(t,e){return c(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return c(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,l(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,l(this,t,e)),this},o.prototype.removeListener=function(t,e){var i,n,r,o,s;if(a(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===e||i[o].listener===e){s=i[o].listener,r=o;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(r=o[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},o.prototype.listeners=function(t){return m(this,t,!0)},o.prototype.rawListeners=function(t){return m(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},645:(t,e)=>{e.read=function(t,e,i,n,r){var o,s,a=8*r-n-1,h=(1<<a)-1,c=h>>1,u=-7,l=i?r-1:0,m=i?-1:1,p=t[e+l];for(l+=m,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+t[e+l],l+=m,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+t[e+l],l+=m,u-=8);if(0===o)o=1-c;else{if(o===h)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=c}return(p?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var s,a,h,c=8*o-r-1,u=(1<<c)-1,l=u>>1,m=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),(e+=s+l>=1?m/h:m*Math.pow(2,1-l))*h>=2&&(s++,h/=2),s+l>=u?(a=0,s=u):s+l>=1?(a=(e*h-1)*Math.pow(2,r),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,r),s=0));r>=8;t[i+p]=255&a,p+=d,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;t[i+p]=255&s,p+=d,s/=256,c-=8);t[i+p-d]|=128*_}},5717:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}},2129:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=v;var r=i(2274),o=i(4896),s=i(6306),a=i(3766),h=i(5387),c=i(5385),u=i(8850),l=i(5235),m=i(8601),p=i(662),d=(i(2322),v.STATIC="static"),_=v.KINEMATIC="kinematic",f=v.DYNAMIC="dynamic",y={type:d,position:s.zero(),angle:0,linearVelocity:s.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null};function v(t,e){e=o(e,y),n&&r.assert(s.isValid(e.position)),n&&r.assert(s.isValid(e.linearVelocity)),n&&r.assert(h.isFinite(e.angle)),n&&r.assert(h.isFinite(e.angularVelocity)),n&&r.assert(h.isFinite(e.angularDamping)&&e.angularDamping>=0),n&&r.assert(h.isFinite(e.linearDamping)&&e.linearDamping>=0),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=e.userData,this.m_type=e.type,this.m_type==f?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=u.identity(),this.m_xf.p=s.clone(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new c,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new l,this.c_position=new m,this.m_force=s.zero(),this.m_torque=0,this.m_linearVelocity=s.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1}function g(){this.mass=0,this.center=s.zero(),this.I=0}v.prototype._serialize=function(){for(var t=[],e=this.m_fixtureList;e;e=e.m_next)t.push(e);return{type:this.m_type,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:t}},v._deserialize=function(t,e,i){var n=new v(e,t);return t.fixtures.forEach((function(t){var e=i(p,t,n);n._addFixture(e)})),n},v.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},v.prototype.getWorld=function(){return this.m_world},v.prototype.getNext=function(){return this.m_next},v.prototype.setUserData=function(t){this.m_userData=t},v.prototype.getUserData=function(){return this.m_userData},v.prototype.getFixtureList=function(){return this.m_fixtureList},v.prototype.getJointList=function(){return this.m_jointList},v.prototype.getContactList=function(){return this.m_contactList},v.prototype.isStatic=function(){return this.m_type==d},v.prototype.isDynamic=function(){return this.m_type==f},v.prototype.isKinematic=function(){return this.m_type==_},v.prototype.setStatic=function(){return this.setType(d),this},v.prototype.setDynamic=function(){return this.setType(f),this},v.prototype.setKinematic=function(){return this.setType(_),this},v.prototype.getType=function(){return this.m_type},v.prototype.setType=function(t){if(n&&r.assert(t===d||t===_||t===f),n&&r.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==d&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var i=e;e=e.next,this.m_world.destroyContact(i.contact)}this.m_contactList=null;for(var o=this.m_world.m_broadPhase,s=this.m_fixtureList;s;s=s.m_next)for(var a=s.m_proxyCount,h=0;h<a;++h)o.touchProxy(s.m_proxies[h].proxyId)}},v.prototype.isBullet=function(){return this.m_bulletFlag},v.prototype.setBullet=function(t){this.m_bulletFlag=!!t},v.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},v.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},v.prototype.isAwake=function(){return this.m_awakeFlag},v.prototype.setAwake=function(t){t?0==this.m_awakeFlag&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},v.prototype.isActive=function(){return this.m_activeFlag},v.prototype.setActive=function(t){if(n&&r.assert(0==this.isWorldLocked()),t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag)for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.createProxies(e,this.m_xf);else{for(e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.destroyProxies(e);for(var o=this.m_contactList;o;){var s=o;o=o.next,this.m_world.destroyContact(s.contact)}this.m_contactList=null}},v.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},v.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},v.prototype.getTransform=function(){return this.m_xf},v.prototype.setTransform=function(t,e){if(n&&r.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);for(var i=this.m_world.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)o.synchronize(i,this.m_xf,this.m_xf)}},v.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},v.prototype.synchronizeFixtures=function(){var t=u.identity();this.m_sweep.getTransform(t,0);for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.synchronize(e,t,this.m_xf)},v.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.set(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},v.prototype.getPosition=function(){return this.m_xf.p},v.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},v.prototype.getAngle=function(){return this.m_sweep.a},v.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},v.prototype.getWorldCenter=function(){return this.m_sweep.c},v.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},v.prototype.getLinearVelocity=function(){return this.m_linearVelocity},v.prototype.getLinearVelocityFromWorldPoint=function(t){var e=s.sub(t,this.m_sweep.c);return s.add(this.m_linearVelocity,s.cross(this.m_angularVelocity,e))},v.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},v.prototype.setLinearVelocity=function(t){this.m_type!=d&&(s.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.set(t))},v.prototype.getAngularVelocity=function(){return this.m_angularVelocity},v.prototype.setAngularVelocity=function(t){this.m_type!=d&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},v.prototype.getLinearDamping=function(){return this.m_linearDamping},v.prototype.setLinearDamping=function(t){this.m_linearDamping=t},v.prototype.getAngularDamping=function(){return this.m_angularDamping},v.prototype.setAngularDamping=function(t){this.m_angularDamping=t},v.prototype.getGravityScale=function(){return this.m_gravityScale},v.prototype.setGravityScale=function(t){this.m_gravityScale=t},v.prototype.getMass=function(){return this.m_mass},v.prototype.getInertia=function(){return this.m_I+this.m_mass*s.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},v.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.set(this.m_sweep.localCenter)},v.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic())return this.m_sweep.c0.set(this.m_xf.p),this.m_sweep.c.set(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);n&&r.assert(this.isDynamic());for(var t=s.zero(),e=this.m_fixtureList;e;e=e.m_next)if(0!=e.m_density){var i=new g;e.getMassData(i),this.m_mass+=i.mass,t.addMul(i.mass,i.center),this.m_I+=i.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,t.mul(this.m_invMass)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*s.dot(t,t),n&&r.assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var o=s.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_linearVelocity.add(s.cross(this.m_angularVelocity,s.sub(this.m_sweep.c,o)))},v.prototype.setMassData=function(t){if(n&&r.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type==f){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*s.dot(t.center,t.center),n&&r.assert(this.m_I>0),this.m_invI=1/this.m_I);var e=s.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(s.cross(this.m_angularVelocity,s.sub(this.m_sweep.c,e)))}},v.prototype.applyForce=function(t,e,i){this.m_type==f&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=s.cross(s.sub(e,this.m_sweep.c),t)))},v.prototype.applyForceToCenter=function(t,e){this.m_type==f&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},v.prototype.applyTorque=function(t,e){this.m_type==f&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},v.prototype.applyLinearImpulse=function(t,e,i){this.m_type==f&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*s.cross(s.sub(e,this.m_sweep.c),t)))},v.prototype.applyAngularImpulse=function(t,e){this.m_type==f&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},v.prototype.shouldCollide=function(t){if(this.m_type!=f&&t.m_type!=f)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},v.prototype._addFixture=function(t){if(n&&r.assert(0==this.isWorldLocked()),1==this.isWorldLocked())return null;if(this.m_activeFlag){var e=this.m_world.m_broadPhase;t.createProxies(e,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,t.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,t},v.prototype.createFixture=function(t,e){if(n&&r.assert(0==this.isWorldLocked()),1==this.isWorldLocked())return null;var i=new p(this,t,e);return this._addFixture(i),i},v.prototype.destroyFixture=function(t){if(n&&r.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){n&&r.assert(t.m_body==this);var e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else for(var i=this.m_fixtureList;null!=i;){if(i.m_next===t){i.m_next=t.m_next,e=!0;break}i=i.m_next}n&&r.assert(e);for(var o=this.m_contactList;o;){var s=o.contact;o=o.next;var a=s.getFixtureA(),h=s.getFixtureB();t!=a&&t!=h||this.m_world.destroyContact(s)}if(this.m_activeFlag){var c=this.m_world.m_broadPhase;t.destroyProxies(c)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}},v.prototype.getWorldPoint=function(t){return u.mulVec2(this.m_xf,t)},v.prototype.getWorldVector=function(t){return a.mulVec2(this.m_xf.q,t)},v.prototype.getLocalPoint=function(t){return u.mulTVec2(this.m_xf,t)},v.prototype.getLocalVector=function(t){return a.mulTVec2(this.m_xf.q,t)}},8730:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),o=i(5387),s=i(6306),a=i(8850),h=i(6173),c=i(3766),u=i(1099),l=i(226),m=i(8054);function p(t){this.contact=t,this.prev,this.next,this.other}function d(t,e,i,n,r){this.m_nodeA=new p(this),this.m_nodeB=new p(this),this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=n,this.m_evaluateFcn=r,this.m_manifold=new l,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=f(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=y(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=s.zero(),this.v_normalMass=new h,this.v_K=new h,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=s.zero(),this.p_localPoint=s.zero(),this.p_localCenterA=s.zero(),this.p_localCenterB=s.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}function _(){this.rA=s.zero(),this.rB=s.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}function f(t,e){return o.sqrt(t*e)}function y(t,e){return t>e?t:e}t.exports=d,d.prototype.initConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB,o=e.getShape(),a=i.getShape(),h=e.getBody(),c=i.getBody(),u=this.getManifold(),l=u.pointCount;n&&r.assert(l>0),this.v_invMassA=h.m_invMass,this.v_invMassB=c.m_invMass,this.v_invIA=h.m_invI,this.v_invIB=c.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=l,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=h.m_invMass,this.p_invMassB=c.m_invMass,this.p_invIA=h.m_invI,this.p_invIB=c.m_invI,this.p_localCenterA=s.clone(h.m_sweep.localCenter),this.p_localCenterB=s.clone(c.m_sweep.localCenter),this.p_radiusA=o.m_radius,this.p_radiusB=a.m_radius,this.p_type=u.type,this.p_localNormal=s.clone(u.localNormal),this.p_localPoint=s.clone(u.localPoint),this.p_pointCount=l;for(var m=0;m<l;++m){var p=u.points[m],d=this.v_points[m]=new _;t.warmStarting?(d.normalImpulse=t.dtRatio*p.normalImpulse,d.tangentImpulse=t.dtRatio*p.tangentImpulse):(d.normalImpulse=0,d.tangentImpulse=0),d.rA.setZero(),d.rB.setZero(),d.normalMass=0,d.tangentMass=0,d.velocityBias=0,this.p_localPoints[m]=s.clone(p.localPoint)}},d.prototype.getManifold=function(){return this.m_manifold},d.prototype.getWorldManifold=function(t){var e=this.m_fixtureA.getBody(),i=this.m_fixtureB.getBody(),n=this.m_fixtureA.getShape(),r=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),n.m_radius,i.getTransform(),r.m_radius)},d.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},d.prototype.isEnabled=function(){return this.m_enabledFlag},d.prototype.isTouching=function(){return this.m_touchingFlag},d.prototype.getNext=function(){return this.m_next},d.prototype.getFixtureA=function(){return this.m_fixtureA},d.prototype.getFixtureB=function(){return this.m_fixtureB},d.prototype.getChildIndexA=function(){return this.m_indexA},d.prototype.getChildIndexB=function(){return this.m_indexB},d.prototype.flagForFiltering=function(){this.m_filterFlag=!0},d.prototype.setFriction=function(t){this.m_friction=t},d.prototype.getFriction=function(){return this.m_friction},d.prototype.resetFriction=function(){this.m_friction=f(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},d.prototype.setRestitution=function(t){this.m_restitution=t},d.prototype.getRestitution=function(){return this.m_restitution},d.prototype.resetRestitution=function(){this.m_restitution=y(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},d.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},d.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},d.prototype.evaluate=function(t,e,i){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,i,this.m_fixtureB,this.m_indexB)},d.prototype.update=function(t){this.m_enabledFlag=!0;var e=!1,i=this.m_touchingFlag,n=this.m_fixtureA.isSensor(),r=this.m_fixtureB.isSensor(),o=n||r,s=this.m_fixtureA.getBody(),a=this.m_fixtureB.getBody(),h=s.getTransform(),c=a.getTransform();if(o){var u=this.m_fixtureA.getShape(),p=this.m_fixtureB.getShape();e=m.testOverlap(u,this.m_indexA,p,this.m_indexB,h,c),this.m_manifold.pointCount=0}else{var d=this.m_manifold;this.m_manifold=new l,this.evaluate(this.m_manifold,h,c),e=this.m_manifold.pointCount>0;for(var _=0;_<this.m_manifold.pointCount;++_){var f=this.m_manifold.points[_];f.normalImpulse=0,f.tangentImpulse=0;for(var y=0;y<d.pointCount;++y){var v=d.points[y];if(v.id.key==f.id.key){f.normalImpulse=v.normalImpulse,f.tangentImpulse=v.tangentImpulse;break}}}e!=i&&(s.setAwake(!0),a.setAwake(!0))}this.m_touchingFlag=e,0==i&&1==e&&t&&t.beginContact(this),1==i&&0==e&&t&&t.endContact(this),0==o&&e&&t&&t.preSolve(this,d)},d.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)},d.prototype.solvePositionConstraintTOI=function(t,e,i){return this._solvePositionConstraint(t,!0,e,i)},d.prototype._solvePositionConstraint=function(t,e,i,n){var r=this.m_fixtureA,h=this.m_fixtureB,m=r.getBody(),p=h.getBody(),d=(m.c_velocity,p.c_velocity,m.c_position),_=p.c_position,f=s.clone(this.p_localCenterA),y=s.clone(this.p_localCenterB),v=0,g=0;e&&m!=i&&m!=n||(v=this.p_invMassA,g=this.p_invIA);var b=0,x=0;e&&p!=i&&p!=n||(b=this.p_invMassB,x=this.p_invIB);for(var A=s.clone(d.c),w=d.a,B=s.clone(_.c),T=_.a,E=0,C=0;C<this.p_pointCount;++C){var S,I,M,P=a.identity(),D=a.identity();switch(P.q.set(w),D.q.set(T),P.p=s.sub(A,c.mulVec2(P.q,f)),D.p=s.sub(B,c.mulVec2(D.q,y)),this.p_type){case l.e_circles:var O=a.mulVec2(P,this.p_localPoint),L=a.mulVec2(D,this.p_localPoints[0]);(S=s.sub(L,O)).normalize(),I=s.combine(.5,O,.5,L),M=s.dot(s.sub(L,O),S)-this.p_radiusA-this.p_radiusB;break;case l.e_faceA:S=c.mulVec2(P.q,this.p_localNormal);var N=a.mulVec2(P,this.p_localPoint),V=a.mulVec2(D,this.p_localPoints[C]);M=s.dot(s.sub(V,N),S)-this.p_radiusA-this.p_radiusB,I=V;break;case l.e_faceB:S=c.mulVec2(D.q,this.p_localNormal),N=a.mulVec2(D,this.p_localPoint),V=a.mulVec2(P,this.p_localPoints[C]),M=s.dot(s.sub(V,N),S)-this.p_radiusA-this.p_radiusB,I=V,S.mul(-1)}var R=s.sub(I,A),F=s.sub(I,B);E=o.min(E,M);var z=e?u.toiBaugarte:u.baumgarte,k=u.linearSlop,j=u.maxLinearCorrection,q=o.clamp(z*(M+k),-j,0),U=s.cross(R,S),G=s.cross(F,S),Y=v+b+g*U*U+x*G*G,W=Y>0?-q/Y:0,$=s.mul(W,S);A.subMul(v,$),w-=g*s.cross(R,$),B.addMul(b,$),T+=x*s.cross(F,$)}return d.c.set(A),d.a=w,_.c.set(B),_.a=T,E},d.prototype.initVelocityConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB,o=e.getBody(),h=i.getBody(),l=o.c_velocity,m=h.c_velocity,p=o.c_position,d=h.c_position,_=this.p_radiusA,f=this.p_radiusB,y=this.getManifold(),v=this.v_invMassA,g=this.v_invMassB,b=this.v_invIA,x=this.v_invIB,A=s.clone(this.p_localCenterA),w=s.clone(this.p_localCenterB),B=s.clone(p.c),T=p.a,E=s.clone(l.v),C=l.w,S=s.clone(d.c),I=d.a,M=s.clone(m.v),P=m.w;n&&r.assert(y.pointCount>0);var D=a.identity(),O=a.identity();D.q.set(T),O.q.set(I),D.p.setCombine(1,B,-1,c.mulVec2(D.q,A)),O.p.setCombine(1,S,-1,c.mulVec2(O.q,w));var L=y.getWorldManifold(null,D,_,O,f);this.v_normal.set(L.normal);for(var N=0;N<this.v_pointCount;++N){var V=this.v_points[N];V.rA.set(s.sub(L.points[N],B)),V.rB.set(s.sub(L.points[N],S));var R=s.cross(V.rA,this.v_normal),F=s.cross(V.rB,this.v_normal),z=v+g+b*R*R+x*F*F;V.normalMass=z>0?1/z:0;var k=s.cross(this.v_normal,1),j=s.cross(V.rA,k),q=s.cross(V.rB,k),U=v+g+b*j*j+x*q*q;V.tangentMass=U>0?1/U:0,V.velocityBias=0;var G=s.dot(this.v_normal,M)+s.dot(this.v_normal,s.cross(P,V.rB))-s.dot(this.v_normal,E)-s.dot(this.v_normal,s.cross(C,V.rA));G<-u.velocityThreshold&&(V.velocityBias=-this.v_restitution*G)}if(2==this.v_pointCount&&t.blockSolve){var Y=this.v_points[0],W=this.v_points[1],$=s.cross(Y.rA,this.v_normal),H=s.cross(Y.rB,this.v_normal),J=s.cross(W.rA,this.v_normal),X=s.cross(W.rB,this.v_normal),K=v+g+b*$*$+x*H*H,Z=v+g+b*J*J+x*X*X,Q=v+g+b*$*J+x*H*X;K*K<1e3*(K*Z-Q*Q)?(this.v_K.ex.set(K,Q),this.v_K.ey.set(Q,Z),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}p.c.set(B),p.a=T,l.v.set(E),l.w=C,d.c.set(S),d.a=I,m.v.set(M),m.w=P},d.prototype.warmStartConstraint=function(t){for(var e=this.m_fixtureA,i=this.m_fixtureB,n=e.getBody(),r=i.getBody(),o=n.c_velocity,a=r.c_velocity,h=(n.c_position,r.c_position,this.v_invMassA),c=this.v_invIA,u=this.v_invMassB,l=this.v_invIB,m=s.clone(o.v),p=o.w,d=s.clone(a.v),_=a.w,f=this.v_normal,y=s.cross(f,1),v=0;v<this.v_pointCount;++v){var g=this.v_points[v],b=s.combine(g.normalImpulse,f,g.tangentImpulse,y);p-=c*s.cross(g.rA,b),m.subMul(h,b),_+=l*s.cross(g.rB,b),d.addMul(u,b)}o.v.set(m),o.w=p,a.v.set(d),a.w=_},d.prototype.storeConstraintImpulses=function(t){for(var e=this.m_manifold,i=0;i<this.v_pointCount;++i)e.points[i].normalImpulse=this.v_points[i].normalImpulse,e.points[i].tangentImpulse=this.v_points[i].tangentImpulse},d.prototype.solveVelocityConstraint=function(t){var e=this.m_fixtureA.m_body,i=this.m_fixtureB.m_body,a=e.c_velocity,c=(e.c_position,i.c_velocity),u=(i.c_position,this.v_invMassA),l=this.v_invIA,m=this.v_invMassB,p=this.v_invIB,d=s.clone(a.v),_=a.w,f=s.clone(c.v),y=c.w,v=this.v_normal,g=s.cross(v,1),b=this.v_friction;n&&r.assert(1==this.v_pointCount||2==this.v_pointCount);for(var x=0;x<this.v_pointCount;++x){var A=this.v_points[x];(S=s.zero()).addCombine(1,f,1,s.cross(y,A.rB)),S.subCombine(1,d,1,s.cross(_,A.rA));var w=s.dot(S,g)-this.v_tangentSpeed,B=A.tangentMass*-w,T=b*A.normalImpulse;B=(I=o.clamp(A.tangentImpulse+B,-T,T))-A.tangentImpulse,A.tangentImpulse=I;var E=s.mul(B,g);d.subMul(u,E),_-=l*s.cross(A.rA,E),f.addMul(m,E),y+=p*s.cross(A.rB,E)}if(1==this.v_pointCount||0==t.blockSolve)for(var C=0;C<this.v_pointCount;++C){var S;A=this.v_points[C],(S=s.zero()).addCombine(1,f,1,s.cross(y,A.rB)),S.subCombine(1,d,1,s.cross(_,A.rA));var I,M=s.dot(S,v);B=-A.normalMass*(M-A.velocityBias),B=(I=o.max(A.normalImpulse+B,0))-A.normalImpulse,A.normalImpulse=I,E=s.mul(B,v),d.subMul(u,E),_-=l*s.cross(A.rA,E),f.addMul(m,E),y+=p*s.cross(A.rB,E)}else{var P=this.v_points[0],D=this.v_points[1],O=s.neo(P.normalImpulse,D.normalImpulse);n&&r.assert(O.x>=0&&O.y>=0);var L=s.zero().add(f).add(s.cross(y,P.rB)).sub(d).sub(s.cross(_,P.rA)),N=s.zero().add(f).add(s.cross(y,D.rB)).sub(d).sub(s.cross(_,D.rA)),V=s.dot(L,v),R=s.dot(N,v),F=s.neo(V-P.velocityBias,R-D.velocityBias);for(F.sub(h.mulVec2(this.v_K,O));;){var z=h.mulVec2(this.v_normalMass,F).neg();if(z.x>=0&&z.y>=0){var k=s.sub(z,O),j=s.mul(k.x,v),q=s.mul(k.y,v);d.subCombine(u,j,u,q),_-=l*(s.cross(P.rA,j)+s.cross(D.rA,q)),f.addCombine(m,j,m,q),y+=p*(s.cross(P.rB,j)+s.cross(D.rB,q)),P.normalImpulse=z.x,D.normalImpulse=z.y;break}if(z.x=-P.normalMass*F.x,z.y=0,V=0,R=this.v_K.ex.y*z.x+F.y,z.x>=0&&R>=0){k=s.sub(z,O),j=s.mul(k.x,v),q=s.mul(k.y,v),d.subCombine(u,j,u,q),_-=l*(s.cross(P.rA,j)+s.cross(D.rA,q)),f.addCombine(m,j,m,q),y+=p*(s.cross(P.rB,j)+s.cross(D.rB,q)),P.normalImpulse=z.x,D.normalImpulse=z.y;break}if(z.x=0,z.y=-D.normalMass*F.y,V=this.v_K.ey.x*z.y+F.x,R=0,z.y>=0&&V>=0){k=s.sub(z,O),j=s.mul(k.x,v),q=s.mul(k.y,v),d.subCombine(u,j,u,q),_-=l*(s.cross(P.rA,j)+s.cross(D.rA,q)),f.addCombine(m,j,m,q),y+=p*(s.cross(P.rB,j)+s.cross(D.rB,q)),P.normalImpulse=z.x,D.normalImpulse=z.y;break}if(z.x=0,z.y=0,V=F.x,R=F.y,V>=0&&R>=0){k=s.sub(z,O),j=s.mul(k.x,v),q=s.mul(k.y,v),d.subCombine(u,j,u,q),_-=l*(s.cross(P.rA,j)+s.cross(D.rA,q)),f.addCombine(m,j,m,q),y+=p*(s.cross(P.rB,j)+s.cross(D.rB,q)),P.normalImpulse=z.x,D.normalImpulse=z.y;break}break}}a.v.set(d),a.w=_,c.v.set(f),c.w=y};var v=[];d.addType=function(t,e,i){v[t]=v[t]||{},v[t][e]=i},d.create=function(t,e,i,n){var r,o,s=t.getType(),a=i.getType();if(o=v[s]&&v[s][a])r=new d(t,e,i,n,o);else{if(!(o=v[a]&&v[a][s]))return null;r=new d(i,n,t,e,o)}t=r.getFixtureA(),i=r.getFixtureB(),e=r.getChildIndexA(),n=r.getChildIndexB();var h=t.getBody(),c=i.getBody();return r.m_nodeA.contact=r,r.m_nodeA.other=c,r.m_nodeA.prev=null,r.m_nodeA.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=r.m_nodeA),h.m_contactList=r.m_nodeA,r.m_nodeB.contact=r,r.m_nodeB.other=h,r.m_nodeB.prev=null,r.m_nodeB.next=c.m_contactList,null!=c.m_contactList&&(c.m_contactList.prev=r.m_nodeB),c.m_contactList=r.m_nodeB,0==t.isSensor()&&0==i.isSensor()&&(h.setAwake(!0),c.setAwake(!0)),r},d.destroy=function(t,e){var i=t.m_fixtureA,n=t.m_fixtureB,r=i.getBody(),o=n.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==r.m_contactList&&(r.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==o.m_contactList&&(o.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&0==i.isSensor()&&0==n.isSensor()&&(r.setAwake(!0),o.setAwake(!0));var s=i.getType(),a=n.getType(),h=v[s][a].destroyFcn;"function"==typeof h&&h(t)}},662:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var r=i(2274),o=i(4896),s=i(5387),a=i(6306),h=i(3406),c=i(2322),u={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function l(t,e){this.aabb=new h,this.fixture=t,this.childIndex=e,this.proxyId}function m(t,e,i){e.shape?(i=e,e=e.shape):"number"==typeof i&&(i={density:i}),i=o(i,u),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var n=this.m_shape.getChildCount(),r=0;r<n;++r)this.m_proxies[r]=new l(this,r);this.m_userData=i.userData}m.prototype._reset=function(){var t=this.getBody(),e=t.m_world.m_broadPhase;this.destroyProxies(e),this.m_shape._reset&&this.m_shape._reset();for(var i=this.m_shape.getChildCount(),n=0;n<i;++n)this.m_proxies[n]=new l(this,n);this.createProxies(e,t.m_xf),t.resetMassData()},m.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}},m._deserialize=function(t,e,i){var n=i(c,t.shape);return n&&new m(e,n,t)},m.prototype.getType=function(){return this.m_shape.getType()},m.prototype.getShape=function(){return this.m_shape},m.prototype.isSensor=function(){return this.m_isSensor},m.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},m.prototype.getUserData=function(){return this.m_userData},m.prototype.setUserData=function(t){this.m_userData=t},m.prototype.getBody=function(){return this.m_body},m.prototype.getNext=function(){return this.m_next},m.prototype.getDensity=function(){return this.m_density},m.prototype.setDensity=function(t){n&&r.assert(s.isFinite(t)&&t>=0),this.m_density=t},m.prototype.getFriction=function(){return this.m_friction},m.prototype.setFriction=function(t){this.m_friction=t},m.prototype.getRestitution=function(){return this.m_restitution},m.prototype.setRestitution=function(t){this.m_restitution=t},m.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},m.prototype.rayCast=function(t,e,i){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),i)},m.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},m.prototype.getAABB=function(t){return n&&r.assert(0<=t&&t<this.m_proxyCount),this.m_proxies[t].aabb},m.prototype.createProxies=function(t,e){n&&r.assert(0==this.m_proxyCount),this.m_proxyCount=this.m_shape.getChildCount();for(var i=0;i<this.m_proxyCount;++i){var o=this.m_proxies[i];this.m_shape.computeAABB(o.aabb,e,i),o.proxyId=t.createProxy(o.aabb,o)}},m.prototype.destroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var i=this.m_proxies[e];t.destroyProxy(i.proxyId),i.proxyId=null}this.m_proxyCount=0},m.prototype.synchronize=function(t,e,i){for(var n=0;n<this.m_proxyCount;++n){var r=this.m_proxies[n],o=new h,s=new h;this.m_shape.computeAABB(o,e,r.childIndex),this.m_shape.computeAABB(s,i,r.childIndex),r.aabb.combine(o,s);var c=a.sub(i.p,e.p);t.moveProxy(r.proxyId,r.aabb,c)}},m.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},m.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},m.prototype.setFilterGroupIndex=function(t){return this.m_filterGroupIndex=t},m.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},m.prototype.setFilterCategoryBits=function(t){this.m_filterCategoryBits=t},m.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},m.prototype.setFilterMaskBits=function(t){this.m_filterMaskBits=t},m.prototype.refilter=function(){if(null!=this.m_body){for(var t=this.m_body.getContactList();t;){var e=t.contact,i=e.getFixtureA(),n=e.getFixtureB();i!=this&&n!=this||e.flagForFiltering(),t=t.next}var r=this.m_body.getWorld();if(null!=r)for(var o=r.m_broadPhase,s=0;s<this.m_proxyCount;++s)o.touchProxy(this.m_proxies[s].proxyId)}},m.prototype.shouldCollide=function(t){return t.m_filterGroupIndex==this.m_filterGroupIndex&&0!=t.m_filterGroupIndex?t.m_filterGroupIndex>0:0!=(t.m_filterMaskBits&this.m_filterCategoryBits)&&0!=(t.m_filterCategoryBits&this.m_filterMaskBits)}},5878:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=s;var r=i(2274);function o(){this.other=null,this.joint=null,this.prev=null,this.next=null}function s(t,e,i){e=t.bodyA||e,i=t.bodyB||i,n&&r.assert(e),n&&r.assert(i),n&&r.assert(e!=i),this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=i,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new o,this.m_edgeB=new o,this.m_islandFlag=!1,this.m_userData=t.userData}s.TYPES={},s._deserialize=function(t,e,i){var n=s.TYPES[t.type];return n&&i(n,t)},s.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},s.prototype.getType=function(){return this.m_type},s.prototype.getBodyA=function(){return this.m_bodyA},s.prototype.getBodyB=function(){return this.m_bodyB},s.prototype.getNext=function(){return this.m_next},s.prototype.getUserData=function(){return this.m_userData},s.prototype.setUserData=function(t){this.m_userData=t},s.prototype.getCollideConnected=function(){return this.m_collideConnected},s.prototype.getAnchorA=function(){},s.prototype.getAnchorB=function(){},s.prototype.getReactionForce=function(t){},s.prototype.getReactionTorque=function(t){},s.prototype.shiftOrigin=function(t){},s.prototype.initVelocityConstraints=function(t){},s.prototype.solveVelocityConstraints=function(t){},s.prototype.solvePositionConstraints=function(t){}},226:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,i(2274);var n=i(6306),r=i(8850),o=i(5387),s=i(3766);function a(){this.type,this.localNormal=n.zero(),this.localPoint=n.zero(),this.points=[new h,new h],this.pointCount=0}function h(){this.localPoint=n.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new c}function c(){this.cf=new u}function u(){this.indexA,this.indexB,this.typeA,this.typeB}function l(){this.normal,this.points=[],this.separations=[]}t.exports=a,t.exports.clipSegmentToLine=function(t,e,i,r,o){var s=0,h=n.dot(i,e[0].v)-r,c=n.dot(i,e[1].v)-r;if(h<=0&&t[s++].set(e[0]),c<=0&&t[s++].set(e[1]),h*c<0){var u=h/(h-c);t[s].v.setCombine(1-u,e[0].v,u,e[1].v),t[s].id.cf.indexA=o,t[s].id.cf.indexB=e[0].id.cf.indexB,t[s].id.cf.typeA=a.e_vertex,t[s].id.cf.typeB=a.e_face,++s}return s},t.exports.clipVertex=p,t.exports.getPointStates=function(t,e,i,n){for(var r=0;r<i.pointCount;++r){var o=i.points[r].id;t[r]=m.removeState;for(var s=0;s<n.pointCount;++s)if(n.points[s].id.key==o.key){t[r]=m.persistState;break}}for(r=0;r<n.pointCount;++r)for(o=n.points[r].id,e[r]=m.addState,s=0;s<i.pointCount;++s)if(i.points[s].id.key==o.key){e[r]=m.persistState;break}},t.exports.PointState=m,a.e_circles=0,a.e_faceA=1,a.e_faceB=2,a.e_vertex=0,a.e_face=1,Object.defineProperty(c.prototype,"key",{get:function(){return this.cf.indexA+4*this.cf.indexB+16*this.cf.typeA+64*this.cf.typeB},enumerable:!0,configurable:!0}),c.prototype.set=function(t){this.cf.set(t.cf)},u.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB},a.prototype.getWorldManifold=function(t,e,i,h,c){if(0!=this.pointCount){var u=(t=t||new l).normal,m=t.points,p=t.separations;switch(this.type){case a.e_circles:u=n.neo(1,0);var d=r.mulVec2(e,this.localPoint),_=r.mulVec2(h,this.points[0].localPoint),f=n.sub(_,d);n.lengthSquared(f)>o.EPSILON*o.EPSILON&&(u.set(f),u.normalize());var y=d.clone().addMul(i,u),v=_.clone().addMul(-c,u);m[0]=n.mid(y,v),p[0]=n.dot(n.sub(v,y),u),m.length=1,p.length=1;break;case a.e_faceA:u=s.mulVec2(e.q,this.localNormal);for(var g=r.mulVec2(e,this.localPoint),b=0;b<this.pointCount;++b){var x=r.mulVec2(h,this.points[b].localPoint);y=n.clone(x).addMul(i-n.dot(n.sub(x,g),u),u),v=n.clone(x).subMul(c,u),m[b]=n.mid(y,v),p[b]=n.dot(n.sub(v,y),u)}m.length=this.pointCount,p.length=this.pointCount;break;case a.e_faceB:for(u=s.mulVec2(h.q,this.localNormal),g=r.mulVec2(h,this.localPoint),b=0;b<this.pointCount;++b)x=r.mulVec2(e,this.points[b].localPoint),v=n.combine(1,x,c-n.dot(n.sub(x,g),u),u),y=n.combine(1,x,-i,u),m[b]=n.mid(y,v),p[b]=n.dot(n.sub(y,v),u);m.length=this.pointCount,p.length=this.pointCount,u.mul(-1)}return t.normal=u,t.points=m,t.separations=p,t}};var m={nullState:0,addState:1,persistState:2,removeState:3};function p(){this.v=n.zero(),this.id=new c}p.prototype.set=function(t){this.v.set(t.v),this.id.set(t.id)}},1099:(t,e)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;var i=e;i.maxManifoldPoints=2,i.maxPolygonVertices=12,i.aabbExtension=.1,i.aabbMultiplier=2,i.linearSlop=.005,i.linearSlopSquared=i.linearSlop*i.linearSlop,i.angularSlop=2/180*Math.PI,i.polygonRadius=2*i.linearSlop,i.maxSubSteps=8,i.maxTOIContacts=32,i.maxTOIIterations=20,i.maxDistnceIterations=20,i.velocityThreshold=1,i.maxLinearCorrection=.2,i.maxAngularCorrection=8/180*Math.PI,i.maxTranslation=2,i.maxTranslationSquared=i.maxTranslation*i.maxTranslation,i.maxRotation=.5*Math.PI,i.maxRotationSquared=i.maxRotation*i.maxRotation,i.baumgarte=.2,i.toiBaugarte=.75,i.timeToSleep=.5,i.linearSleepTolerance=.01,i.linearSleepToleranceSqr=Math.pow(i.linearSleepTolerance,2),i.angularSleepTolerance=2/180*Math.PI,i.angularSleepToleranceSqr=Math.pow(i.angularSleepTolerance,2)},2322:(t,e,i)=>{function n(){this.m_type,this.m_radius}"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=n,i(5387),n.prototype._reset=function(){},n.prototype._serialize=function(){return{}},n.TYPES={},n._deserialize=function(t,e,i){var r=n.TYPES[t.type];return r&&i(r,t)},n.isValid=function(t){return!!t},n.prototype.getRadius=function(){return this.m_radius},n.prototype.getType=function(){return this.m_type},n.prototype._clone=function(){},n.prototype.getChildCount=function(){},n.prototype.testPoint=function(t,e){},n.prototype.rayCast=function(t,e,i,n){},n.prototype.computeAABB=function(t,e,i){},n.prototype.computeMass=function(t,e){},n.prototype.computeDistanceProxy=function(t){}},2260:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=y,t.exports.TimeStep=f;var o=i(1099),s=i(2274),a=i(6306),h=i(5387),c=i(2129),u=i(8730),l=i(5878),m=i(8650),p=m.Input,d=m.Output,_=i(8054);function f(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}function y(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}_.Input,_.Output,_.Proxy,_.Cache,f.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},y.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},y.prototype.addBody=function(t){r&&s.assert(t instanceof c,"Not a Body!",t),this.m_bodies.push(t)},y.prototype.addContact=function(t){r&&s.assert(t instanceof u,"Not a Contact!",t),this.m_contacts.push(t)},y.prototype.addJoint=function(t){r&&s.assert(t instanceof l,"Not a Joint!",t),this.m_joints.push(t)},y.prototype.solveWorld=function(t){for(var e=this.m_world,i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1;for(var n=e.m_contactList;n;n=n.m_next)n.m_islandFlag=!1;for(var o=e.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var a=this.m_stack,h=e.m_bodyList;h;h=h.m_next)if(!h.m_islandFlag&&0!=h.isAwake()&&0!=h.isActive()&&!h.isStatic()){for(this.clear(),a.push(h),h.m_islandFlag=!0;a.length>0;)if(i=a.pop(),r&&s.assert(1==i.isActive()),this.addBody(i),i.setAwake(!0),!i.isStatic()){for(var c=i.m_contactList;c;c=c.next){var u=c.contact;if(!u.m_islandFlag&&0!=u.isEnabled()&&0!=u.isTouching()){var l=u.m_fixtureA.m_isSensor,m=u.m_fixtureB.m_isSensor;l||m||(this.addContact(u),u.m_islandFlag=!0,(d=c.other).m_islandFlag||(a.push(d),d.m_islandFlag=!0))}}for(var p=i.m_jointList;p;p=p.next){var d;1!=p.joint.m_islandFlag&&0!=(d=p.other).isActive()&&(this.addJoint(p.joint),p.joint.m_islandFlag=!0,d.m_islandFlag||(a.push(d),d.m_islandFlag=!0))}}this.solveIsland(t);for(var _=0;_<this.m_bodies.length;++_)(i=this.m_bodies[_]).isStatic()&&(i.m_islandFlag=!1)}},y.prototype.solveIsland=function(t){for(var e=this.m_world,i=e.m_gravity,r=e.m_allowSleep,s=t.dt,c=0;c<this.m_bodies.length;++c){var u=this.m_bodies[c],l=a.clone(u.m_sweep.c),m=u.m_sweep.a,p=a.clone(u.m_linearVelocity),d=u.m_angularVelocity;u.m_sweep.c0.set(u.m_sweep.c),u.m_sweep.a0=u.m_sweep.a,u.isDynamic()&&(p.addMul(s*u.m_gravityScale,i),p.addMul(s*u.m_invMass,u.m_force),d+=s*u.m_invI*u.m_torque,p.mul(1/(1+s*u.m_linearDamping)),d*=1/(1+s*u.m_angularDamping)),u.c_position.c=l,u.c_position.a=m,u.c_velocity.v=p,u.c_velocity.w=d}for(c=0;c<this.m_contacts.length;++c)this.m_contacts[c].initConstraint(t);for(n&&this.printBodies("M: "),c=0;c<this.m_contacts.length;++c)this.m_contacts[c].initVelocityConstraint(t);if(n&&this.printBodies("R: "),t.warmStarting)for(c=0;c<this.m_contacts.length;++c)this.m_contacts[c].warmStartConstraint(t);for(n&&this.printBodies("Q: "),c=0;c<this.m_joints.length;++c)this.m_joints[c].initVelocityConstraints(t);for(n&&this.printBodies("E: "),c=0;c<t.velocityIterations;++c){for(var _=0;_<this.m_joints.length;++_)this.m_joints[_].solveVelocityConstraints(t);for(_=0;_<this.m_contacts.length;++_)this.m_contacts[_].solveVelocityConstraint(t)}for(n&&this.printBodies("D: "),c=0;c<this.m_contacts.length;++c)this.m_contacts[c].storeConstraintImpulses(t);for(n&&this.printBodies("C: "),c=0;c<this.m_bodies.length;++c){u=this.m_bodies[c],l=a.clone(u.c_position.c),m=u.c_position.a,p=a.clone(u.c_velocity.v),d=u.c_velocity.w;var f=a.mul(s,p);if(a.lengthSquared(f)>o.maxTranslationSquared){var y=o.maxTranslation/f.length();p.mul(y)}var v=s*d;v*v>o.maxRotationSquared&&(d*=y=o.maxRotation/h.abs(v)),l.addMul(s,p),m+=s*d,u.c_position.c.set(l),u.c_position.a=m,u.c_velocity.v.set(p),u.c_velocity.w=d}n&&this.printBodies("B: ");var g=!1;for(c=0;c<t.positionIterations;++c){var b=0;for(_=0;_<this.m_contacts.length;++_){var x=this.m_contacts[_].solvePositionConstraint(t);b=h.min(b,x)}var A=b>=-3*o.linearSlop,w=!0;for(_=0;_<this.m_joints.length;++_){var B=this.m_joints[_].solvePositionConstraints(t);w=w&&B}if(A&&w){g=!0;break}}for(n&&this.printBodies("L: "),c=0;c<this.m_bodies.length;++c)(u=this.m_bodies[c]).m_sweep.c.set(u.c_position.c),u.m_sweep.a=u.c_position.a,u.m_linearVelocity.set(u.c_velocity.v),u.m_angularVelocity=u.c_velocity.w,u.synchronizeTransform();if(this.postSolveIsland(),r){var T=1/0,E=o.linearSleepToleranceSqr,C=o.angularSleepToleranceSqr;for(c=0;c<this.m_bodies.length;++c)(u=this.m_bodies[c]).isStatic()||(0==u.m_autoSleepFlag||u.m_angularVelocity*u.m_angularVelocity>C||a.lengthSquared(u.m_linearVelocity)>E?(u.m_sleepTime=0,T=0):(u.m_sleepTime+=s,T=h.min(T,u.m_sleepTime)));if(T>=o.timeToSleep&&g)for(c=0;c<this.m_bodies.length;++c)(u=this.m_bodies[c]).setAwake(!1)}},y.prototype.printBodies=function(t){for(var e=0;e<this.m_bodies.length;++e){var i=this.m_bodies[e];s.debug(t,i.c_position.a,i.c_position.c.x,i.c_position.c.y,i.c_velocity.w,i.c_velocity.v.x,i.c_velocity.v.y)}};var v=new f;function g(){this.normalImpulses=[],this.tangentImpulses=[]}y.prototype.solveWorldTOI=function(t){var e=this.m_world;if(e.m_stepComplete){for(var i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1,i.m_sweep.alpha0=0;for(var a=e.m_contactList;a;a=a.m_next)a.m_toiFlag=!1,a.m_islandFlag=!1,a.m_toiCount=0,a.m_toi=1}for(;;){var c=null,u=1;for(a=e.m_contactList;a;a=a.m_next)if(0!=a.isEnabled()&&!(a.m_toiCount>o.maxSubSteps)){var l=1;if(a.m_toiFlag)l=a.m_toi;else{var _=a.getFixtureA(),f=a.getFixtureB();if(_.isSensor()||f.isSensor())continue;var y=_.getBody(),g=f.getBody();r&&s.assert(y.isDynamic()||g.isDynamic());var b=y.isAwake()&&!y.isStatic(),x=g.isAwake()&&!g.isStatic();if(0==b&&0==x)continue;var A=y.isBullet()||!y.isDynamic(),w=g.isBullet()||!g.isDynamic();if(0==A&&0==w)continue;var B=y.m_sweep.alpha0;y.m_sweep.alpha0<g.m_sweep.alpha0?(B=g.m_sweep.alpha0,y.m_sweep.advance(B)):g.m_sweep.alpha0<y.m_sweep.alpha0&&(B=y.m_sweep.alpha0,g.m_sweep.advance(B)),r&&s.assert(B<1);var T=a.getChildIndexA(),E=a.getChildIndexB(),C=(y.m_sweep,g.m_sweep,new p);C.proxyA.set(_.getShape(),T),C.proxyB.set(f.getShape(),E),C.sweepA.set(y.m_sweep),C.sweepB.set(g.m_sweep),C.tMax=1;var S=new d;m(S,C);var I=S.t;l=S.state==d.e_touching?h.min(B+(1-B)*I,1):1,a.m_toi=l,a.m_toiFlag=!0}l<u&&(c=a,u=l)}if(null==c||1-10*h.EPSILON<u){e.m_stepComplete=!0;break}_=c.getFixtureA(),f=c.getFixtureB(),y=_.getBody(),g=f.getBody();var M=y.m_sweep.clone(),P=g.m_sweep.clone();if(y.advance(u),g.advance(u),c.update(e),c.m_toiFlag=!1,++c.m_toiCount,0!=c.isEnabled()&&0!=c.isTouching()){y.setAwake(!0),g.setAwake(!0),this.clear(),this.addBody(y),this.addBody(g),this.addContact(c),y.m_islandFlag=!0,g.m_islandFlag=!0,c.m_islandFlag=!0;for(var D=[y,g],O=0;O<D.length;++O)if((k=D[O]).isDynamic())for(var L=k.m_contactList;L;L=L.next){var N=L.contact;if(!N.m_islandFlag){var V=L.other;if(!V.isDynamic()||k.isBullet()||V.isBullet()){var R=N.m_fixtureA.m_isSensor,F=N.m_fixtureB.m_isSensor;if(!R&&!F){var z=V.m_sweep.clone();0==V.m_islandFlag&&V.advance(u),N.update(e),0!=N.isEnabled()&&0!=N.isTouching()?(N.m_islandFlag=!0,this.addContact(N),V.m_islandFlag||(V.m_islandFlag=!0,V.isStatic()||V.setAwake(!0),this.addBody(V))):(V.m_sweep.set(z),V.synchronizeTransform())}}}}for(v.reset((1-u)*t.dt),v.dtRatio=1,v.positionIterations=20,v.velocityIterations=t.velocityIterations,v.warmStarting=!1,this.solveIslandTOI(v,y,g),O=0;O<this.m_bodies.length;++O){var k;if((k=this.m_bodies[O]).m_islandFlag=!1,k.isDynamic())for(k.synchronizeFixtures(),L=k.m_contactList;L;L=L.next)L.contact.m_toiFlag=!1,L.contact.m_islandFlag=!1}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}else c.setEnabled(!1),y.m_sweep.set(M),g.m_sweep.set(P),y.synchronizeTransform(),g.synchronizeTransform()}if(n)for(i=e.m_bodyList;i;i=i.m_next)a=i.m_sweep.c,i.m_sweep.a,i.m_linearVelocity,i.m_angularVelocity},y.prototype.solveIslandTOI=function(t,e,i){this.m_world;for(var n=0;n<this.m_bodies.length;++n)(l=this.m_bodies[n]).c_position.c.set(l.m_sweep.c),l.c_position.a=l.m_sweep.a,l.c_velocity.v.set(l.m_linearVelocity),l.c_velocity.w=l.m_angularVelocity;for(n=0;n<this.m_contacts.length;++n)this.m_contacts[n].initConstraint(t);for(n=0;n<t.positionIterations;++n){for(var r=0,s=0;s<this.m_contacts.length;++s){var c=this.m_contacts[s].solvePositionConstraintTOI(t,e,i);r=h.min(r,c)}if(r>=-1.5*o.linearSlop)break}for(e.m_sweep.c0.set(e.c_position.c),e.m_sweep.a0=e.c_position.a,i.m_sweep.c0.set(i.c_position.c),i.m_sweep.a0=i.c_position.a,n=0;n<this.m_contacts.length;++n)this.m_contacts[n].initVelocityConstraint(t);for(n=0;n<t.velocityIterations;++n)for(s=0;s<this.m_contacts.length;++s)this.m_contacts[s].solveVelocityConstraint(t);var u=t.dt;for(n=0;n<this.m_bodies.length;++n){var l=this.m_bodies[n],m=a.clone(l.c_position.c),p=l.c_position.a,d=a.clone(l.c_velocity.v),_=l.c_velocity.w,f=a.mul(u,d);if(a.dot(f,f)>o.maxTranslationSquared){var y=o.maxTranslation/f.length();d.mul(y)}var v=u*_;v*v>o.maxRotationSquared&&(_*=y=o.maxRotation/h.abs(v)),m.addMul(u,d),p+=u*_,l.c_position.c=m,l.c_position.a=p,l.c_velocity.v=d,l.c_velocity.w=_,l.m_sweep.c=m,l.m_sweep.a=p,l.m_linearVelocity=d,l.m_angularVelocity=_,l.synchronizeTransform()}this.postSolveIsland()},y.prototype.postSolveIsland=function(){for(var t=new g,e=0;e<this.m_contacts.length;++e){for(var i=this.m_contacts[e],n=0;n<i.v_points.length;++n)t.normalImpulses.push(i.v_points[n].normalImpulse),t.tangentImpulses.push(i.v_points[n].tangentImpulse);this.m_world.postSolve(i,t)}}},6972:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=p;var r=i(4896),o=i(2274),s=i(6306),a=i(7929),h=i(2260),c=i(2129),u=i(5878),l=i(8730),m={gravity:s.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function p(t){if(!(this instanceof p))return new p(t);t&&s.isValid(t)&&(t={gravity:t}),t=r(t,m),this.m_solver=new h(this),this.m_broadPhase=new a,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=s.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_stepCount=0,this.addPair=this.createContact.bind(this)}p.prototype._serialize=function(){for(var t=[],e=[],i=this.getBodyList();i;i=i.getNext())t.push(i);for(var n=this.getJointList();n;n=n.getNext())"function"==typeof n._serialize&&e.push(n);return{gravity:this.m_gravity,bodies:t,joints:e}},p._deserialize=function(t,e,i){if(!t)return new p;var n=new p(t.gravity);return t.bodies&&t.bodies.reverse().forEach((function(t){n._addBody(i(c,t,n))})),t.joints&&t.joints.reverse().forEach((function(t){n.createJoint(i(u,t,n))})),n},p.prototype.getBodyList=function(){return this.m_bodyList},p.prototype.getJointList=function(){return this.m_jointList},p.prototype.getContactList=function(){return this.m_contactList},p.prototype.getBodyCount=function(){return this.m_bodyCount},p.prototype.getJointCount=function(){return this.m_jointCount},p.prototype.getContactCount=function(){return this.m_contactCount},p.prototype.setGravity=function(t){this.m_gravity=t},p.prototype.getGravity=function(){return this.m_gravity},p.prototype.isLocked=function(){return this.m_locked},p.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(var e=this.m_bodyList;e;e=e.m_next)e.setAwake(!0)},p.prototype.getAllowSleeping=function(){return this.m_allowSleep},p.prototype.setWarmStarting=function(t){this.m_warmStarting=t},p.prototype.getWarmStarting=function(){return this.m_warmStarting},p.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},p.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},p.prototype.setSubStepping=function(t){this.m_subStepping=t},p.prototype.getSubStepping=function(){return this.m_subStepping},p.prototype.setAutoClearForces=function(t){this.m_clearForces=t},p.prototype.getAutoClearForces=function(){return this.m_clearForces},p.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},p.prototype.queryAABB=function(t,e){n&&o.assert("function"==typeof e);var i=this.m_broadPhase;this.m_broadPhase.query(t,(function(t){var n=i.getUserData(t);return e(n.fixture)}))},p.prototype.rayCast=function(t,e,i){n&&o.assert("function"==typeof i);var r=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:t,p2:e},(function(t,e){var n=r.getUserData(e),o=n.fixture,a=n.childIndex,h={};if(o.rayCast(h,t,a)){var c=h.fraction,u=s.add(s.mul(1-c,t.p1),s.mul(c,t.p2));return i(o,u,h.normal,c)}return t.maxFraction}))},p.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},p.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},p.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},p.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},p.prototype.shiftOrigin=function(t){if(n&&o.assert(0==this.m_locked),!this.m_locked){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(var i=this.m_jointList;i;i=i.m_next)i.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},p.prototype._addBody=function(t){n&&o.assert(!1===this.isLocked()),this.isLocked()||(t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount)},p.prototype.createBody=function(t,e){if(n&&o.assert(0==this.isLocked()),this.isLocked())return null;t&&s.isValid(t)&&(t={position:t,angle:e});var i=new c(this,t);return this._addBody(i),i},p.prototype.createDynamicBody=function(t,e){return t?s.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)},p.prototype.createKinematicBody=function(t,e){return t?s.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)},p.prototype.destroyBody=function(t){if(n&&o.assert(this.m_bodyCount>0),n&&o.assert(0==this.isLocked()),!this.isLocked()){if(t.m_destroyed)return!1;for(var e=t.m_jointList;e;){var i=e;e=e.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;for(var r=t.m_contactList;r;){var s=r;r=r.next,this.destroyContact(s.contact),t.m_contactList=r}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var h=a;a=a.m_next,this.publish("remove-fixture",h),h.destroyProxies(this.m_broadPhase),t.m_fixtureList=a}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0}},p.prototype.createJoint=function(t){if(n&&o.assert(!!t.m_bodyA),n&&o.assert(!!t.m_bodyB),n&&o.assert(0==this.isLocked()),this.isLocked())return null;if(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB,0==t.m_collideConnected)for(var e=t.m_bodyB.getContactList();e;e=e.next)e.other==t.m_bodyA&&e.contact.flagForFiltering();return t},p.prototype.destroyJoint=function(t){if(n&&o.assert(0==this.isLocked()),!this.isLocked()){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var e=t.m_bodyA,i=t.m_bodyB;if(e.setAwake(!0),i.setAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==e.m_jointList&&(e.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==i.m_jointList&&(i.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,n&&o.assert(this.m_jointCount>0),--this.m_jointCount,0==t.m_collideConnected)for(var r=i.getContactList();r;)r.other==e&&r.contact.flagForFiltering(),r=r.next;this.publish("remove-joint",t)}};var d=new h.TimeStep;p.prototype.step=function(t,e,i){if((0|e)!==e&&(e=0),e=e||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_stepCount++,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,d.reset(t),d.velocityIterations=e,d.positionIterations=i,d.warmStarting=this.m_warmStarting,d.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(d);for(var n=this.m_bodyList;n;n=n.getNext())0!=n.m_islandFlag&&(n.isStatic()||n.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(d),this.m_clearForces&&this.clearForces(),this.m_locked=!1},p.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)},p.prototype.createContact=function(t,e){var i=t.fixture,n=e.fixture,r=t.childIndex,o=e.childIndex,s=i.getBody(),a=n.getBody();if(s!=a){for(var h=a.getContactList();h;){if(h.other==s){var c=h.contact.getFixtureA(),u=h.contact.getFixtureB(),m=h.contact.getChildIndexA(),p=h.contact.getChildIndexB();if(c==i&&u==n&&m==r&&p==o)return;if(c==n&&u==i&&m==o&&p==r)return}h=h.next}if(0!=a.shouldCollide(s)&&0!=n.shouldCollide(i)){var d=l.create(i,r,n,o);null!=d&&(d.m_prev=null,null!=this.m_contactList&&(d.m_next=this.m_contactList,this.m_contactList.m_prev=d),this.m_contactList=d,++this.m_contactCount)}}},p.prototype.updateContacts=function(){for(var t,e=this.m_contactList;t=e;){e=t.getNext();var i=t.getFixtureA(),n=t.getFixtureB(),r=t.getChildIndexA(),o=t.getChildIndexB(),s=i.getBody(),a=n.getBody();if(t.m_filterFlag){if(0==a.shouldCollide(s)){this.destroyContact(t);continue}if(0==n.shouldCollide(i)){this.destroyContact(t);continue}t.m_filterFlag=!1}var h=s.isAwake()&&!s.isStatic(),c=a.isAwake()&&!a.isStatic();if(0!=h||0!=c){var u=i.m_proxies[r].proxyId,l=n.m_proxies[o].proxyId;0!=this.m_broadPhase.testOverlap(u,l)?t.update(this):this.destroyContact(t)}}},p.prototype.destroyContact=function(t){l.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount},p.prototype._listeners=null,p.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e||(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)),this},p.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;var i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;var n=i.indexOf(e);return n>=0&&i.splice(n,1),this},p.prototype.publish=function(t,e,i,n){var r=this._listeners&&this._listeners[t];if(!r||!r.length)return 0;for(var o=0;o<r.length;o++)r[o].call(this,e,i,n);return r.length},p.prototype.beginContact=function(t){this.publish("begin-contact",t)},p.prototype.endContact=function(t){this.publish("end-contact",t)},p.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)},p.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)}},3406:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT,o=(i(1099),i(2274)),s=i(5387),a=i(6306);function h(t,e){if(!(this instanceof h))return new h(t,e);this.lowerBound=a.zero(),this.upperBound=a.zero(),"object"==typeof t&&this.lowerBound.set(t),"object"==typeof e?this.upperBound.set(e):"object"==typeof t&&this.upperBound.set(t)}t.exports=h,h.prototype.isValid=function(){return h.isValid(this)},h.isValid=function(t){var e=a.sub(t.upperBound,t.lowerBound);return e.x>=0&&e.y>=0&&a.isValid(t.lowerBound)&&a.isValid(t.upperBound)},h.assert=function(t){if(r&&!h.isValid(t))throw n&&o.debug(t),new Error("Invalid AABB!")},h.prototype.getCenter=function(){return a.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},h.prototype.getExtents=function(){return a.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},h.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},h.prototype.combine=function(t,e){e=e||this;var i=t.lowerBound,n=t.upperBound,r=e.lowerBound,o=e.upperBound,a=s.min(i.x,r.x),h=s.min(i.y,r.y),c=s.max(o.x,n.x),u=s.max(o.y,n.y);this.lowerBound.set(a,h),this.upperBound.set(c,u)},h.prototype.combinePoints=function(t,e){this.lowerBound.set(s.min(t.x,e.x),s.min(t.y,e.y)),this.upperBound.set(s.max(t.x,e.x),s.max(t.y,e.y))},h.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)},h.prototype.contains=function(t){var e=!0;return(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},h.prototype.extend=function(t){return h.extend(this,t),this},h.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e},h.testOverlap=function(t,e){var i=e.lowerBound.x-t.upperBound.x,n=t.lowerBound.x-e.upperBound.x,r=e.lowerBound.y-t.upperBound.y,o=t.lowerBound.y-e.upperBound.y;return!(i>0||r>0||n>0||o>0)},h.areEqual=function(t,e){return a.areEqual(t.lowerBound,e.lowerBound)&&a.areEqual(t.upperBound,e.upperBound)},h.diff=function(t,e){var i=s.max(0,s.min(t.upperBound.x,e.upperBound.x)-s.max(e.lowerBound.x,t.lowerBound.x)),n=s.max(0,s.min(t.upperBound.y,e.upperBound.y)-s.max(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-i*n},h.prototype.rayCast=function(t,e){for(var i=-1/0,n=1/0,r=e.p1,o=a.sub(e.p2,e.p1),h=a.abs(o),c=a.zero(),u="x";null!==u;u="x"===u?"y":null)if(h.x<s.EPSILON){if(r[u]<this.lowerBound[u]||this.upperBound[u]<r[u])return!1}else{var l=1/o[u],m=(this.lowerBound[u]-r[u])*l,p=(this.upperBound[u]-r[u])*l,d=-1;if(m>p){var _=m;m=p,p=_,d=1}if(m>i&&(c.setZero(),c[u]=d,i=m),i>(n=s.min(n,p)))return!1}return!(i<0||e.maxFraction<i||(t.fraction=i,t.normal=c,0))},h.prototype.toString=function(){return JSON.stringify(this)}},7929:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=(i(1099),i(2274)),o=i(5387),s=i(3406),a=i(2454);function h(){this.m_tree=new a,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}t.exports=h,h.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},h.prototype.testOverlap=function(t,e){var i=this.m_tree.getFatAABB(t),n=this.m_tree.getFatAABB(e);return s.testOverlap(i,n)},h.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},h.prototype.getProxyCount=function(){return this.m_proxyCount},h.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},h.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},h.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},h.prototype.query=function(t,e){this.m_tree.query(t,e)},h.prototype.rayCast=function(t,e){this.m_tree.rayCast(t,e)},h.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},h.prototype.createProxy=function(t,e){n&&r.assert(s.isValid(t));var i=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(i),i},h.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)},h.prototype.moveProxy=function(t,e,i){n&&r.assert(s.isValid(e)),this.m_tree.moveProxy(t,e,i)&&this.bufferMove(t)},h.prototype.touchProxy=function(t){this.bufferMove(t)},h.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},h.prototype.unbufferMove=function(t){for(var e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)},h.prototype.updatePairs=function(t){for(n&&r.assert("function"==typeof t),this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),null!==this.m_queryProxyId){var e=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(e,this.queryCallback)}},h.prototype.queryCallback=function(t){if(t==this.m_queryProxyId)return!0;var e=o.min(t,this.m_queryProxyId),i=o.max(t,this.m_queryProxyId),n=this.m_tree.getUserData(e),r=this.m_tree.getUserData(i);return this.m_callback(n,r),!0}},8054:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=d,t.exports.Input=l,t.exports.Output=m,t.exports.Proxy=_,t.exports.Cache=p;var r=i(1099),o=i(2274),s=i(5489),a=i(5387),h=i(6306),c=(i(4470),i(6173),i(7515),i(3766)),u=(i(5385),i(8850));function l(){this.proxyA=new _,this.proxyB=new _,this.transformA=null,this.transformB=null,this.useRadii=!1}function m(){this.pointA=h.zero(),this.pointB=h.zero(),this.distance,this.iterations}function p(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}function d(t,e,i){++s.gjkCalls;var n=i.proxyA,o=i.proxyB,l=i.transformA,m=i.transformB,p=new y;p.readCache(e,n,l,o,m);for(var d=p.m_v,_=r.maxDistnceIterations,f=[],v=[],g=0,b=0;b<_;){g=p.m_count;for(var x=0;x<g;++x)f[x]=d[x].indexA,v[x]=d[x].indexB;if(p.solve(),3==p.m_count)break;(S=p.getClosestPoint()).lengthSquared();var A=p.getSearchDirection();if(A.lengthSquared()<a.EPSILON*a.EPSILON)break;var w=d[p.m_count];w.indexA=n.getSupport(c.mulTVec2(l.q,h.neg(A))),w.wA=u.mulVec2(l,n.getVertex(w.indexA)),w.indexB=o.getSupport(c.mulTVec2(m.q,A)),w.wB=u.mulVec2(m,o.getVertex(w.indexB)),w.w=h.sub(w.wB,w.wA),++b,++s.gjkIters;var B=!1;for(x=0;x<g;++x)if(w.indexA==f[x]&&w.indexB==v[x]){B=!0;break}if(B)break;++p.m_count}if(s.gjkMaxIters=a.max(s.gjkMaxIters,b),p.getWitnessPoints(t.pointA,t.pointB),t.distance=h.distance(t.pointA,t.pointB),t.iterations=b,p.writeCache(e),i.useRadii){var T=n.m_radius,E=o.m_radius;if(t.distance>T+E&&t.distance>a.EPSILON){t.distance-=T+E;var C=h.sub(t.pointB,t.pointA);C.normalize(),t.pointA.addMul(T,C),t.pointB.subMul(E,C)}else{var S=h.mid(t.pointA,t.pointB);t.pointA.set(S),t.pointB.set(S),t.distance=0}}}function _(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}function f(){this.indexA,this.indexB,this.wA=h.zero(),this.wB=h.zero(),this.w=h.zero(),this.a}function y(){this.m_v1=new f,this.m_v2=new f,this.m_v3=new f,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}i(5235),i(8601),s.gjkCalls=0,s.gjkIters=0,s.gjkMaxIters=0,_.prototype.getVertexCount=function(){return this.m_count},_.prototype.getVertex=function(t){return n&&o.assert(0<=t&&t<this.m_count),this.m_vertices[t]},_.prototype.getSupport=function(t){for(var e=0,i=h.dot(this.m_vertices[0],t),n=0;n<this.m_count;++n){var r=h.dot(this.m_vertices[n],t);r>i&&(e=n,i=r)}return e},_.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},_.prototype.set=function(t,e){n&&o.assert("function"==typeof t.computeDistanceProxy),t.computeDistanceProxy(this,e)},f.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA=h.clone(t.wA),this.wB=h.clone(t.wB),this.w=h.clone(t.w),this.a=t.a},y.prototype.print=function(){return 3==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},y.prototype.readCache=function(t,e,i,r,s){n&&o.assert(t.count<=3),this.m_count=t.count;for(var c=0;c<this.m_count;++c){(_=this.m_v[c]).indexA=t.indexA[c],_.indexB=t.indexB[c];var l=e.getVertex(_.indexA),m=r.getVertex(_.indexB);_.wA=u.mulVec2(i,l),_.wB=u.mulVec2(s,m),_.w=h.sub(_.wB,_.wA),_.a=0}if(this.m_count>1){var p=t.metric,d=this.getMetric();(d<.5*p||2*p<d||d<a.EPSILON)&&(this.m_count=0)}var _;0==this.m_count&&((_=this.m_v[0]).indexA=0,_.indexB=0,l=e.getVertex(0),m=r.getVertex(0),_.wA=u.mulVec2(i,l),_.wB=u.mulVec2(s,m),_.w=h.sub(_.wB,_.wA),_.a=1,this.m_count=1)},y.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB},y.prototype.getSearchDirection=function(){switch(this.m_count){case 1:return h.neg(this.m_v1.w);case 2:var t=h.sub(this.m_v2.w,this.m_v1.w);return h.cross(t,h.neg(this.m_v1.w))>0?h.cross(1,t):h.cross(t,1);default:return n&&o.assert(!1),h.zero()}},y.prototype.getClosestPoint=function(){switch(this.m_count){case 0:return n&&o.assert(!1),h.zero();case 1:return h.clone(this.m_v1.w);case 2:return h.combine(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w);case 3:return h.zero();default:return n&&o.assert(!1),h.zero()}},y.prototype.getWitnessPoints=function(t,e){switch(this.m_count){case 0:n&&o.assert(!1);break;case 1:t.set(this.m_v1.wA),e.set(this.m_v1.wB);break;case 2:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.setCombine(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.addMul(this.m_v3.a,this.m_v3.wA),e.set(t);break;default:n&&o.assert(!1)}},y.prototype.getMetric=function(){switch(this.m_count){case 0:return n&&o.assert(!1),0;case 1:return 0;case 2:return h.distance(this.m_v1.w,this.m_v2.w);case 3:return h.cross(h.sub(this.m_v2.w,this.m_v1.w),h.sub(this.m_v3.w,this.m_v1.w));default:return n&&o.assert(!1),0}},y.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break;default:n&&o.assert(!1)}},y.prototype.solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=h.sub(e,t),n=-h.dot(t,i);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var r=h.dot(e,i);if(r<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);var o=1/(r+n);this.m_v1.a=r*o,this.m_v2.a=n*o,this.m_count=2},y.prototype.solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=h.sub(e,t),r=h.dot(t,n),o=h.dot(e,n),s=-r,a=h.sub(i,t),c=h.dot(t,a),u=h.dot(i,a),l=-c,m=h.sub(i,e),p=h.dot(e,m),d=h.dot(i,m),_=-p,f=h.cross(n,a),y=f*h.cross(e,i),v=f*h.cross(i,t),g=f*h.cross(t,e);if(s<=0&&l<=0)return this.m_v1.a=1,void(this.m_count=1);if(o>0&&s>0&&g<=0){var b=1/(o+s);return this.m_v1.a=o*b,this.m_v2.a=s*b,void(this.m_count=2)}if(u>0&&l>0&&v<=0){var x=1/(u+l);return this.m_v1.a=u*x,this.m_v3.a=l*x,this.m_count=2,void this.m_v2.set(this.m_v3)}if(o<=0&&_<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(u<=0&&d<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(d>0&&_>0&&y<=0){var A=1/(d+_);return this.m_v2.a=d*A,this.m_v3.a=_*A,this.m_count=2,void this.m_v1.set(this.m_v3)}var w=1/(y+v+g);this.m_v1.a=y*w,this.m_v2.a=v*w,this.m_v3.a=g*w,this.m_count=3},d.testOverlap=function(t,e,i,n,r,o){var s=new l;s.proxyA.set(t,e),s.proxyB.set(i,n),s.transformA=r,s.transformB=o,s.useRadii=!0;var h=new p,c=new m;return d(c,h,s),c.distance<10*a.EPSILON}},2454:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(1099),o=i(2274),s=i(5706),a=i(6306),h=i(5387),c=i(3406);function u(t){this.id=t,this.aabb=new c,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}function l(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new s({create:function(){return new u}})}t.exports=l,u.prototype.isLeaf=function(){return null==this.child1},l.prototype.getUserData=function(t){var e=this.m_nodes[t];return n&&o.assert(!!e),e.userData},l.prototype.getFatAABB=function(t){var e=this.m_nodes[t];return n&&o.assert(!!e),e.aabb},l.prototype.allocateNode=function(){var t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t},l.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]},l.prototype.createProxy=function(t,e){n&&o.assert(c.isValid(t));var i=this.allocateNode();return i.aabb.set(t),c.extend(i.aabb,r.aabbExtension),i.userData=e,i.height=0,this.insertLeaf(i),i.id},l.prototype.destroyProxy=function(t){var e=this.m_nodes[t];n&&o.assert(!!e),n&&o.assert(e.isLeaf()),this.removeLeaf(e),this.freeNode(e)},l.prototype.moveProxy=function(t,e,i){n&&o.assert(c.isValid(e)),n&&o.assert(!i||a.isValid(i));var s=this.m_nodes[t];return n&&o.assert(!!s),n&&o.assert(s.isLeaf()),!s.aabb.contains(e)&&(this.removeLeaf(s),s.aabb.set(e),e=s.aabb,c.extend(e,r.aabbExtension),i.x<0?e.lowerBound.x+=i.x*r.aabbMultiplier:e.upperBound.x+=i.x*r.aabbMultiplier,i.y<0?e.lowerBound.y+=i.y*r.aabbMultiplier:e.upperBound.y+=i.y*r.aabbMultiplier,this.insertLeaf(s),!0)},l.prototype.insertLeaf=function(t){if(n&&o.assert(c.isValid(t.aabb)),null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);for(var e=t.aabb,i=this.m_root;0==i.isLeaf();){var r=i.child1,s=i.child2,a=i.aabb.getPerimeter(),u=new c;u.combine(i.aabb,e);var l,m,p,d=u.getPerimeter(),_=2*d,f=2*(d-a);if(r.isLeaf())(p=new c).combine(e,r.aabb),l=p.getPerimeter()+f;else{(p=new c).combine(e,r.aabb);var y=r.aabb.getPerimeter();l=p.getPerimeter()-y+f}if(s.isLeaf())(p=new c).combine(e,s.aabb),m=p.getPerimeter()+f;else(p=new c).combine(e,s.aabb),y=s.aabb.getPerimeter(),m=p.getPerimeter()-y+f;if(_<l&&_<m)break;i=l<m?r:s}var v=i,g=v.parent,b=this.allocateNode();for(b.parent=g,b.userData=null,b.aabb.combine(e,v.aabb),b.height=v.height+1,null!=g?(g.child1==v?g.child1=b:g.child2=b,b.child1=v,b.child2=t,v.parent=b,t.parent=b):(b.child1=v,b.child2=t,v.parent=b,t.parent=b,this.m_root=b),i=t.parent;null!=i;)r=(i=this.balance(i)).child1,s=i.child2,n&&o.assert(null!=r),n&&o.assert(null!=s),i.height=1+h.max(r.height,s.height),i.aabb.combine(r.aabb,s.aabb),i=i.parent},l.prototype.removeLeaf=function(t){if(t!=this.m_root){var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,null!=n){n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.freeNode(i);for(var r=n;null!=r;){var o=(r=this.balance(r)).child1,s=r.child2;r.aabb.combine(o.aabb,s.aabb),r.height=1+h.max(o.height,s.height),r=r.parent}}else this.m_root=e,e.parent=null,this.freeNode(i)}else this.m_root=null},l.prototype.balance=function(t){n&&o.assert(null!=t);var e=t;if(e.isLeaf()||e.height<2)return t;var i=e.child1,r=e.child2,s=r.height-i.height;if(s>1){var a=r.child1,c=r.child2;return r.child1=e,r.parent=e.parent,e.parent=r,null!=r.parent?r.parent.child1==t?r.parent.child1=r:r.parent.child2=r:this.m_root=r,a.height>c.height?(r.child2=a,e.child2=c,c.parent=e,e.aabb.combine(i.aabb,c.aabb),r.aabb.combine(e.aabb,a.aabb),e.height=1+h.max(i.height,c.height),r.height=1+h.max(e.height,a.height)):(r.child2=c,e.child2=a,a.parent=e,e.aabb.combine(i.aabb,a.aabb),r.aabb.combine(e.aabb,c.aabb),e.height=1+h.max(i.height,a.height),r.height=1+h.max(e.height,c.height)),r}if(s<-1){var u=i.child1,l=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1==e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,u.height>l.height?(i.child2=u,e.child1=l,l.parent=e,e.aabb.combine(r.aabb,l.aabb),i.aabb.combine(e.aabb,u.aabb),e.height=1+h.max(r.height,l.height),i.height=1+h.max(e.height,u.height)):(i.child2=l,e.child1=u,u.parent=e,e.aabb.combine(r.aabb,u.aabb),i.aabb.combine(e.aabb,l.aabb),e.height=1+h.max(r.height,u.height),i.height=1+h.max(e.height,l.height)),i}return e},l.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},l.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;for(var t,e=this.m_root.aabb.getPerimeter(),i=0,n=d.allocate().preorder(this.m_root);t=n.next();)t.height<0||(i+=t.aabb.getPerimeter());return d.release(n),i/e},l.prototype.computeHeight=function(t){var e;if((e=void 0!==t?this.m_nodes[t]:this.m_root).isLeaf())return 0;var i=this.computeHeight(e.child1.id),n=this.computeHeight(e.child2.id);return 1+h.max(i,n)},l.prototype.validateStructure=function(t){if(null!=t){t==this.m_root&&n&&o.assert(null==t.parent);var e=t.child1,i=t.child2;if(t.isLeaf())return n&&o.assert(null==e),n&&o.assert(null==i),void(n&&o.assert(0==t.height));n&&o.assert(e.parent==t),n&&o.assert(i.parent==t),this.validateStructure(e),this.validateStructure(i)}},l.prototype.validateMetrics=function(t){if(null!=t){var e=t.child1,i=t.child2;if(t.isLeaf())return n&&o.assert(null==e),n&&o.assert(null==i),void(n&&o.assert(0==t.height));var r=e.height,s=i.height,a=1+h.max(r,s);n&&o.assert(t.height==a);var u=new c;u.combine(e.aabb,i.aabb),n&&o.assert(c.areEqual(u,t.aabb)),this.validateMetrics(e),this.validateMetrics(i)}},l.prototype.validate=function(){this.validateStructure(this.m_root),this.validateMetrics(this.m_root),n&&o.assert(this.getHeight()==this.computeHeight())},l.prototype.getMaxBalance=function(){for(var t,e=0,i=d.allocate().preorder(this.m_root);t=i.next();)if(!(t.height<=1)){n&&o.assert(0==t.isLeaf());var r=h.abs(t.child2.height-t.child1.height);e=h.max(e,r)}return d.release(i),e},l.prototype.rebuildBottomUp=function(){for(var t,e=[],i=0,n=d.allocate().preorder(this.m_root);t=n.next();)t.height<0||(t.isLeaf()?(t.parent=null,e[i]=t,++i):this.freeNode(t));for(d.release(n);i>1;){for(var r=1/0,o=-1,s=-1,a=0;a<i;++a)for(var u=e[a].aabb,l=a+1;l<i;++l){var m=e[l].aabb,p=new c;p.combine(u,m);var _=p.getPerimeter();_<r&&(o=a,s=l,r=_)}var f=e[o],y=e[s],v=this.allocateNode();v.child1=f,v.child2=y,v.height=1+h.max(f.height,y.height),v.aabb.combine(f.aabb,y.aabb),v.parent=null,f.parent=v,y.parent=v,e[s]=e[i-1],e[o]=v,--i}this.m_root=e[0],this.validate()},l.prototype.shiftOrigin=function(t){for(var e,i=d.allocate().preorder(this.m_root);e=i.next();){var n=e.aabb;n.lowerBound.x-=t.x,n.lowerBound.y-=t.y,n.upperBound.x-=t.x,n.upperBound.y-=t.y}d.release(i)},l.prototype.query=function(t,e){n&&o.assert("function"==typeof e);var i=p.allocate();for(i.push(this.m_root);i.length>0;){var r=i.pop();if(null!=r&&c.testOverlap(r.aabb,t))if(r.isLeaf()){if(0==e(r.id))return}else i.push(r.child1),i.push(r.child2)}p.release(i)},l.prototype.rayCast=function(t,e){n&&o.assert("function"==typeof e);var i=t.p1,r=t.p2,s=a.sub(r,i);n&&o.assert(s.lengthSquared()>0),s.normalize();var u=a.cross(1,s),l=a.abs(u),d=t.maxFraction,_=new c,f=a.combine(1-d,i,d,r);_.combinePoints(i,f);var y=p.allocate(),v=m.allocate();for(y.push(this.m_root);y.length>0;){var g=y.pop();if(null!=g&&0!=c.testOverlap(g.aabb,_)){var b=g.aabb.getCenter(),x=g.aabb.getExtents();if(!(h.abs(a.dot(u,a.sub(i,b)))-a.dot(l,x)>0))if(g.isLeaf()){v.p1=a.clone(t.p1),v.p2=a.clone(t.p2),v.maxFraction=d;var A=e(v,g.id);if(0==A)return;A>0&&(d=A,f=a.combine(1-d,i,d,r),_.combinePoints(i,f))}else y.push(g.child1),y.push(g.child2)}}p.release(y),m.release(v)};var m=new s({create:function(){return{}},release:function(t){}}),p=new s({create:function(){return[]},release:function(t){t.length=0}}),d=new s({create:function(){return new _},release:function(t){t.close()}});function _(){var t=[],e=[];return{preorder:function(i){return t.length=0,t.push(i),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){var i=t.length-1,n=t[i];if(0===e[i])return e[i]=1,n;if(1===e[i]&&(e[i]=2,n.child1))return t.push(n.child1),e.push(1),n.child1;if(2===e[i]&&(e[i]=3,n.child2))return t.push(n.child2),e.push(1),n.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}},8650:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=function(t,e){var i=s.now();++a.toiCalls,t.state=v.e_unknown,t.t=e.tMax;var c=e.proxyA,u=e.proxyB,l=e.sweepA,f=e.sweepB;l.normalize(),f.normalize();var b=e.tMax,x=c.m_radius+u.m_radius,A=h.max(r.linearSlop,x-3*r.linearSlop),w=.25*r.linearSlop;n&&o.assert(A>w);var B=0,T=r.maxTOIIterations,E=0,C=new y,S=new d;for(S.proxyA=e.proxyA,S.proxyB=e.proxyB,S.useRadii=!1;;){var I=m.identity(),M=m.identity();l.getTransform(I,B),f.getTransform(M,B),S.transformA=I,S.transformB=M;var P=new _;if(p(P,C,S),P.distance<=0){t.state=v.e_overlapped,t.t=0;break}if(P.distance<A+w){t.state=v.e_touching,t.t=B;break}var D=new g;D.initialize(C,c,l,u,f,B);for(var O=!1,L=b,N=0;;){var V=D.findMinSeparation(L);if(D.indexA,D.indexB,V>A+w){t.state=v.e_separated,t.t=b,O=!0;break}if(V>A-w){B=L;break}var R=D.evaluate(B);if(D.indexA,D.indexB,R<A-w){t.state=v.e_failed,t.t=B,O=!0;break}if(R<=A+w){t.state=v.e_touching,t.t=B,O=!0;break}for(var F=0,z=B,k=L;;){var j;j=1&F?z+(A-R)*(k-z)/(V-R):.5*(z+k),++F,++a.toiRootIters;var q=D.evaluate(j);if(D.indexA,D.indexB,h.abs(q-A)<w){L=j;break}if(q>A?(z=j,R=q):(k=j,V=q),50==F)break}if(a.toiMaxRootIters=h.max(a.toiMaxRootIters,F),++N==r.maxPolygonVertices)break}if(++E,++a.toiIters,O)break;if(E==T){t.state=v.e_failed,t.t=B;break}}a.toiMaxIters=h.max(a.toiMaxIters,E);var U=s.diff(i);a.toiMaxTime=h.max(a.toiMaxTime,U),a.toiTime+=U},t.exports.Input=function(){this.proxyA=new f,this.proxyB=new f,this.sweepA=new l,this.sweepB=new l,this.tMax},t.exports.Output=v;var r=i(1099),o=i(2274),s=i(9205),a=i(5489),h=i(5387),c=i(6306),u=(i(4470),i(6173),i(7515),i(3766)),l=i(5385),m=i(8850),p=(i(5235),i(8601),i(8054)),d=p.Input,_=p.Output,f=p.Proxy,y=p.Cache;function v(){this.state,this.t}function g(){this.m_proxyA=new f,this.m_proxyB=new f,this.m_sweepA,this.m_sweepB,this.indexA,this.indexB,this.m_type,this.m_localPoint=c.zero(),this.m_axis=c.zero()}v.e_unknown=0,v.e_failed=1,v.e_overlapped=2,v.e_touching=3,v.e_separated=4,a.toiTime=0,a.toiMaxTime=0,a.toiCalls=0,a.toiIters=0,a.toiMaxIters=0,a.toiRootIters=0,a.toiMaxRootIters=0,g.prototype.initialize=function(t,e,i,r,s,a){this.m_proxyA=e,this.m_proxyB=r;var h=t.count;n&&o.assert(0<h&&h<3),this.m_sweepA=i,this.m_sweepB=s;var l=m.identity(),p=m.identity();if(this.m_sweepA.getTransform(l,a),this.m_sweepB.getTransform(p,a),1==h){this.m_type=1;var d=this.m_proxyA.getVertex(t.indexA[0]),_=this.m_proxyB.getVertex(t.indexB[0]),f=m.mulVec2(l,d),y=m.mulVec2(p,_);return this.m_axis.setCombine(1,y,-1,f),this.m_axis.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=3;var v=r.getVertex(t.indexB[0]),g=r.getVertex(t.indexB[1]);this.m_axis=c.cross(c.sub(g,v),1),this.m_axis.normalize();var b=u.mulVec2(p.q,this.m_axis);return this.m_localPoint=c.mid(v,g),y=m.mulVec2(p,this.m_localPoint),d=e.getVertex(t.indexA[0]),f=m.mulVec2(l,d),(x=c.dot(f,b)-c.dot(y,b))<0&&(this.m_axis=c.neg(this.m_axis),x=-x),x}this.m_type=2;var x,A=this.m_proxyA.getVertex(t.indexA[0]),w=this.m_proxyA.getVertex(t.indexA[1]);return this.m_axis=c.cross(c.sub(w,A),1),this.m_axis.normalize(),b=u.mulVec2(l.q,this.m_axis),this.m_localPoint=c.mid(A,w),f=m.mulVec2(l,this.m_localPoint),_=this.m_proxyB.getVertex(t.indexB[0]),y=m.mulVec2(p,_),(x=c.dot(y,b)-c.dot(f,b))<0&&(this.m_axis=c.neg(this.m_axis),x=-x),x},g.prototype.compute=function(t,e){var i=m.identity(),r=m.identity();switch(this.m_sweepA.getTransform(i,e),this.m_sweepB.getTransform(r,e),this.m_type){case 1:if(t){var s=u.mulTVec2(i.q,this.m_axis),a=u.mulTVec2(r.q,c.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(s),this.indexB=this.m_proxyB.getSupport(a)}var h=this.m_proxyA.getVertex(this.indexA),l=this.m_proxyB.getVertex(this.indexB),p=m.mulVec2(i,h),d=m.mulVec2(r,l);return c.dot(d,this.m_axis)-c.dot(p,this.m_axis);case 2:var _=u.mulVec2(i.q,this.m_axis);return p=m.mulVec2(i,this.m_localPoint),t&&(a=u.mulTVec2(r.q,c.neg(_)),this.indexA=-1,this.indexB=this.m_proxyB.getSupport(a)),l=this.m_proxyB.getVertex(this.indexB),d=m.mulVec2(r,l),c.dot(d,_)-c.dot(p,_);case 3:return _=u.mulVec2(r.q,this.m_axis),d=m.mulVec2(r,this.m_localPoint),t&&(s=u.mulTVec2(i.q,c.neg(_)),this.indexB=-1,this.indexA=this.m_proxyA.getSupport(s)),h=this.m_proxyA.getVertex(this.indexA),p=m.mulVec2(i,h),c.dot(p,_)-c.dot(d,_);default:return n&&o.assert(!1),t&&(this.indexA=-1,this.indexB=-1),0}},g.prototype.findMinSeparation=function(t){return this.compute(!0,t)},g.prototype.evaluate=function(t){return this.compute(!1,t)}},6173:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var o=i(2274),s=(i(5387),i(6306));function a(t,e,i,n){"object"==typeof t&&null!==t?(this.ex=s.clone(t),this.ey=s.clone(e)):"number"==typeof t?(this.ex=s.neo(t,i),this.ey=s.neo(e,n)):(this.ex=s.zero(),this.ey=s.zero())}a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isValid(t.ex)&&s.isValid(t.ey)},a.assert=function(t){if(r&&!a.isValid(t))throw n&&o.debug(t),new Error("Invalid Mat22!")},a.prototype.set=function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof n?(this.ex.set(t,i),this.ey.set(e,n)):"object"==typeof t&&"object"==typeof e?(this.ex.set(t),this.ey.set(e)):"object"==typeof t?(r&&a.assert(t),this.ex.set(t.ex),this.ey.set(t.ey)):r&&o.assert(!1)},a.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},a.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},a.prototype.getInverse=function(){var t=this.ex.x,e=this.ey.x,i=this.ex.y,n=this.ey.y,r=t*n-e*i;0!=r&&(r=1/r);var o=new a;return o.ex.x=r*n,o.ey.x=-r*e,o.ex.y=-r*i,o.ey.y=r*t,o},a.prototype.solve=function(t){r&&s.assert(t);var e=this.ex.x,i=this.ey.x,n=this.ex.y,o=this.ey.y,a=e*o-i*n;0!=a&&(a=1/a);var h=s.zero();return h.x=a*(o*t.x-i*t.y),h.y=a*(e*t.y-n*t.x),h},a.mul=function(t,e){if(e&&"x"in e&&"y"in e){r&&s.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,n)}if(e&&"ex"in e&&"ey"in e)return r&&a.assert(e),new a(t.ex.x*e.ex.x+t.ey.x*e.ex.y,t.ex.x*e.ey.x+t.ey.x*e.ey.y,t.ex.y*e.ex.x+t.ey.y*e.ex.y,t.ex.y*e.ey.x+t.ey.y*e.ey.y);r&&o.assert(!1)},a.mulVec2=function(t,e){r&&s.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,n)},a.mulMat22=function(t,e){return r&&a.assert(e),new a(t.ex.x*e.ex.x+t.ey.x*e.ex.y,t.ex.x*e.ey.x+t.ey.x*e.ey.y,t.ex.y*e.ex.x+t.ey.y*e.ex.y,t.ex.y*e.ey.x+t.ey.y*e.ey.y)},a.mulT=function(t,e){return e&&"x"in e&&"y"in e?(r&&s.assert(e),s.neo(s.dot(e,t.ex),s.dot(e,t.ey))):e&&"ex"in e&&"ey"in e?(r&&a.assert(e),new a(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))):void(r&&o.assert(!1))},a.mulTVec2=function(t,e){return r&&a.assert(t),r&&s.assert(e),s.neo(s.dot(e,t.ex),s.dot(e,t.ey))},a.mulTMat22=function(t,e){return r&&a.assert(t),r&&a.assert(e),new a(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))},a.abs=function(t){return r&&a.assert(t),new a(s.abs(t.ex),s.abs(t.ey))},a.add=function(t,e){return r&&a.assert(t),r&&a.assert(e),new a(s.add(t.ex,e.ex),s.add(t.ey,e.ey))}},7515:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var o=i(2274),s=(i(5387),i(6306)),a=i(4470);function h(t,e,i){"object"==typeof t&&null!==t?(this.ex=a.clone(t),this.ey=a.clone(e),this.ez=a.clone(i)):(this.ex=a(),this.ey=a(),this.ez=a())}h.prototype.toString=function(){return JSON.stringify(this)},h.isValid=function(t){return t&&a.isValid(t.ex)&&a.isValid(t.ey)&&a.isValid(t.ez)},h.assert=function(t){if(r&&!h.isValid(t))throw n&&o.debug(t),new Error("Invalid Mat33!")},h.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},h.prototype.solve33=function(t){var e=a.dot(this.ex,a.cross(this.ey,this.ez));0!=e&&(e=1/e);var i=new a;return i.x=e*a.dot(t,a.cross(this.ey,this.ez)),i.y=e*a.dot(this.ex,a.cross(t,this.ez)),i.z=e*a.dot(this.ex,a.cross(this.ey,t)),i},h.prototype.solve22=function(t){var e=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y,o=e*r-i*n;0!=o&&(o=1/o);var a=s.zero();return a.x=o*(r*t.x-i*t.y),a.y=o*(e*t.y-n*t.x),a},h.prototype.getInverse22=function(t){var e=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y,o=e*r-i*n;0!=o&&(o=1/o),t.ex.x=o*r,t.ey.x=-o*i,t.ex.z=0,t.ex.y=-o*n,t.ey.y=o*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},h.prototype.getSymInverse33=function(t){var e=a.dot(this.ex,a.cross(this.ey,this.ez));0!=e&&(e=1/e);var i=this.ex.x,n=this.ey.x,r=this.ez.x,o=this.ey.y,s=this.ez.y,h=this.ez.z;t.ex.x=e*(o*h-s*s),t.ex.y=e*(r*s-n*h),t.ex.z=e*(n*s-r*o),t.ey.x=t.ex.y,t.ey.y=e*(i*h-r*r),t.ey.z=e*(r*n-i*s),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*o-n*n)},h.mul=function(t,e){if(r&&h.assert(t),e&&"z"in e&&"y"in e&&"x"in e){r&&a.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,n=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,c=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new a(i,n,c)}if(e&&"y"in e&&"x"in e)return r&&s.assert(e),i=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y,s.neo(i,n);r&&o.assert(!1)},h.mulVec3=function(t,e){r&&h.assert(t),r&&a.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,n=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,o=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new a(i,n,o)},h.mulVec2=function(t,e){r&&h.assert(t),r&&s.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,n)},h.add=function(t,e){return r&&h.assert(t),r&&h.assert(e),new h(a.add(t.ex,e.ex),a.add(t.ey,e.ey),a.add(t.ez,e.ez))}},5387:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT,o=i(2274),s=i(4175),a=Math,h=t.exports=s(a);h.EPSILON=1e-9,h.isFinite=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},h.assert=function(t){if(r&&!h.isFinite(t))throw n&&o.debug(t),new Error("Invalid Number!")},h.invSqrt=function(t){return 1/a.sqrt(t)},h.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16)},h.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},h.mod=function(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)},h.clamp=function(t,e,i){return t<e?e:t>i?i:t},h.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:a.random()*(e-t)+t}},8601:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=o;var n=i(6306),r=i(3766);function o(){this.c=n.zero(),this.a=0}o.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.set(n.sub(this.c,r.mulVec2(t.q,e))),t}},3766:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var o=i(2274),s=i(6306),a=i(5387);function h(t){if(!(this instanceof h))return new h(t);"number"==typeof t?this.setAngle(t):"object"==typeof t?this.set(t):this.setIdentity()}h.neo=function(t){var e=Object.create(h.prototype);return e.setAngle(t),e},h.clone=function(t){r&&h.assert(t);var e=Object.create(h.prototype);return e.s=t.s,e.c=t.c,e},h.identity=function(){var t=Object.create(h.prototype);return t.s=0,t.c=1,t},h.isValid=function(t){return t&&a.isFinite(t.s)&&a.isFinite(t.c)},h.assert=function(t){if(r&&!h.isValid(t))throw n&&o.debug(t),new Error("Invalid Rot!")},h.prototype.setIdentity=function(){this.s=0,this.c=1},h.prototype.set=function(t){"object"==typeof t?(r&&h.assert(t),this.s=t.s,this.c=t.c):(r&&a.assert(t),this.s=a.sin(t),this.c=a.cos(t))},h.prototype.setAngle=function(t){r&&a.assert(t),this.s=a.sin(t),this.c=a.cos(t)},h.prototype.getAngle=function(){return a.atan2(this.s,this.c)},h.prototype.getXAxis=function(){return s.neo(this.c,this.s)},h.prototype.getYAxis=function(){return s.neo(-this.s,this.c)},h.mul=function(t,e){if(r&&h.assert(t),"c"in e&&"s"in e){r&&h.assert(e);var i=h.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i}if("x"in e&&"y"in e)return r&&s.assert(e),s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},h.mulRot=function(t,e){r&&h.assert(t),r&&h.assert(e);var i=h.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i},h.mulVec2=function(t,e){return r&&h.assert(t),r&&s.assert(e),s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},h.mulSub=function(t,e,i){var n=t.c*(e.x-i.x)-t.s*(e.y-i.y),r=t.s*(e.x-i.x)+t.c*(e.y-i.y);return s.neo(n,r)},h.mulT=function(t,e){if("c"in e&&"s"in e){r&&h.assert(e);var i=h.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i}if("x"in e&&"y"in e)return r&&s.assert(e),s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},h.mulTRot=function(t,e){r&&h.assert(e);var i=h.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i},h.mulTVec2=function(t,e){return r&&s.assert(e),s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}},5385:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=c;var r=i(2274),o=i(5387),s=i(6306),a=i(3766),h=i(8850);function c(t,e){n&&r.assert(void 0===t),n&&r.assert(void 0===e),this.localCenter=s.zero(),this.c=s.zero(),this.a=0,this.alpha0=0,this.c0=s.zero(),this.a0=0}c.prototype.setTransform=function(t){var e=h.mulVec2(t,this.localCenter);this.c.set(e),this.c0.set(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()},c.prototype.setLocalCenter=function(t,e){this.localCenter.set(t);var i=h.mulVec2(e,this.localCenter);this.c.set(i),this.c0.set(i)},c.prototype.getTransform=function(t,e){e=void 0===e?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.setCombine(1-e,this.c0,e,this.c),t.p.sub(a.mulVec2(t.q,this.localCenter))},c.prototype.advance=function(t){n&&r.assert(this.alpha0<1);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.setCombine(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},c.prototype.forward=function(){this.a0=this.a,this.c0.set(this.c)},c.prototype.normalize=function(){var t=o.mod(this.a0,-o.PI,+o.PI);this.a-=this.a0-t,this.a0=t},c.prototype.clone=function(){var t=new c;return t.localCenter.set(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.set(this.c0),t.c.set(this.c),t},c.prototype.set=function(t){this.localCenter.set(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.set(t.c0),this.c.set(t.c)}},8850:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var o=i(2274),s=i(6306),a=i(3766);function h(t,e){if(!(this instanceof h))return new h(t,e);this.p=s.zero(),this.q=a.identity(),void 0!==t&&this.p.set(t),void 0!==e&&this.q.set(e)}h.clone=function(t){var e=Object.create(h.prototype);return e.p=s.clone(t.p),e.q=a.clone(t.q),e},h.neo=function(t,e){var i=Object.create(h.prototype);return i.p=s.clone(t),i.q=a.clone(e),i},h.identity=function(){var t=Object.create(h.prototype);return t.p=s.zero(),t.q=a.identity(),t},h.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},h.prototype.set=function(t,e){void 0===e?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))},h.isValid=function(t){return t&&s.isValid(t.p)&&a.isValid(t.q)},h.assert=function(t){if(r&&!h.isValid(t))throw n&&o.debug(t),new Error("Invalid Transform!")},h.mul=function(t,e){if(r&&h.assert(t),Array.isArray(e)){for(var i=[],n=0;n<e.length;n++)i[n]=h.mul(t,e[n]);return i}if("x"in e&&"y"in e){r&&s.assert(e);var o=t.q.c*e.x-t.q.s*e.y+t.p.x,c=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(o,c)}if("p"in e&&"q"in e){r&&h.assert(e);var u=h.identity();return u.q=a.mulRot(t.q,e.q),u.p=s.add(a.mulVec2(t.q,e.p),t.p),u}},h.mulAll=function(t,e){r&&h.assert(t);for(var i=[],n=0;n<e.length;n++)i[n]=h.mul(t,e[n]);return i},h.mulFn=function(t){return r&&h.assert(t),function(e){return h.mul(t,e)}},h.mulVec2=function(t,e){r&&h.assert(t),r&&s.assert(e);var i=t.q.c*e.x-t.q.s*e.y+t.p.x,n=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(i,n)},h.mulXf=function(t,e){r&&h.assert(t),r&&h.assert(e);var i=h.identity();return i.q=a.mulRot(t.q,e.q),i.p=s.add(a.mulVec2(t.q,e.p),t.p),i},h.mulT=function(t,e){if(r&&h.assert(t),"x"in e&&"y"in e){r&&s.assert(e);var i=e.x-t.p.x,n=e.y-t.p.y,o=t.q.c*i+t.q.s*n,c=-t.q.s*i+t.q.c*n;return s.neo(o,c)}if("p"in e&&"q"in e){r&&h.assert(e);var u=h.identity();return u.q.set(a.mulTRot(t.q,e.q)),u.p.set(a.mulTVec2(t.q,s.sub(e.p,t.p))),u}},h.mulTVec2=function(t,e){r&&h.assert(t),r&&s.assert(e);var i=e.x-t.p.x,n=e.y-t.p.y,o=t.q.c*i+t.q.s*n,a=-t.q.s*i+t.q.c*n;return s.neo(o,a)},h.mulTXf=function(t,e){r&&h.assert(t),r&&h.assert(e);var i=h.identity();return i.q.set(a.mulTRot(t.q,e.q)),i.p.set(a.mulTVec2(t.q,s.sub(e.p,t.p))),i}},6306:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var o=i(2274),s=i(5387);function a(t,e){if(!(this instanceof a))return new a(t,e);void 0===t?(this.x=0,this.y=0):"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),r&&a.assert(this)}a.prototype._serialize=function(){return{x:this.x,y:this.y}},a._deserialize=function(t){var e=Object.create(a.prototype);return e.x=t.x,e.y=t.y,e},a.zero=function(){var t=Object.create(a.prototype);return t.x=0,t.y=0,t},a.neo=function(t,e){var i=Object.create(a.prototype);return i.x=t,i.y=e,i},a.clone=function(t){return r&&a.assert(t),a.neo(t.x,t.y)},a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)},a.assert=function(t){if(r&&!a.isValid(t))throw n&&o.debug(t),new Error("Invalid Vec2!")},a.prototype.clone=function(){return a.clone(this)},a.prototype.setZero=function(){return this.x=0,this.y=0,this},a.prototype.set=function(t,e){return"object"==typeof t?(r&&a.assert(t),this.x=t.x,this.y=t.y):(r&&s.assert(t),r&&s.assert(e),this.x=t,this.y=e),this},a.prototype.wSet=function(t,e,i,n){return void 0!==i||void 0!==n?this.setCombine(t,e,i,n):this.setMul(t,e)},a.prototype.setCombine=function(t,e,i,n){r&&s.assert(t),r&&a.assert(e),r&&s.assert(i),r&&a.assert(n);var o=t*e.x+i*n.x,h=t*e.y+i*n.y;return this.x=o,this.y=h,this},a.prototype.setMul=function(t,e){r&&s.assert(t),r&&a.assert(e);var i=t*e.x,n=t*e.y;return this.x=i,this.y=n,this},a.prototype.add=function(t){return r&&a.assert(t),this.x+=t.x,this.y+=t.y,this},a.prototype.wAdd=function(t,e,i,n){return void 0!==i||void 0!==n?this.addCombine(t,e,i,n):this.addMul(t,e)},a.prototype.addCombine=function(t,e,i,n){r&&s.assert(t),r&&a.assert(e),r&&s.assert(i),r&&a.assert(n);var o=t*e.x+i*n.x,h=t*e.y+i*n.y;return this.x+=o,this.y+=h,this},a.prototype.addMul=function(t,e){r&&s.assert(t),r&&a.assert(e);var i=t*e.x,n=t*e.y;return this.x+=i,this.y+=n,this},a.prototype.wSub=function(t,e,i,n){return void 0!==i||void 0!==n?this.subCombine(t,e,i,n):this.subMul(t,e)},a.prototype.subCombine=function(t,e,i,n){r&&s.assert(t),r&&a.assert(e),r&&s.assert(i),r&&a.assert(n);var o=t*e.x+i*n.x,h=t*e.y+i*n.y;return this.x-=o,this.y-=h,this},a.prototype.subMul=function(t,e){r&&s.assert(t),r&&a.assert(e);var i=t*e.x,n=t*e.y;return this.x-=i,this.y-=n,this},a.prototype.sub=function(t){return r&&a.assert(t),this.x-=t.x,this.y-=t.y,this},a.prototype.mul=function(t){return r&&s.assert(t),this.x*=t,this.y*=t,this},a.prototype.length=function(){return a.lengthOf(this)},a.prototype.lengthSquared=function(){return a.lengthSquared(this)},a.prototype.normalize=function(){var t=this.length();if(t<s.EPSILON)return 0;var e=1/t;return this.x*=e,this.y*=e,t},a.lengthOf=function(t){return r&&a.assert(t),s.sqrt(t.x*t.x+t.y*t.y)},a.lengthSquared=function(t){return r&&a.assert(t),t.x*t.x+t.y*t.y},a.distance=function(t,e){r&&a.assert(t),r&&a.assert(e);var i=t.x-e.x,n=t.y-e.y;return s.sqrt(i*i+n*n)},a.distanceSquared=function(t,e){r&&a.assert(t),r&&a.assert(e);var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},a.areEqual=function(t,e){return r&&a.assert(t),r&&a.assert(e),t==e||"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y},a.skew=function(t){return r&&a.assert(t),a.neo(-t.y,t.x)},a.dot=function(t,e){return r&&a.assert(t),r&&a.assert(e),t.x*e.x+t.y*e.y},a.cross=function(t,e){return"number"==typeof e?(r&&a.assert(t),r&&s.assert(e),a.neo(e*t.y,-e*t.x)):"number"==typeof t?(r&&s.assert(t),r&&a.assert(e),a.neo(-t*e.y,t*e.x)):(r&&a.assert(t),r&&a.assert(e),t.x*e.y-t.y*e.x)},a.addCross=function(t,e,i){return"number"==typeof i?(r&&a.assert(e),r&&s.assert(i),a.neo(i*e.y+t.x,-i*e.x+t.y)):"number"==typeof e?(r&&s.assert(e),r&&a.assert(i),a.neo(-e*i.y+t.x,e*i.x+t.y)):void(r&&o.assert(!1))},a.add=function(t,e){return r&&a.assert(t),r&&a.assert(e),a.neo(t.x+e.x,t.y+e.y)},a.wAdd=function(t,e,i,n){return void 0!==i||void 0!==n?a.combine(t,e,i,n):a.mul(t,e)},a.combine=function(t,e,i,n){return a.zero().setCombine(t,e,i,n)},a.sub=function(t,e){return r&&a.assert(t),r&&a.assert(e),a.neo(t.x-e.x,t.y-e.y)},a.mul=function(t,e){return"object"==typeof t?(r&&a.assert(t),r&&s.assert(e),a.neo(t.x*e,t.y*e)):"object"==typeof e?(r&&s.assert(t),r&&a.assert(e),a.neo(t*e.x,t*e.y)):void 0},a.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},a.neg=function(t){return r&&a.assert(t),a.neo(-t.x,-t.y)},a.abs=function(t){return r&&a.assert(t),a.neo(s.abs(t.x),s.abs(t.y))},a.mid=function(t,e){return r&&a.assert(t),r&&a.assert(e),a.neo(.5*(t.x+e.x),.5*(t.y+e.y))},a.upper=function(t,e){return r&&a.assert(t),r&&a.assert(e),a.neo(s.max(t.x,e.x),s.max(t.y,e.y))},a.lower=function(t,e){return r&&a.assert(t),r&&a.assert(e),a.neo(s.min(t.x,e.x),s.min(t.y,e.y))},a.prototype.clamp=function(t){var e=this.x*this.x+this.y*this.y;if(e>t*t){var i=s.invSqrt(e);this.x*=i*t,this.y*=i*t}return this},a.clamp=function(t,e){return(t=a.neo(t.x,t.y)).clamp(e),t},a.scaleFn=function(t,e){return function(i){return a.neo(i.x*t,i.y*e)}},a.translateFn=function(t,e){return function(i){return a.neo(i.x+t,i.y+e)}}},4470:(t,e,i)=>{var n="undefined"!=typeof DEBUG&&DEBUG,r="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var o=i(2274),s=i(5387);function a(t,e,i){if(!(this instanceof a))return new a(t,e,i);void 0===t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),r&&a.assert(this)}a.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}},a._deserialize=function(t){var e=Object.create(a.prototype);return e.x=t.x,e.y=t.y,e.z=t.z,e},a.neo=function(t,e,i){var n=Object.create(a.prototype);return n.x=t,n.y=e,n.z=i,n},a.clone=function(t){return r&&a.assert(t),a.neo(t.x,t.y,t.z)},a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)&&s.isFinite(t.z)},a.assert=function(t){if(r&&!a.isValid(t))throw n&&o.debug(t),new Error("Invalid Vec3!")},a.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},a.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},a.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},a.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},a.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},a.areEqual=function(t,e){return r&&a.assert(t),r&&a.assert(e),t==e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y&&t.z===e.z},a.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},a.cross=function(t,e){return new a(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},a.add=function(t,e){return new a(t.x+e.x,t.y+e.y,t.z+e.z)},a.sub=function(t,e){return new a(t.x-e.x,t.y-e.y,t.z-e.z)},a.mul=function(t,e){return new a(e*t.x,e*t.y,e*t.z)},a.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},a.neg=function(t){return new a(-t.x,-t.y,-t.z)}},5235:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=function(){this.v=n.zero(),this.w=0};var n=i(6306)},5489:(t,e)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,e.toString=function(t){t="string"==typeof t?t:"\n";var e="";for(var i in this)"function"!=typeof this[i]&&"object"!=typeof this[i]&&(e+=i+": "+this[i]+t);return e}},3875:(t,e,i)=>{e.Serializer=i(2134),i(5387),e.Vec2=i(6306),e.Vec3=i(4470),i(6173),e.Mat33=i(7515),e.Transform=i(8850),i(3766),i(3406),i(2322),i(662),i(2129),i(8730),i(5878),e.World=i(6972),e.Circle=i(3335),e.Edge=i(3581),e.Polygon=i(8901),e.Chain=i(2642),e.Box=i(7639),i(8871),i(1867),i(6891),i(9415),i(9221),i(3343),i(342),i(155),i(2371),i(1952),i(7200),i(9087),i(8087),i(1347),i(1415),i(2707),i(5385),i(5489),i(226),i(8054),i(8650),i(2454),i(1099)},3343:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=m;var n=i(4896),r=i(4175),o=i(1099),s=i(5387),a=i(6306),h=(i(4470),i(6173),i(7515),i(3766)),c=(i(5385),i(8850),i(5235),i(8601),i(5878)),u=i(2129);m.TYPE="distance-joint",c.TYPES[m.TYPE]=m,m._super=c,m.prototype=r(m._super.prototype);var l={frequencyHz:0,dampingRatio:0};function m(t,e,i,r,o){if(!(this instanceof m))return new m(t,e,i,r,o);if(i&&r&&"m_type"in r&&"x"in i&&"y"in i){var h=i;i=r,r=h}t=n(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=m.TYPE,this.m_localAnchorA=a.clone(r?e.getLocalPoint(r):t.localAnchorA||a.zero()),this.m_localAnchorB=a.clone(o?i.getLocalPoint(o):t.localAnchorB||a.zero()),this.m_length=s.isFinite(t.length)?t.length:a.distance(e.getWorldPoint(this.m_localAnchorA),i.getWorldPoint(this.m_localAnchorB)),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}m.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}},m._deserialize=function(t,e,i){return t.bodyA=i(u,t.bodyA,e),t.bodyB=i(u,t.bodyB,e),new m(t)},m.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.length>0?this.m_length=+t.length:t.length<0||(t.anchorA||t.anchorA||t.anchorA||t.anchorA)&&(this.m_length=a.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.setLength=function(t){this.m_length=t},m.prototype.getLength=function(){return this.m_length},m.prototype.setFrequency=function(t){this.m_frequencyHz=t},m.prototype.getFrequency=function(){return this.m_frequencyHz},m.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},m.prototype.getDampingRatio=function(){return this.m_dampingRatio},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.mul(this.m_impulse,this.m_u).mul(t)},m.prototype.getReactionTorque=function(t){return 0},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_position.c,u=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,p=h.neo(i),d=h.neo(u);this.m_rA=h.mulVec2(p,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(d,a.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=a.sub(a.add(c,this.m_rB),a.add(e,this.m_rA));var _=this.m_u.length();_>o.linearSlop?this.m_u.mul(1/_):this.m_u.set(0,0);var f=a.cross(this.m_rA,this.m_u),y=a.cross(this.m_rB,this.m_u),v=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!=v?1/v:0,this.m_frequencyHz>0){var g=_-this.m_length,b=2*s.PI*this.m_frequencyHz,x=2*this.m_mass*this.m_dampingRatio*b,A=this.m_mass*b*b,w=t.dt;this.m_gamma=w*(x+w*A),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=g*w*A*this.m_gamma,v+=this.m_gamma,this.m_mass=0!=v?1/v:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;var B=a.mul(this.m_impulse,this.m_u);n.subMul(this.m_invMassA,B),r-=this.m_invIA*a.cross(this.m_rA,B),l.addMul(this.m_invMassB,B),m+=this.m_invIB*a.cross(this.m_rB,B)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=m},m.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=a.add(e,a.cross(i,this.m_rA)),s=a.add(n,a.cross(r,this.m_rB)),h=a.dot(this.m_u,s)-a.dot(this.m_u,o),c=-this.m_mass*(h+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c;var u=a.mul(c,this.m_u);e.subMul(this.m_invMassA,u),i-=this.m_invIA*a.cross(this.m_rA,u),n.addMul(this.m_invMassB,u),r+=this.m_invIB*a.cross(this.m_rB,u),this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(n),this.m_bodyB.c_velocity.w=r},m.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,c=h.neo(i),u=h.neo(r),l=h.mulSub(c,this.m_localAnchorA,this.m_localCenterA),m=h.mulSub(u,this.m_localAnchorB,this.m_localCenterB),p=a.sub(a.add(n,m),a.add(e,l)),d=p.normalize()-this.m_length;d=s.clamp(d,-o.maxLinearCorrection,o.maxLinearCorrection);var _=-this.m_mass*d,f=a.mul(_,p);return e.subMul(this.m_invMassA,f),i-=this.m_invIA*a.cross(l,f),n.addMul(this.m_invMassB,f),r+=this.m_invIB*a.cross(m,f),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=r,s.abs(d)<o.linearSlop}},342:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=d;var r=i(2274),o=i(4896),s=i(4175),a=(i(1099),i(5387)),h=i(6306),c=(i(4470),i(6173)),u=(i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);d.TYPE="friction-joint",l.TYPES[d.TYPE]=d,d._super=l,d.prototype=s(d._super.prototype);var p={maxForce:0,maxTorque:0};function d(t,e,i,n){if(!(this instanceof d))return new d(t,e,i,n);t=o(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||h.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||h.zero(),this.m_linearImpulse=h.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}d.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}},d._deserialize=function(t,e,i){return t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),new d(t)},d.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},d.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},d.prototype.setMaxForce=function(t){n&&r.assert(a.isFinite(t)&&t>=0),this.m_maxForce=t},d.prototype.getMaxForce=function(){return this.m_maxForce},d.prototype.setMaxTorque=function(t){n&&r.assert(a.isFinite(t)&&t>=0),this.m_maxTorque=t},d.prototype.getMaxTorque=function(){return this.m_maxTorque},d.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t){return h.mul(t,this.m_linearImpulse)},d.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},d.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=u.neo(e),l=u.neo(r);this.m_rA=u.mulVec2(a,h.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mulVec2(l,h.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,_=this.m_invIB,f=new c;if(f.ex.x=m+p+d*this.m_rA.y*this.m_rA.y+_*this.m_rB.y*this.m_rB.y,f.ex.y=-d*this.m_rA.x*this.m_rA.y-_*this.m_rB.x*this.m_rB.y,f.ey.x=f.ex.y,f.ey.y=m+p+d*this.m_rA.x*this.m_rA.x+_*this.m_rB.x*this.m_rB.x,this.m_linearMass=f.getInverse(),this.m_angularMass=d+_,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var y=h.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(m,y),n-=d*(h.cross(this.m_rA,y)+this.m_angularImpulse),o.addMul(p,y),s+=_*(h.cross(this.m_rB,y)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,u=this.m_invIA,l=this.m_invIB,m=t.dt,p=r-i,d=-this.m_angularMass*p,_=this.m_angularImpulse,f=m*this.m_maxTorque;this.m_angularImpulse=a.clamp(this.m_angularImpulse+d,-f,f),i-=u*(d=this.m_angularImpulse-_),r+=l*d,p=h.sub(h.add(n,h.cross(r,this.m_rB)),h.add(e,h.cross(i,this.m_rA))),d=h.neg(c.mulVec2(this.m_linearMass,p)),_=this.m_linearImpulse,this.m_linearImpulse.add(d),f=m*this.m_maxForce,this.m_linearImpulse.lengthSquared()>f*f&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(f)),d=h.sub(this.m_linearImpulse,_),e.subMul(o,d),i-=u*h.cross(this.m_rA,d),n.addMul(s,d),r+=l*h.cross(this.m_rB,d),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},d.prototype.solvePositionConstraints=function(t){return!0}},155:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=f;var r=i(2274),o=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=(i(4470),i(6173),i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129),p=i(8087),d=i(7200);f.TYPE="gear-joint",l.TYPES[f.TYPE]=f,f._super=l,f.prototype=s(f._super.prototype);var _={ratio:1};function f(t,e,i,s,a,m){if(!(this instanceof f))return new f(t,e,i,s,a,m);var y,v;t=o(t,_),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=f.TYPE,n&&r.assert(s.m_type===p.TYPE||s.m_type===d.TYPE),n&&r.assert(a.m_type===p.TYPE||a.m_type===d.TYPE),this.m_joint1=s||t.joint1,this.m_joint2=a||t.joint2,this.m_ratio=h.isFinite(m)?m:t.ratio,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType(),this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();var g=this.m_bodyA.m_xf,b=this.m_bodyA.m_sweep.a,x=this.m_bodyC.m_xf,A=this.m_bodyC.m_sweep.a;if(this.m_type1===p.TYPE){var w=this.m_joint1;this.m_localAnchorC=w.m_localAnchorA,this.m_localAnchorA=w.m_localAnchorB,this.m_referenceAngleA=w.m_referenceAngle,this.m_localAxisC=c.zero(),y=b-A-this.m_referenceAngleA}else{var B=this.m_joint1;this.m_localAnchorC=B.m_localAnchorA,this.m_localAnchorA=B.m_localAnchorB,this.m_referenceAngleA=B.m_referenceAngle,this.m_localAxisC=B.m_localXAxisA;var T=this.m_localAnchorC,E=u.mulTVec2(x.q,c.add(u.mul(g.q,this.m_localAnchorA),c.sub(g.p,x.p)));y=c.dot(E,this.m_localAxisC)-c.dot(T,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();var C=this.m_bodyB.m_xf,S=this.m_bodyB.m_sweep.a,I=this.m_bodyD.m_xf,M=this.m_bodyD.m_sweep.a;if(this.m_type2===p.TYPE)w=this.m_joint2,this.m_localAnchorD=w.m_localAnchorA,this.m_localAnchorB=w.m_localAnchorB,this.m_referenceAngleB=w.m_referenceAngle,this.m_localAxisD=c.zero(),v=S-M-this.m_referenceAngleB;else{B=this.m_joint2,this.m_localAnchorD=B.m_localAnchorA,this.m_localAnchorB=B.m_localAnchorB,this.m_referenceAngleB=B.m_referenceAngle,this.m_localAxisD=B.m_localXAxisA;var P=this.m_localAnchorD,D=u.mulTVec2(I.q,c.add(u.mul(C.q,this.m_localAnchorB),c.sub(C.p,I.p)));v=c.dot(D,this.m_localAxisD)-c.dot(P,this.m_localAxisD)}this.m_constant=y+this.m_ratio*v,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}f.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio,_constant:this.m_constant}},f._deserialize=function(t,e,i){t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),t.joint1=i(l,t.joint1,e),t.joint2=i(l,t.joint2,e);var n=new f(t);return t._constant&&(n.m_constant=t._constant),n},f.prototype.getJoint1=function(){return this.m_joint1},f.prototype.getJoint2=function(){return this.m_joint2},f.prototype.setRatio=function(t){n&&r.assert(h.isFinite(t)),this.m_ratio=t},f.prototype.getRatio=function(){return this.m_ratio},f.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},f.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},f.prototype.getReactionForce=function(t){return c.mul(this.m_impulse,this.m_JvAC).mul(t)},f.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},f.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_position.a,h=this.m_bodyC.c_velocity.v,l=this.m_bodyC.c_velocity.w,m=this.m_bodyD.c_position.a,d=this.m_bodyD.c_velocity.v,_=this.m_bodyD.c_velocity.w,f=u.neo(e),y=u.neo(r),v=u.neo(a),g=u.neo(m);if(this.m_mass=0,this.m_type1==p.TYPE)this.m_JvAC=c.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var b=u.mulVec2(v,this.m_localAxisC),x=u.mulSub(v,this.m_localAnchorC,this.m_lcC),A=u.mulSub(f,this.m_localAnchorA,this.m_lcA);this.m_JvAC=b,this.m_JwC=c.cross(x,b),this.m_JwA=c.cross(A,b),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==p.TYPE)this.m_JvBD=c.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{b=u.mulVec2(g,this.m_localAxisD);var w=u.mulSub(g,this.m_localAnchorD,this.m_lcD),B=u.mulSub(y,this.m_localAnchorB,this.m_lcB);this.m_JvBD=c.mul(this.m_ratio,b),this.m_JwD=this.m_ratio*c.cross(w,b),this.m_JwB=this.m_ratio*c.cross(B,b),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(i.addMul(this.m_mA*this.m_impulse,this.m_JvAC),n+=this.m_iA*this.m_impulse*this.m_JwA,o.addMul(this.m_mB*this.m_impulse,this.m_JvBD),s+=this.m_iB*this.m_impulse*this.m_JwB,h.subMul(this.m_mC*this.m_impulse,this.m_JvAC),l-=this.m_iC*this.m_impulse*this.m_JwC,d.subMul(this.m_mD*this.m_impulse,this.m_JvBD),_-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(o),this.m_bodyB.c_velocity.w=s,this.m_bodyC.c_velocity.v.set(h),this.m_bodyC.c_velocity.w=l,this.m_bodyD.c_velocity.v.set(d),this.m_bodyD.c_velocity.w=_},f.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=this.m_bodyC.c_velocity.v,s=this.m_bodyC.c_velocity.w,a=this.m_bodyD.c_velocity.v,h=this.m_bodyD.c_velocity.w,u=c.dot(this.m_JvAC,e)-c.dot(this.m_JvAC,o)+c.dot(this.m_JvBD,n)-c.dot(this.m_JvBD,a);u+=this.m_JwA*i-this.m_JwC*s+(this.m_JwB*r-this.m_JwD*h);var l=-this.m_mass*u;this.m_impulse+=l,e.addMul(this.m_mA*l,this.m_JvAC),i+=this.m_iA*l*this.m_JwA,n.addMul(this.m_mB*l,this.m_JvBD),r+=this.m_iB*l*this.m_JwB,o.subMul(this.m_mC*l,this.m_JvAC),s-=this.m_iC*l*this.m_JwC,a.subMul(this.m_mD*l,this.m_JvBD),h-=this.m_iD*l*this.m_JwD,this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(n),this.m_bodyB.c_velocity.w=r,this.m_bodyC.c_velocity.v.set(o),this.m_bodyC.c_velocity.w=s,this.m_bodyD.c_velocity.v.set(a),this.m_bodyD.c_velocity.w=h},f.prototype.solvePositionConstraints=function(t){var e,i,n,r,o,s,h,l,m=this.m_bodyA.c_position.c,d=this.m_bodyA.c_position.a,_=this.m_bodyB.c_position.c,f=this.m_bodyB.c_position.a,y=this.m_bodyC.c_position.c,v=this.m_bodyC.c_position.a,g=this.m_bodyD.c_position.c,b=this.m_bodyD.c_position.a,x=u.neo(d),A=u.neo(f),w=u.neo(v),B=u.neo(b),T=0;if(this.m_type1==p.TYPE)n=c.zero(),o=1,h=1,T+=this.m_iA+this.m_iC,e=d-v-this.m_referenceAngleA;else{var E=u.mulVec2(w,this.m_localAxisC),C=u.mulSub(w,this.m_localAnchorC,this.m_lcC),S=u.mulSub(x,this.m_localAnchorA,this.m_lcA);n=E,h=c.cross(C,E),o=c.cross(S,E),T+=this.m_mC+this.m_mA+this.m_iC*h*h+this.m_iA*o*o;var I=c.sub(this.m_localAnchorC,this.m_lcC),M=u.mulTVec2(w,c.add(S,c.sub(m,y)));e=c.dot(c.sub(M,I),this.m_localAxisC)}if(this.m_type2==p.TYPE)r=c.zero(),s=this.m_ratio,l=this.m_ratio,T+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),i=f-b-this.m_referenceAngleB;else{E=u.mulVec2(B,this.m_localAxisD);var P=u.mulSub(B,this.m_localAnchorD,this.m_lcD),D=u.mulSub(A,this.m_localAnchorB,this.m_lcB);r=c.mul(this.m_ratio,E),l=this.m_ratio*c.cross(P,E),s=this.m_ratio*c.cross(D,E),T+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*l*l+this.m_iB*s*s;var O=c.sub(this.m_localAnchorD,this.m_lcD),L=u.mulTVec2(B,c.add(D,c.sub(_,g)));i=c.dot(L,this.m_localAxisD)-c.dot(O,this.m_localAxisD)}var N=e+this.m_ratio*i-this.m_constant,V=0;return T>0&&(V=-N/T),m.addMul(this.m_mA*V,n),d+=this.m_iA*V*o,_.addMul(this.m_mB*V,r),f+=this.m_iB*V*s,y.subMul(this.m_mC*V,n),v-=this.m_iC*V*h,g.subMul(this.m_mD*V,r),b-=this.m_iD*V*l,this.m_bodyA.c_position.c.set(m),this.m_bodyA.c_position.a=d,this.m_bodyB.c_position.c.set(_),this.m_bodyB.c_position.a=f,this.m_bodyC.c_position.c.set(y),this.m_bodyC.c_position.a=v,this.m_bodyD.c_position.c.set(g),this.m_bodyD.c_position.a=b,0<a.linearSlop}},2371:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=d;var r=i(2274),o=i(4896),s=i(4175),a=(i(1099),i(5387)),h=i(6306),c=(i(4470),i(6173)),u=(i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);d.TYPE="motor-joint",l.TYPES[d.TYPE]=d,d._super=l,d.prototype=s(d._super.prototype);var p={maxForce:1,maxTorque:1,correctionFactor:.3};function d(t,e,i){if(!(this instanceof d))return new d(t,e,i);t=o(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,this.m_linearOffset=t.linearOffset?t.linearOffset:e.getLocalPoint(i.getPosition());var n=e.getAngle(),r=i.getAngle();this.m_angularOffset=r-n,this.m_linearImpulse=h.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}d.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,linearOffset:this.m_linearOffset,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,_angularOffset:this.m_angularOffset}},d._deserialize=function(t,e,i){t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e);var n=new d(t);return t._angularOffset&&(n.m_angularOffset=t._angularOffset),n},d.prototype.setMaxForce=function(t){n&&r.assert(a.isFinite(t)&&t>=0),this.m_maxForce=t},d.prototype.getMaxForce=function(){return this.m_maxForce},d.prototype.setMaxTorque=function(t){n&&r.assert(a.isFinite(t)&&t>=0),this.m_maxTorque=t},d.prototype.getMaxTorque=function(){return this.m_maxTorque},d.prototype.setCorrectionFactor=function(t){n&&r.assert(a.isFinite(t)&&0<=t&&t<=1),this.m_correctionFactor=t},d.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},d.prototype.setLinearOffset=function(t){t.x==this.m_linearOffset.x&&t.y==this.m_linearOffset.y||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t)},d.prototype.getLinearOffset=function(){return this.m_linearOffset},d.prototype.setAngularOffset=function(t){t!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t)},d.prototype.getAngularOffset=function(){return this.m_angularOffset},d.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},d.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},d.prototype.getReactionForce=function(t){return h.mul(t,this.m_linearImpulse)},d.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},d.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=u.neo(i),p=u.neo(s);this.m_rA=u.mulVec2(m,h.neg(this.m_localCenterA)),this.m_rB=u.mulVec2(p,h.neg(this.m_localCenterB));var d=this.m_invMassA,_=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=new c;if(v.ex.x=d+_+f*this.m_rA.y*this.m_rA.y+y*this.m_rB.y*this.m_rB.y,v.ex.y=-f*this.m_rA.x*this.m_rA.y-y*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=d+_+f*this.m_rA.x*this.m_rA.x+y*this.m_rB.x*this.m_rB.x,this.m_linearMass=v.getInverse(),this.m_angularMass=f+y,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=h.zero(),this.m_linearError.addCombine(1,o,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_linearError.sub(u.mulVec2(m,this.m_linearOffset)),this.m_angularError=s-i-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var g=h.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);n.subMul(d,g),r-=f*(h.cross(this.m_rA,g)+this.m_angularImpulse),a.addMul(_,g),l+=y*(h.cross(this.m_rB,g)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=l},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,u=this.m_invIA,l=this.m_invIB,m=t.dt,p=t.inv_dt,d=r-i+p*this.m_correctionFactor*this.m_angularError,_=-this.m_angularMass*d,f=this.m_angularImpulse,y=m*this.m_maxTorque;this.m_angularImpulse=a.clamp(this.m_angularImpulse+_,-y,y),i-=u*(_=this.m_angularImpulse-f),r+=l*_,(d=h.zero()).addCombine(1,n,1,h.cross(r,this.m_rB)),d.subCombine(1,e,1,h.cross(i,this.m_rA)),d.addMul(p*this.m_correctionFactor,this.m_linearError),_=h.neg(c.mulVec2(this.m_linearMass,d)),f=h.clone(this.m_linearImpulse),this.m_linearImpulse.add(_),y=m*this.m_maxForce,this.m_linearImpulse.clamp(y),_=h.sub(this.m_linearImpulse,f),e.subMul(o,_),i-=u*h.cross(this.m_rA,_),n.addMul(s,_),r+=l*h.cross(this.m_rB,_),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},d.prototype.solvePositionConstraints=function(t){return!0}},1952:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=_;var r=i(2274),o=i(4896),s=i(4175),a=i(5387),h=i(6306),c=(i(4470),i(6173)),u=(i(7515),i(3766)),l=(i(5385),i(8850)),m=(i(5235),i(8601),i(5878)),p=i(2129);_.TYPE="mouse-joint",m.TYPES[_.TYPE]=_,_._super=m,_.prototype=s(_._super.prototype);var d={maxForce:0,frequencyHz:5,dampingRatio:.7};function _(t,e,i,s){if(!(this instanceof _))return new _(t,e,i,s);t=o(t,d),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,n&&r.assert(a.isFinite(t.maxForce)&&t.maxForce>=0),n&&r.assert(a.isFinite(t.frequencyHz)&&t.frequencyHz>=0),n&&r.assert(a.isFinite(t.dampingRatio)&&t.dampingRatio>=0),this.m_targetA=s?h.clone(s):t.target||h.zero(),this.m_localAnchorB=l.mulTVec2(i.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=h.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=h.zero(),this.m_localCenterB=h.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new c,this.m_C=h.zero()}_.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}},_._deserialize=function(t,e,i){t.bodyA=i(p,t.bodyA,e),t.bodyB=i(p,t.bodyB,e),t.target=h(t.target);var n=new _(t);return t._localAnchorB&&(n.m_localAnchorB=t._localAnchorB),n},_.prototype.setTarget=function(t){0==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0),this.m_targetA=h.clone(t)},_.prototype.getTarget=function(){return this.m_targetA},_.prototype.setMaxForce=function(t){this.m_maxForce=t},_.getMaxForce=function(){return this.m_maxForce},_.prototype.setFrequency=function(t){this.m_frequencyHz=t},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return h.clone(this.m_targetA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return h.mul(t,this.m_impulse)},_.prototype.getReactionTorque=function(t){return 0*t},_.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},_.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyB.c_position,i=this.m_bodyB.c_velocity,o=e.c,s=e.a,l=i.v,m=i.w,p=u.neo(s),d=this.m_bodyB.getMass(),_=2*a.PI*this.m_frequencyHz,f=2*d*this.m_dampingRatio*_,y=d*(_*_),v=t.dt;n&&r.assert(f+v*y>a.EPSILON),this.m_gamma=v*(f+v*y),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=v*y*this.m_gamma,this.m_rB=u.mulVec2(p,h.sub(this.m_localAnchorB,this.m_localCenterB));var g=new c;g.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,g.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,g.ey.x=g.ex.y,g.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=g.getInverse(),this.m_C.set(o),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),m*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),l.addMul(this.m_invMassB,this.m_impulse),m+=this.m_invIB*h.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),i.v.set(l),i.w=m},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyB.c_velocity,i=h.clone(e.v),n=e.w,r=h.cross(n,this.m_rB);r.add(i),r.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),r.neg();var o=c.mulVec2(this.m_mass,r),s=h.clone(this.m_impulse);this.m_impulse.add(o);var a=t.dt*this.m_maxForce;this.m_impulse.clamp(a),o=h.sub(this.m_impulse,s),i.addMul(this.m_invMassB,o),n+=this.m_invIB*h.cross(this.m_rB,o),e.v.set(i),e.w=n},_.prototype.solvePositionConstraints=function(t){return!0}},7200:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=y;var r=i(2274),o=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=i(4470),l=i(6173),m=i(7515),p=i(3766),d=(i(5385),i(8850),i(5235),i(8601),i(5878)),_=i(2129);y.TYPE="prismatic-joint",d.TYPES[y.TYPE]=y,y._super=d,y.prototype=s(y._super.prototype);var f={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0};function y(t,e,i,n,r){if(!(this instanceof y))return new y(t,e,i,n,r);t=o(t,f),d.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=y.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||c.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||c.zero(),this.m_localXAxisA=r?e.getLocalVector(r):t.localAxisA||c.neo(1,0),this.m_localXAxisA.normalize(),this.m_localYAxisA=c.cross(1,this.m_localXAxisA),this.m_referenceAngle=h.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=u(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=0,this.m_axis=c.zero(),this.m_perp=c.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new m,this.m_motorMass}y.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}},y._deserialize=function(t,e,i){return t.bodyA=i(_,t.bodyA,e),t.bodyB=i(_,t.bodyB,e),t.localAxisA=c(t.localAxisA),new y(t)},y.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},y.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},y.prototype.getLocalAxisA=function(){return this.m_localXAxisA},y.prototype.getReferenceAngle=function(){return this.m_referenceAngle},y.prototype.getJointTranslation=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=c.sub(e,t),n=this.m_bodyA.getWorldVector(this.m_localXAxisA);return c.dot(i,n)},y.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,i=p.mulVec2(t.m_xf.q,c.sub(this.m_localAnchorA,t.m_sweep.localCenter)),n=p.mulVec2(e.m_xf.q,c.sub(this.m_localAnchorB,e.m_sweep.localCenter)),r=c.add(t.m_sweep.c,i),o=c.add(e.m_sweep.c,n),s=c.sub(o,r),a=p.mulVec2(t.m_xf.q,this.m_localXAxisA),h=t.m_linearVelocity,u=e.m_linearVelocity,l=t.m_angularVelocity,m=e.m_angularVelocity;return c.dot(s,c.cross(l,a))+c.dot(a,c.sub(c.addCross(u,m,n),c.addCross(h,l,i)))},y.prototype.isLimitEnabled=function(){return this.m_enableLimit},y.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},y.prototype.getLowerLimit=function(){return this.m_lowerTranslation},y.prototype.getUpperLimit=function(){return this.m_upperTranslation},y.prototype.setLimits=function(t,e){n&&r.assert(t<=e),t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},y.prototype.isMotorEnabled=function(){return this.m_enableMotor},y.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},y.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},y.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t},y.prototype.getMotorSpeed=function(){return this.m_motorSpeed},y.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},y.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},y.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},y.prototype.getReactionForce=function(t){return c.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)},y.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},y.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,u=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=p.neo(i),d=p.neo(s),_=p.mulVec2(m,c.sub(this.m_localAnchorA,this.m_localCenterA)),f=p.mulVec2(d,c.sub(this.m_localAnchorB,this.m_localCenterB)),y=c.zero();y.addCombine(1,o,1,f),y.subCombine(1,e,1,_);var v=this.m_invMassA,g=this.m_invMassB,b=this.m_invIA,x=this.m_invIB;this.m_axis=p.mulVec2(m,this.m_localXAxisA),this.m_a1=c.cross(c.add(y,_),this.m_axis),this.m_a2=c.cross(f,this.m_axis),this.m_motorMass=v+g+b*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_perp=p.mulVec2(m,this.m_localYAxisA),this.m_s1=c.cross(c.add(y,_),this.m_perp),this.m_s2=c.cross(f,this.m_perp),c.cross(_,this.m_perp);var A=v+g+b*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,w=b*this.m_s1+x*this.m_s2,B=b*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,T=b+x;0==T&&(T=1);var E=b*this.m_a1+x*this.m_a2,C=v+g+b*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2;if(this.m_K.ex.set(A,w,B),this.m_K.ey.set(w,T,E),this.m_K.ez.set(B,E,C),this.m_enableLimit){var S=c.dot(this.m_axis,y);h.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.linearSlop?this.m_limitState=3:S<=this.m_lowerTranslation?1!=this.m_limitState&&(this.m_limitState=1,this.m_impulse.z=0):S>=this.m_upperTranslation?2!=this.m_limitState&&(this.m_limitState=2,this.m_impulse.z=0):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var I=c.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),M=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,P=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.subMul(v,I),r-=b*M,u.addMul(g,I),l+=x*P}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(u),this.m_bodyB.c_velocity.w=l},y.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,a=this.m_invIA,l=this.m_invIB;if(this.m_enableMotor&&3!=this.m_limitState){var m=c.dot(this.m_axis,c.sub(n,e))+this.m_a2*r-this.m_a1*i,p=this.m_motorMass*(this.m_motorSpeed-m),d=this.m_motorImpulse,_=t.dt*this.m_maxMotorForce;this.m_motorImpulse=h.clamp(this.m_motorImpulse+p,-_,_),p=this.m_motorImpulse-d;var f=c.mul(p,this.m_axis),y=p*this.m_a1,v=p*this.m_a2;e.subMul(o,f),i-=a*y,n.addMul(s,f),r+=l*v}var g=c.zero();if(g.x+=c.dot(this.m_perp,n)+this.m_s2*r,g.x-=c.dot(this.m_perp,e)+this.m_s1*i,g.y=r-i,this.m_enableLimit&&0!=this.m_limitState){var b=0;b+=c.dot(this.m_axis,n)+this.m_a2*r,b-=c.dot(this.m_axis,e)+this.m_a1*i,m=u(g.x,g.y,b);var x=u(this.m_impulse),A=this.m_K.solve33(u.neg(m));this.m_impulse.add(A),1==this.m_limitState?this.m_impulse.z=h.max(this.m_impulse.z,0):2==this.m_limitState&&(this.m_impulse.z=h.min(this.m_impulse.z,0));var w=c.combine(-1,g,-(this.m_impulse.z-x.z),c.neo(this.m_K.ez.x,this.m_K.ez.y)),B=c.add(this.m_K.solve22(w),c.neo(x.x,x.y));this.m_impulse.x=B.x,this.m_impulse.y=B.y,A=u.sub(this.m_impulse,x),f=c.combine(A.x,this.m_perp,A.z,this.m_axis),y=A.x*this.m_s1+A.y+A.z*this.m_a1,v=A.x*this.m_s2+A.y+A.z*this.m_a2,e.subMul(o,f),i-=a*y,n.addMul(s,f),r+=l*v}else A=this.m_K.solve22(c.neg(g)),this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,f=c.mul(A.x,this.m_perp),y=A.x*this.m_s1+A.y,v=A.x*this.m_s2+A.y,e.subMul(o,f),i-=a*y,n.addMul(s,f),r+=l*v;this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},y.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,o=p.neo(i),s=p.neo(r),d=this.m_invMassA,_=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=p.mulVec2(o,c.sub(this.m_localAnchorA,this.m_localCenterA)),g=p.mulVec2(s,c.sub(this.m_localAnchorB,this.m_localCenterB)),b=c.sub(c.add(n,g),c.add(e,v)),x=p.mulVec2(o,this.m_localXAxisA),A=c.cross(c.add(b,v),x),w=c.cross(g,x),B=p.mulVec2(o,this.m_localYAxisA),T=c.cross(c.add(b,v),B),E=c.cross(g,B),C=u(),S=c.zero();S.x=c.dot(B,b),S.y=r-i-this.m_referenceAngle;var I=h.abs(S.x),M=h.abs(S.y),P=a.linearSlop,D=a.maxLinearCorrection,O=!1,L=0;if(this.m_enableLimit){var N=c.dot(x,b);h.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P?(L=h.clamp(N,-D,D),I=h.max(I,h.abs(N)),O=!0):N<=this.m_lowerTranslation?(L=h.clamp(N-this.m_lowerTranslation+P,-D,0),I=h.max(I,this.m_lowerTranslation-N),O=!0):N>=this.m_upperTranslation&&(L=h.clamp(N-this.m_upperTranslation-P,0,D),I=h.max(I,N-this.m_upperTranslation),O=!0)}if(O){var V=d+_+f*T*T+y*E*E,R=f*T+y*E,F=f*T*A+y*E*w;0==(q=f+y)&&(q=1);var z=f*A+y*w,k=d+_+f*A*A+y*w*w;(U=new m).ex.set(V,R,F),U.ey.set(R,q,z),U.ez.set(F,z,k);var j=u();j.x=S.x,j.y=S.y,j.z=L,C=U.solve33(u.neg(j))}else{var q,U;V=d+_+f*T*T+y*E*E,R=f*T+y*E,0==(q=f+y)&&(q=1),(U=new l).ex.set(V,R),U.ey.set(R,q);var G=U.solve(c.neg(S));C.x=G.x,C.y=G.y,C.z=0}var Y=c.combine(C.x,B,C.z,x),W=C.x*T+C.y+C.z*A,$=C.x*E+C.y+C.z*w;return e.subMul(d,Y),i-=f*W,n.addMul(_,Y),r+=y*$,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=n,this.m_bodyB.c_position.a=r,I<=a.linearSlop&&M<=a.angularSlop}},9087:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=d;var r=i(2274),o=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=(i(4470),i(6173),i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);d.TYPE="pulley-joint",d.MIN_PULLEY_LENGTH=2,l.TYPES[d.TYPE]=d,d._super=l,d.prototype=s(d._super.prototype);var p={collideConnected:!0};function d(t,e,i,s,a,u,m,_){if(!(this instanceof d))return new d(t,e,i,s,a,u,m,_);t=o(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,this.m_groundAnchorA=s||t.groundAnchorA||c.neo(-1,1),this.m_groundAnchorB=a||t.groundAnchorB||c.neo(1,1),this.m_localAnchorA=u?e.getLocalPoint(u):t.localAnchorA||c.neo(-1,0),this.m_localAnchorB=m?i.getLocalPoint(m):t.localAnchorB||c.neo(1,0),this.m_lengthA=h.isFinite(t.lengthA)?t.lengthA:c.distance(u,s),this.m_lengthB=h.isFinite(t.lengthB)?t.lengthB:c.distance(m,a),this.m_ratio=h.isFinite(_)?_:t.ratio,n&&r.assert(_>h.EPSILON),this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}d.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}},d._deserialize=function(t,e,i){return t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),new d(t)},d.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},d.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},d.prototype.getLengthA=function(){return this.m_lengthA},d.prototype.getLengthB=function(){return this.m_lengthB},d.prototype.getRatio=function(){return this.m_ratio},d.prototype.getCurrentLengthA=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return c.distance(t,e)},d.prototype.getCurrentLengthB=function(){var t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return c.distance(t,e)},d.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)},d.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t){return c.mul(this.m_impulse,this.m_uB).mul(t)},d.prototype.getReactionTorque=function(t){return 0},d.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,h=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=u.neo(i),p=u.neo(s);this.m_rA=u.mulVec2(m,c.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mulVec2(p,c.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=c.sub(c.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=c.sub(c.add(o,this.m_rB),this.m_groundAnchorB);var d=this.m_uA.length(),_=this.m_uB.length();d>10*a.linearSlop?this.m_uA.mul(1/d):this.m_uA.setZero(),_>10*a.linearSlop?this.m_uB.mul(1/_):this.m_uB.setZero();var f=c.cross(this.m_rA,this.m_uA),y=c.cross(this.m_rB,this.m_uB),v=this.m_invMassA+this.m_invIA*f*f,g=this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=v+this.m_ratio*this.m_ratio*g,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;var b=c.mul(-this.m_impulse,this.m_uA),x=c.mul(-this.m_ratio*this.m_impulse,this.m_uB);n.addMul(this.m_invMassA,b),r+=this.m_invIA*c.cross(this.m_rA,b),h.addMul(this.m_invMassB,x),l+=this.m_invIB*c.cross(this.m_rB,x)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=h,this.m_bodyB.c_velocity.w=l},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=c.add(e,c.cross(i,this.m_rA)),s=c.add(n,c.cross(r,this.m_rB)),a=-c.dot(this.m_uA,o)-this.m_ratio*c.dot(this.m_uB,s),h=-this.m_mass*a;this.m_impulse+=h;var u=c.mul(-h,this.m_uA),l=c.mul(-this.m_ratio*h,this.m_uB);e.addMul(this.m_invMassA,u),i+=this.m_invIA*c.cross(this.m_rA,u),n.addMul(this.m_invMassB,l),r+=this.m_invIB*c.cross(this.m_rB,l),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},d.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,o=u.neo(i),s=u.neo(r),l=u.mulVec2(o,c.sub(this.m_localAnchorA,this.m_localCenterA)),m=u.mulVec2(s,c.sub(this.m_localAnchorB,this.m_localCenterB)),p=c.sub(c.add(e,this.m_rA),this.m_groundAnchorA),d=c.sub(c.add(n,this.m_rB),this.m_groundAnchorB),_=p.length(),f=d.length();_>10*a.linearSlop?p.mul(1/_):p.setZero(),f>10*a.linearSlop?d.mul(1/f):d.setZero();var y=c.cross(l,p),v=c.cross(m,d),g=this.m_invMassA+this.m_invIA*y*y,b=this.m_invMassB+this.m_invIB*v*v,x=g+this.m_ratio*this.m_ratio*b;x>0&&(x=1/x);var A=this.m_constant-_-this.m_ratio*f,w=h.abs(A),B=-x*A,T=c.mul(-B,p),E=c.mul(-this.m_ratio*B,d);return e.addMul(this.m_invMassA,T),i+=this.m_invIA*c.cross(l,T),n.addMul(this.m_invMassB,E),r+=this.m_invIB*c.cross(m,E),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=n,this.m_bodyB.c_position.a=r,w<a.linearSlop}},8087:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=y;var r=i(2274),o=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=i(4470),l=i(6173),m=i(7515),p=i(3766),d=(i(5385),i(8850),i(5235),i(8601),i(5878)),_=i(2129);y.TYPE="revolute-joint",d.TYPES[y.TYPE]=y,y._super=d,y.prototype=s(y._super.prototype);var f={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1};function y(t,e,i,n){if(!(this instanceof y))return new y(t,e,i,n);t=o(t,f),d.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=y.TYPE,this.m_localAnchorA=c.clone(n?e.getLocalPoint(n):t.localAnchorA||c.zero()),this.m_localAnchorB=c.clone(n?i.getLocalPoint(n):t.localAnchorB||c.zero()),this.m_referenceAngle=h.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=u(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new m,this.m_motorMass,this.m_limitState=0}y.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},y._deserialize=function(t,e,i){return t.bodyA=i(_,t.bodyA,e),t.bodyB=i(_,t.bodyB,e),new y(t)},y.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB)},y.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},y.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},y.prototype.getReferenceAngle=function(){return this.m_referenceAngle},y.prototype.getJointAngle=function(){var t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},y.prototype.getJointSpeed=function(){var t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},y.prototype.isMotorEnabled=function(){return this.m_enableMotor},y.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},y.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},y.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},y.prototype.getMotorSpeed=function(){return this.m_motorSpeed},y.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},y.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},y.prototype.isLimitEnabled=function(){return this.m_enableLimit},y.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},y.prototype.getLowerLimit=function(){return this.m_lowerAngle},y.prototype.getUpperLimit=function(){return this.m_upperAngle},y.prototype.setLimits=function(t,e){n&&r.assert(t<=e),t==this.m_lowerAngle&&e==this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},y.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},y.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},y.prototype.getReactionForce=function(t){return c.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},y.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},y.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,u=p.neo(e),l=p.neo(r);this.m_rA=p.mulVec2(u,c.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=p.mulVec2(l,c.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,d=this.m_invMassB,_=this.m_invIA,f=this.m_invIB,y=_+f===0;if(this.m_mass.ex.x=m+d+this.m_rA.y*this.m_rA.y*_+this.m_rB.y*this.m_rB.y*f,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*_-this.m_rB.y*this.m_rB.x*f,this.m_mass.ez.x=-this.m_rA.y*_-this.m_rB.y*f,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=m+d+this.m_rA.x*this.m_rA.x*_+this.m_rB.x*this.m_rB.x*f,this.m_mass.ez.y=this.m_rA.x*_+this.m_rB.x*f,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=_+f,this.m_motorMass=_+f,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(0==this.m_enableMotor||y)&&(this.m_motorImpulse=0),this.m_enableLimit&&0==y){var v=r-e-this.m_referenceAngle;h.abs(this.m_upperAngle-this.m_lowerAngle)<2*a.angularSlop?this.m_limitState=3:v<=this.m_lowerAngle?(1!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=1):v>=this.m_upperAngle?(2!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=2):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var g=c.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(m,g),n-=_*(c.cross(this.m_rA,g)+this.m_motorImpulse+this.m_impulse.z),o.addMul(d,g),s+=f*(c.cross(this.m_rB,g)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},y.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,a=this.m_invIA,l=this.m_invIB,m=a+l===0;if(this.m_enableMotor&&3!=this.m_limitState&&0==m){var p=r-i-this.m_motorSpeed,d=-this.m_motorMass*p,_=this.m_motorImpulse,f=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=h.clamp(this.m_motorImpulse+d,-f,f),i-=a*(d=this.m_motorImpulse-_),r+=l*d}if(this.m_enableLimit&&0!=this.m_limitState&&0==m){var y=c.zero();y.addCombine(1,n,1,c.cross(r,this.m_rB)),y.subCombine(1,e,1,c.cross(i,this.m_rA));var v=r-i;if(p=u(y.x,y.y,v),d=u.neg(this.m_mass.solve33(p)),3==this.m_limitState)this.m_impulse.add(d);else if(1==this.m_limitState)if(this.m_impulse.z+d.z<0){var g=c.combine(-1,y,this.m_impulse.z,c.neo(this.m_mass.ez.x,this.m_mass.ez.y)),b=this.m_mass.solve22(g);d.x=b.x,d.y=b.y,d.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else this.m_impulse.add(d);else 2==this.m_limitState&&(this.m_impulse.z+d.z>0?(g=c.combine(-1,y,this.m_impulse.z,c.neo(this.m_mass.ez.x,this.m_mass.ez.y)),b=this.m_mass.solve22(g),d.x=b.x,d.y=b.y,d.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0):this.m_impulse.add(d));var x=c.neo(d.x,d.y);e.subMul(o,x),i-=a*(c.cross(this.m_rA,x)+d.z),n.addMul(s,x),r+=l*(c.cross(this.m_rB,x)+d.z)}else(p=c.zero()).addCombine(1,n,1,c.cross(r,this.m_rB)),p.subCombine(1,e,1,c.cross(i,this.m_rA)),d=this.m_mass.solve22(c.neg(p)),this.m_impulse.x+=d.x,this.m_impulse.y+=d.y,e.subMul(o,d),i-=a*c.cross(this.m_rA,d),n.addMul(s,d),r+=l*c.cross(this.m_rB,d);this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},y.prototype.solvePositionConstraints=function(t){var e,i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,r=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,s=p.neo(n),u=p.neo(o),m=0,d=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&0!=this.m_limitState&&0==d){var _=o-n-this.m_referenceAngle,f=0;if(3==this.m_limitState){var y=h.clamp(_-this.m_lowerAngle,-a.maxAngularCorrection,a.maxAngularCorrection);f=-this.m_motorMass*y,m=h.abs(y)}else 1==this.m_limitState?(m=-(y=_-this.m_lowerAngle),y=h.clamp(y+a.angularSlop,-a.maxAngularCorrection,0),f=-this.m_motorMass*y):2==this.m_limitState&&(m=y=_-this.m_upperAngle,y=h.clamp(y-a.angularSlop,0,a.maxAngularCorrection),f=-this.m_motorMass*y);n-=this.m_invIA*f,o+=this.m_invIB*f}s.set(n),u.set(o);var v=p.mulVec2(s,c.sub(this.m_localAnchorA,this.m_localCenterA)),g=p.mulVec2(u,c.sub(this.m_localAnchorB,this.m_localCenterB));(y=c.zero()).addCombine(1,r,1,g),y.subCombine(1,i,1,v),e=y.length();var b=this.m_invMassA,x=this.m_invMassB,A=this.m_invIA,w=this.m_invIB,B=new l;B.ex.x=b+x+A*v.y*v.y+w*g.y*g.y,B.ex.y=-A*v.x*v.y-w*g.x*g.y,B.ey.x=B.ex.y,B.ey.y=b+x+A*v.x*v.x+w*g.x*g.x;var T=c.neg(B.solve(y));return i.subMul(b,T),n-=A*c.cross(v,T),r.addMul(x,T),o+=w*c.cross(g,T),this.m_bodyA.c_position.c.set(i),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.set(r),this.m_bodyB.c_position.a=o,e<=a.linearSlop&&m<=a.angularSlop}},1347:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=m;var n=i(4896),r=i(4175),o=i(1099),s=i(5387),a=i(6306),h=(i(4470),i(6173),i(7515),i(3766)),c=(i(5385),i(8850),i(5235),i(8601),i(5878)),u=i(2129);m.TYPE="rope-joint",c.TYPES[m.TYPE]=m,m._super=c,m.prototype=r(m._super.prototype);var l={maxLength:0};function m(t,e,i,r){if(!(this instanceof m))return new m(t,e,i,r);t=n(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=m.TYPE,this.m_localAnchorA=r?e.getLocalPoint(r):t.localAnchorA||a.neo(-1,0),this.m_localAnchorB=r?i.getLocalPoint(r):t.localAnchorB||a.neo(1,0),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=0,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}m.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}},m._deserialize=function(t,e,i){return t.bodyA=i(u,t.bodyA,e),t.bodyB=i(u,t.bodyB,e),new m(t)},m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.setMaxLength=function(t){this.m_maxLength=t},m.prototype.getMaxLength=function(){return this.m_maxLength},m.prototype.getLimitState=function(){return this.m_state},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.mul(this.m_impulse,this.m_u).mul(t)},m.prototype.getReactionTorque=function(t){return 0},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,u=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=h.neo(i),p=h.neo(c);this.m_rA=h.mulSub(m,this.m_localAnchorA,this.m_localCenterA),this.m_rB=h.mulSub(p,this.m_localAnchorB,this.m_localCenterB),this.m_u=a.zero(),this.m_u.addCombine(1,s,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();var d=this.m_length-this.m_maxLength;if(this.m_state=d>0?2:0,!(this.m_length>o.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);var _=a.cross(this.m_rA,this.m_u),f=a.cross(this.m_rB,this.m_u),y=this.m_invMassA+this.m_invIA*_*_+this.m_invMassB+this.m_invIB*f*f;if(this.m_mass=0!=y?1/y:0,t.warmStarting){this.m_impulse*=t.dtRatio;var v=a.mul(this.m_impulse,this.m_u);n.subMul(this.m_invMassA,v),r-=this.m_invIA*a.cross(this.m_rA,v),u.addMul(this.m_invMassB,v),l+=this.m_invIB*a.cross(this.m_rB,v)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(u),this.m_bodyB.c_velocity.w=l},m.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=a.addCross(e,i,this.m_rA),h=a.addCross(n,r,this.m_rB),c=this.m_length-this.m_maxLength,u=a.dot(this.m_u,a.sub(h,o));c<0&&(u+=t.inv_dt*c);var l=-this.m_mass*u,m=this.m_impulse;this.m_impulse=s.min(0,this.m_impulse+l),l=this.m_impulse-m;var p=a.mul(l,this.m_u);e.subMul(this.m_invMassA,p),i-=this.m_invIA*a.cross(this.m_rA,p),n.addMul(this.m_invMassB,p),r+=this.m_invIB*a.cross(this.m_rB,p),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},m.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,c=h.neo(i),u=h.neo(r),l=h.mulSub(c,this.m_localAnchorA,this.m_localCenterA),m=h.mulSub(u,this.m_localAnchorB,this.m_localCenterB),p=a.zero();p.addCombine(1,n,1,m),p.subCombine(1,e,1,l);var d=p.normalize(),_=d-this.m_maxLength;_=s.clamp(_,0,o.maxLinearCorrection);var f=-this.m_mass*_,y=a.mul(f,p);return e.subMul(this.m_invMassA,y),i-=this.m_invIA*a.cross(l,y),n.addMul(this.m_invMassB,y),r+=this.m_invIB*a.cross(m,y),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=r,d-this.m_maxLength<o.linearSlop}},1415:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=d;var n=i(4896),r=i(4175),o=i(1099),s=i(5387),a=i(6306),h=i(4470),c=(i(6173),i(7515)),u=i(3766),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);d.TYPE="weld-joint",l.TYPES[d.TYPE]=d,d._super=l,d.prototype=r(d._super.prototype);var p={frequencyHz:0,dampingRatio:0};function d(t,e,i,r){if(!(this instanceof d))return new d(t,e,i,r);t=n(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,this.m_localAnchorA=r?e.getLocalPoint(r):t.localAnchorA||a.zero(),this.m_localAnchorB=r?i.getLocalPoint(r):t.localAnchorB||a.zero(),this.m_referenceAngle=s.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=h(),this.m_bias=0,this.m_gamma=0,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new c}d.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},d._deserialize=function(t,e,i){return t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),new d(t)},d.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},d.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},d.prototype.getReferenceAngle=function(){return this.m_referenceAngle},d.prototype.setFrequency=function(t){this.m_frequencyHz=t},d.prototype.getFrequency=function(){return this.m_frequencyHz},d.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},d.prototype.getDampingRatio=function(){return this.m_dampingRatio},d.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t){return a.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},d.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},d.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,l=u.neo(e),m=u.neo(r);this.m_rA=u.mulVec2(l,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mulVec2(m,a.sub(this.m_localAnchorB,this.m_localCenterB));var p=this.m_invMassA,d=this.m_invMassB,_=this.m_invIA,f=this.m_invIB,y=new c;if(y.ex.x=p+d+this.m_rA.y*this.m_rA.y*_+this.m_rB.y*this.m_rB.y*f,y.ey.x=-this.m_rA.y*this.m_rA.x*_-this.m_rB.y*this.m_rB.x*f,y.ez.x=-this.m_rA.y*_-this.m_rB.y*f,y.ex.y=y.ey.x,y.ey.y=p+d+this.m_rA.x*this.m_rA.x*_+this.m_rB.x*this.m_rB.x*f,y.ez.y=this.m_rA.x*_+this.m_rB.x*f,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=_+f,this.m_frequencyHz>0){y.getInverse22(this.m_mass);var v=_+f,g=v>0?1/v:0,b=r-e-this.m_referenceAngle,x=2*s.PI*this.m_frequencyHz,A=2*g*this.m_dampingRatio*x,w=g*x*x,B=t.dt;this.m_gamma=B*(A+B*w),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=b*B*w*this.m_gamma,v+=this.m_gamma,this.m_mass.ez.z=0!=v?1/v:0}else 0==y.ez.z?(y.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(y.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);var T=a.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(p,T),n-=_*(a.cross(this.m_rA,T)+this.m_impulse.z),o.addMul(d,T),h+=f*(a.cross(this.m_rB,T)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=h},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,u=this.m_invIA,l=this.m_invIB;if(this.m_frequencyHz>0){var m=r-i,p=-this.m_mass.ez.z*(m+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=p,i-=u*p,r+=l*p,(f=a.zero()).addCombine(1,n,1,a.cross(r,this.m_rB)),f.subCombine(1,e,1,a.cross(i,this.m_rA));var d=a.neg(c.mulVec2(this.m_mass,f));this.m_impulse.x+=d.x,this.m_impulse.y+=d.y;var _=a.clone(d);e.subMul(o,_),i-=u*a.cross(this.m_rA,_),n.addMul(s,_),r+=l*a.cross(this.m_rB,_)}else{var f;(f=a.zero()).addCombine(1,n,1,a.cross(r,this.m_rB)),f.subCombine(1,e,1,a.cross(i,this.m_rA)),m=r-i;var y=h(f.x,f.y,m),v=h.neg(c.mulVec3(this.m_mass,y));this.m_impulse.add(v),_=a.neo(v.x,v.y),e.subMul(o,_),i-=u*(a.cross(this.m_rA,_)+v.z),n.addMul(s,_),r+=l*(a.cross(this.m_rB,_)+v.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},d.prototype.solvePositionConstraints=function(t){var e,i,n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,l=this.m_bodyB.c_position.c,m=this.m_bodyB.c_position.a,p=u.neo(r),d=u.neo(m),_=this.m_invMassA,f=this.m_invMassB,y=this.m_invIA,v=this.m_invIB,g=u.mulVec2(p,a.sub(this.m_localAnchorA,this.m_localCenterA)),b=u.mulVec2(d,a.sub(this.m_localAnchorB,this.m_localCenterB)),x=new c;if(x.ex.x=_+f+g.y*g.y*y+b.y*b.y*v,x.ey.x=-g.y*g.x*y-b.y*b.x*v,x.ez.x=-g.y*y-b.y*v,x.ex.y=x.ey.x,x.ey.y=_+f+g.x*g.x*y+b.x*b.x*v,x.ez.y=g.x*y+b.x*v,x.ex.z=x.ez.x,x.ey.z=x.ez.y,x.ez.z=y+v,this.m_frequencyHz>0){(w=a.zero()).addCombine(1,l,1,b),w.subCombine(1,n,1,g),e=w.length(),i=0;var A=a.neg(x.solve22(w));n.subMul(_,A),r-=y*a.cross(g,A),l.addMul(f,A),m+=v*a.cross(b,A)}else{var w;(w=a.zero()).addCombine(1,l,1,b),w.subCombine(1,n,1,g);var B=m-r-this.m_referenceAngle;e=w.length(),i=s.abs(B);var T=h(w.x,w.y,B),E=h();if(x.ez.z>0)E=h.neg(x.solve33(T));else{var C=a.neg(x.solve22(w));E.set(C.x,C.y,0)}A=a.neo(E.x,E.y),n.subMul(_,A),r-=y*(a.cross(g,A)+E.z),l.addMul(f,A),m+=v*(a.cross(b,A)+E.z)}return this.m_bodyA.c_position.c=n,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=l,this.m_bodyB.c_position.a=m,e<=o.linearSlop&&i<=o.angularSlop}},2707:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=m;var n=i(4896),r=i(4175),o=i(1099),s=i(5387),a=i(6306),h=(i(4470),i(6173),i(7515),i(3766)),c=(i(5385),i(8850),i(5235),i(8601),i(5878)),u=i(2129);m.TYPE="wheel-joint",c.TYPES[m.TYPE]=m,m._super=c,m.prototype=r(m._super.prototype);var l={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7};function m(t,e,i,r,o){if(!(this instanceof m))return new m(t,e,i,r,o);t=n(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=m.TYPE,this.m_localAnchorA=a.clone(r?e.getLocalPoint(r):t.localAnchorA||a.zero()),this.m_localAnchorB=a.clone(r?i.getLocalPoint(r):t.localAnchorB||a.zero()),this.m_localXAxisA=a.clone(o?e.getLocalVector(o):t.localAxisA||t.localAxis||a.neo(1,0)),this.m_localYAxisA=a.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_ax=a.zero(),this.m_ay=a.zero(),this.m_sAx,this.m_sBx,this.m_sAy,this.m_sBy}m.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}},m._deserialize=function(t,e,i){return t.bodyA=i(u,t.bodyA,e),t.bodyB=i(u,t.bodyB,e),new m(t)},m.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.localAxisA&&(this.m_localXAxisA.set(t.localAxisA),this.m_localYAxisA.set(a.cross(1,t.localAxisA)))},m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.getLocalAxisA=function(){return this.m_localXAxisA},m.prototype.getJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.getWorldPoint(this.m_localAnchorA),n=e.getWorldPoint(this.m_localAnchorB),r=a.sub(n,i),o=t.getWorldVector(this.m_localXAxisA);return a.dot(r,o)},m.prototype.getJointSpeed=function(){var t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},m.prototype.isMotorEnabled=function(){return this.m_enableMotor},m.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},m.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},m.prototype.getMotorSpeed=function(){return this.m_motorSpeed},m.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},m.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},m.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},m.prototype.setSpringFrequencyHz=function(t){this.m_frequencyHz=t},m.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},m.prototype.setSpringDampingRatio=function(t){this.m_dampingRatio=t},m.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)},m.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,i=this.m_invMassB,n=this.m_invIA,r=this.m_invIB,o=this.m_bodyA.c_position.c,c=this.m_bodyA.c_position.a,u=this.m_bodyA.c_velocity.v,l=this.m_bodyA.c_velocity.w,m=this.m_bodyB.c_position.c,p=this.m_bodyB.c_position.a,d=this.m_bodyB.c_velocity.v,_=this.m_bodyB.c_velocity.w,f=h.neo(c),y=h.neo(p),v=h.mulVec2(f,a.sub(this.m_localAnchorA,this.m_localCenterA)),g=h.mulVec2(y,a.sub(this.m_localAnchorB,this.m_localCenterB));if((w=a.zero()).addCombine(1,m,1,g),w.subCombine(1,o,1,v),this.m_ay=h.mulVec2(f,this.m_localYAxisA),this.m_sAy=a.cross(a.add(w,v),this.m_ay),this.m_sBy=a.cross(g,this.m_ay),this.m_mass=e+i+n*this.m_sAy*this.m_sAy+r*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=h.mulVec2(f,this.m_localXAxisA),this.m_sAx=a.cross(a.add(w,v),this.m_ax),this.m_sBx=a.cross(g,this.m_ax);var b=e+i+n*this.m_sAx*this.m_sAx+r*this.m_sBx*this.m_sBx;if(b>0){this.m_springMass=1/b;var x=a.dot(w,this.m_ax),A=2*s.PI*this.m_frequencyHz,w=2*this.m_springMass*this.m_dampingRatio*A,B=this.m_springMass*A*A,T=t.dt;this.m_gamma=T*(w+T*B),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=x*T*B*this.m_gamma,this.m_springMass=b+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=n+r,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var E=a.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),C=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,S=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;u.subMul(this.m_invMassA,E),l-=this.m_invIA*C,d.addMul(this.m_invMassB,E),_+=this.m_invIB*S}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(u),this.m_bodyA.c_velocity.w=l,this.m_bodyB.c_velocity.v.set(d),this.m_bodyB.c_velocity.w=_},m.prototype.solveVelocityConstraints=function(t){var e=this.m_invMassA,i=this.m_invMassB,n=this.m_invIA,r=this.m_invIB,o=this.m_bodyA.c_velocity.v,h=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,l=a.dot(this.m_ax,c)-a.dot(this.m_ax,o)+this.m_sBx*u-this.m_sAx*h,m=-this.m_springMass*(l+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=m;var p=a.mul(m,this.m_ax),d=m*this.m_sAx,_=m*this.m_sBx;o.subMul(e,p),h-=n*d,c.addMul(i,p),l=(u+=r*_)-h-this.m_motorSpeed,m=-this.m_motorMass*l;var f=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.clamp(this.m_motorImpulse+m,-y,y),h-=n*(m=this.m_motorImpulse-f),u+=r*m,l=a.dot(this.m_ay,c)-a.dot(this.m_ay,o)+this.m_sBy*u-this.m_sAy*h,m=-this.m_mass*l,this.m_impulse+=m,p=a.mul(m,this.m_ay),d=m*this.m_sAy,_=m*this.m_sBy,o.subMul(e,p),h-=n*d,c.addMul(i,p),u+=r*_,this.m_bodyA.c_velocity.v.set(o),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u},m.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,c=h.neo(i),u=h.neo(r),l=h.mulVec2(c,a.sub(this.m_localAnchorA,this.m_localCenterA)),m=h.mulVec2(u,a.sub(this.m_localAnchorB,this.m_localCenterB)),p=a.zero();p.addCombine(1,n,1,m),p.subCombine(1,e,1,l);var d,_=h.mulVec2(c,this.m_localYAxisA),f=a.cross(a.add(p,l),_),y=a.cross(m,_),v=a.dot(p,_),g=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;d=0!=g?-v/g:0;var b=a.mul(d,_),x=d*f,A=d*y;return e.subMul(this.m_invMassA,b),i-=this.m_invIA*x,n.addMul(this.m_invMassB,b),r+=this.m_invIB*A,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=r,s.abs(v)<=o.linearSlop}},2134:(t,e,i)=>{var n=i(6972),r=i(2129),o=i(5878),s=(i(2322),0);function a(t){var e=(t=t||{}).stringify||JSON.stringify,i=t.parse||JSON.parse,a=t.rootClass||n,h=t.preSerialize||function(t){return t},c=t.postSerialize||function(t,e){return t},u=t.preDeserialize||function(t){return t},l=t.postDeserialize||function(t,e){return t},m={World:n,Body:r,Joint:o};this.toJson=function(t){var i=[],n=[t],r={};function o(t,e){if(t.__sid=t.__sid||++s,!r[t.__sid]){n.push(t);var o={refIndex:i.length+n.length,refType:e};r[t.__sid]=o}return r[t.__sid]}function a(t){var e=(t=h(t))._serialize();return c(e,t)}for(;n.length;){var u=n.shift(),l=e(u,(function(t,e){if("object"!=typeof e||null===e)return e;if("function"!=typeof e._serialize)return e;if(e===u)return a(e);for(var i in m)if(e instanceof m[i])return o(e,i);return a(e)}),"  ");i.push(l)}return"["+i.join(",")+"]"},this.fromJson=function(t){var e=i(t),n={};function r(t,e,i){e=u(e);var n=t._deserialize(e,i,o);return l(n,e)}function o(t,i,o){if(!i.refIndex)return t&&t._deserialize&&r(t,i,o);t=m[i.refType]||t;var s=i.refIndex;if(!n[s]){var a=r(t,e[s],o);n[s]=a}return n[s]}return a._deserialize(e[0],null,o)}}t.exports=a;var h=new a;t.exports.toJson=h.toJson,t.exports.fromJson=h.fromJson},7639:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=o,i(2274);var n=i(4175),r=i(8901);function o(t,e,i,n){if(!(this instanceof o))return new o(t,e,i,n);o._super.call(this),this._setAsBox(t,e,i,n)}o._super=r,o.prototype=n(o._super.prototype),o.TYPE="polygon"},2642:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=l;var r=i(2274),o=i(4175),s=(i(4896),i(5387),i(8850)),a=(i(3766),i(6306)),h=(i(3406),i(1099)),c=i(2322),u=i(3581);function l(t,e){if(!(this instanceof l))return new l(t,e);l._super.call(this),this.m_type=l.TYPE,this.m_radius=h.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_isLoop=e,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}l._super=c,l.prototype=o(l._super.prototype),l.TYPE="chain",c.TYPES[l.TYPE]=l,l.prototype._serialize=function(){const t={type:this.m_type,vertices:this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex};return this.m_prevVertex&&(t.prevVertex=this.m_prevVertex),this.m_nextVertex&&(t.nextVertex=this.m_nextVertex),t},l._deserialize=function(t){var e=new l(t.vertices.map(a._deserialize),t.isLoop);return t.prevVertex&&e._setPrevVertex(t.prevVertex),t.nextVertex&&e._setNextVertex(t.nextVertex),e},l.prototype._createLoop=function(t){n&&r.assert(0==this.m_vertices.length&&0==this.m_count),n&&r.assert(t.length>=3);for(var e=1;e<t.length;++e){var i=t[e-1],o=t[e];n&&r.assert(a.distanceSquared(i,o)>h.linearSlopSquared)}for(this.m_vertices.length=0,this.m_count=t.length+1,e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_vertices[t.length]=t[0].clone(),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},l.prototype._createChain=function(t){n&&r.assert(0==this.m_vertices.length&&0==this.m_count),n&&r.assert(t.length>=2);for(var e=1;e<t.length;++e){var i=t[e-1],o=t[e];n&&r.assert(a.distanceSquared(i,o)>h.linearSlopSquared)}for(this.m_count=t.length,e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},l.prototype._setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},l.prototype._setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},l.prototype._clone=function(){var t=new l;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},l.prototype.getChildCount=function(){return this.m_count-1},l.prototype.getChildEdge=function(t,e){n&&r.assert(0<=e&&e<this.m_count-1),t.m_type=u.TYPE,t.m_radius=this.m_radius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},l.prototype.getVertex=function(t){return n&&r.assert(0<=t&&t<=this.m_count),t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},l.prototype.testPoint=function(t,e){return!1},l.prototype.rayCast=function(t,e,i,o){return n&&r.assert(0<=o&&o<this.m_count),new u(this.getVertex(o),this.getVertex(o+1)).rayCast(t,e,i,0)},l.prototype.computeAABB=function(t,e,i){n&&r.assert(0<=i&&i<this.m_count);var o=s.mulVec2(e,this.getVertex(i)),a=s.mulVec2(e,this.getVertex(i+1));t.combinePoints(o,a)},l.prototype.computeMass=function(t,e){t.mass=0,t.center=a.neo(),t.I=0},l.prototype.computeDistanceProxy=function(t,e){n&&r.assert(0<=e&&e<this.m_count),t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius}},3335:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=u;var r=i(2274),o=i(4175),s=(i(4896),i(5387)),a=(i(8850),i(3766)),h=i(6306),c=(i(3406),i(1099),i(2322));function u(t,e){if(!(this instanceof u))return new u(t,e);u._super.call(this),this.m_type=u.TYPE,this.m_p=h.zero(),this.m_radius=1,"object"==typeof t&&h.isValid(t)?(this.m_p.set(t),"number"==typeof e&&(this.m_radius=e)):"number"==typeof t&&(this.m_radius=t)}u._super=c,u.prototype=o(u._super.prototype),u.TYPE="circle",c.TYPES[u.TYPE]=u,u.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}},u._deserialize=function(t){return new u(t.p,t.radius)},u.prototype.getRadius=function(){return this.m_radius},u.prototype.getCenter=function(){return this.m_p},u.prototype.getVertex=function(t){return n&&r.assert(0==t),this.m_p},u.prototype.getVertexCount=function(t){return 1},u.prototype._clone=function(){var t=new u;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},u.prototype.getChildCount=function(){return 1},u.prototype.testPoint=function(t,e){var i=h.add(t.p,a.mulVec2(t.q,this.m_p)),n=h.sub(e,i);return h.dot(n,n)<=this.m_radius*this.m_radius},u.prototype.rayCast=function(t,e,i,n){var r=h.add(i.p,a.mulVec2(i.q,this.m_p)),o=h.sub(e.p1,r),c=h.dot(o,o)-this.m_radius*this.m_radius,u=h.sub(e.p2,e.p1),l=h.dot(o,u),m=h.dot(u,u),p=l*l-m*c;if(p<0||m<s.EPSILON)return!1;var d=-(l+s.sqrt(p));return 0<=d&&d<=e.maxFraction*m&&(d/=m,t.fraction=d,t.normal=h.add(o,h.mul(d,u)),t.normal.normalize(),!0)},u.prototype.computeAABB=function(t,e,i){var n=h.add(e.p,a.mulVec2(e.q,this.m_p));t.lowerBound.set(n.x-this.m_radius,n.y-this.m_radius),t.upperBound.set(n.x+this.m_radius,n.y+this.m_radius)},u.prototype.computeMass=function(t,e){t.mass=e*s.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+h.dot(this.m_p,this.m_p))},u.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius}},8871:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),o=(i(4175),i(5387),i(8850)),s=i(6306),a=(i(1099),i(2322),i(8730)),h=i(226),c=i(3335);function u(t,e,i,n,r){t.pointCount=0;var a=o.mulVec2(i,e.m_p),c=o.mulVec2(r,n.m_p),u=s.distanceSquared(c,a),l=e.m_radius+n.m_radius;u>l*l||(t.type=h.e_circles,t.localPoint.set(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(n.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex)}a.addType(c.TYPE,c.TYPE,(function(t,e,i,o,s,a,h){n&&r.assert(i.getType()==c.TYPE),n&&r.assert(a.getType()==c.TYPE),u(t,i.getShape(),e,a.getShape(),s)})),e.CollideCircles=u},9415:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),o=i(5387),s=i(8850),a=(i(3766),i(6306)),h=(i(3406),i(1099),i(226)),c=i(8730),u=(i(2322),i(3335)),l=i(8901);c.addType(l.TYPE,u.TYPE,(function(t,e,i,c,m,p,d){n&&r.assert(i.getType()==l.TYPE),n&&r.assert(p.getType()==u.TYPE),function(t,e,i,n,r){t.pointCount=0;for(var c=s.mulVec2(r,n.m_p),u=s.mulTVec2(i,c),l=0,m=-1/0,p=e.m_radius+n.m_radius,d=e.m_count,_=e.m_vertices,f=e.m_normals,y=0;y<d;++y){var v=a.dot(f[y],a.sub(u,_[y]));if(v>p)return;v>m&&(m=v,l=y)}var g=l,b=g+1<d?g+1:0,x=_[g],A=_[b];if(m<o.EPSILON)return t.pointCount=1,t.type=h.e_faceA,t.localNormal.set(f[l]),t.localPoint.setCombine(.5,x,.5,A),t.points[0].localPoint=n.m_p,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=h.e_vertex);var w=a.dot(a.sub(u,x),a.sub(A,x)),B=a.dot(a.sub(u,A),a.sub(x,A));if(w<=0){if(a.distanceSquared(u,x)>p*p)return;t.pointCount=1,t.type=h.e_faceA,t.localNormal.setCombine(1,u,-1,x),t.localNormal.normalize(),t.localPoint=x,t.points[0].localPoint.set(n.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}else if(B<=0){if(a.distanceSquared(u,A)>p*p)return;t.pointCount=1,t.type=h.e_faceA,t.localNormal.setCombine(1,u,-1,A),t.localNormal.normalize(),t.localPoint.set(A),t.points[0].localPoint.set(n.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}else{var T=a.mid(x,A);if((m=a.dot(u,f[g])-a.dot(T,f[g]))>p)return;t.pointCount=1,t.type=h.e_faceA,t.localNormal.set(f[g]),t.localPoint.set(T),t.points[0].localPoint.set(n.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}}(t,i.getShape(),e,p.getShape(),m)}))},1867:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),o=(i(4175),i(5387),i(8850)),s=i(6306),a=(i(3766),i(1099),i(2322),i(8730)),h=i(226),c=i(3581),u=i(2642),l=i(3335);function m(t,e,i,a,c){t.pointCount=0;var u=o.mulTVec2(i,o.mulVec2(c,a.m_p)),l=e.m_vertex1,m=e.m_vertex2,p=s.sub(m,l),d=s.dot(p,s.sub(m,u)),_=s.dot(p,s.sub(u,l)),f=e.m_radius+a.m_radius;if(_<=0){var y=s.clone(l),v=s.sub(u,y);if(s.dot(v,v)>f*f)return;if(e.m_hasVertex0){var g=e.m_vertex0,b=l,x=s.sub(b,g);if(s.dot(x,s.sub(b,u))>0)return}return t.type=h.e_circles,t.localNormal.setZero(),t.localPoint.set(y),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=h.e_vertex)}if(d<=0){if(y=s.clone(m),v=s.sub(u,y),s.dot(v,v)>f*f)return;if(e.m_hasVertex3){var A=e.m_vertex3,w=m,B=s.sub(A,w);if(s.dot(B,s.sub(u,w))>0)return}return t.type=h.e_circles,t.localNormal.setZero(),t.localPoint.set(y),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=h.e_vertex)}var T=s.dot(p,p);if(n&&r.assert(T>0),y=s.combine(d/T,l,_/T,m),v=s.sub(u,y),!(s.dot(v,v)>f*f)){var E=s.neo(-p.y,p.x);s.dot(E,s.sub(u,l))<0&&E.set(-E.x,-E.y),E.normalize(),t.type=h.e_faceA,t.localNormal=E,t.localPoint.set(l),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}}a.addType(c.TYPE,l.TYPE,(function(t,e,i,o,s,a,h){n&&r.assert(i.getType()==c.TYPE),n&&r.assert(a.getType()==l.TYPE),m(t,i.getShape(),e,a.getShape(),s)})),a.addType(u.TYPE,l.TYPE,(function(t,e,i,o,s,a,h){n&&r.assert(i.getType()==u.TYPE),n&&r.assert(a.getType()==l.TYPE);var p=i.getShape(),d=new c;p.getChildEdge(d,o),m(t,d,e,a.getShape(),s)}))},9221:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),o=(i(4175),i(5387)),s=i(8850),a=i(6306),h=i(3766),c=i(1099),u=(i(2322),i(8730)),l=i(226),m=i(3581),p=i(2642),d=i(8901);function _(){this.type,this.index,this.separation}u.addType(m.TYPE,d.TYPE,(function(t,e,i,o,s,a,h){n&&r.assert(i.getType()==m.TYPE),n&&r.assert(a.getType()==d.TYPE),b(t,i.getShape(),e,a.getShape(),s)})),u.addType(p.TYPE,d.TYPE,(function(t,e,i,o,s,a,h){n&&r.assert(i.getType()==p.TYPE),n&&r.assert(a.getType()==d.TYPE);var c=i.getShape(),u=new m;c.getChildEdge(u,o),b(t,u,e,a.getShape(),s)}));var f=new _,y=new _,v=new function(){this.vertices=[],this.normals=[],this.count=0},g=new function(){this.i1,this.i2,this.v1,this.v2,this.normal=a.zero(),this.sideNormal1=a.zero(),this.sideOffset1,this.sideNormal2=a.zero(),this.sideOffset2};function b(t,e,i,n,r){var u=s.mulTXf(i,r),m=s.mulVec2(u,n.m_centroid),p=e.m_vertex0,d=e.m_vertex1,_=e.m_vertex2,b=e.m_vertex3,x=e.m_hasVertex0,A=e.m_hasVertex3,w=a.sub(_,d);w.normalize();var B,T=a.neo(w.y,-w.x),E=a.dot(T,a.sub(m,d)),C=0,S=0,I=!1,M=!1;if(x){var P=a.sub(d,p);P.normalize();var D=a.neo(P.y,-P.x);I=a.cross(P,w)>=0,C=a.dot(D,m)-a.dot(D,p)}if(A){var O=a.sub(b,_);O.normalize();var L=a.neo(O.y,-O.x);M=a.cross(w,O)>0,S=a.dot(L,m)-a.dot(L,_)}var N=a.zero(),V=a.zero(),R=a.zero();x&&A?I&&M?(B=C>=0||E>=0||S>=0)?(N.set(T),V.set(D),R.set(L)):(N.setMul(-1,T),V.setMul(-1,T),R.setMul(-1,T)):I?(B=C>=0||E>=0&&S>=0)?(N.set(T),V.set(D),R.set(T)):(N.setMul(-1,T),V.setMul(-1,L),R.setMul(-1,T)):M?(B=S>=0||C>=0&&E>=0)?(N.set(T),V.set(T),R.set(L)):(N.setMul(-1,T),V.setMul(-1,T),R.setMul(-1,D)):(B=C>=0&&E>=0&&S>=0)?(N.set(T),V.set(T),R.set(T)):(N.setMul(-1,T),V.setMul(-1,L),R.setMul(-1,D)):x?I?(B=C>=0||E>=0)?(N.set(T),V.set(D),R.setMul(-1,T)):(N.setMul(-1,T),V.set(T),R.setMul(-1,T)):(B=C>=0&&E>=0)?(N.set(T),V.set(T),R.setMul(-1,T)):(N.setMul(-1,T),V.set(T),R.setMul(-1,D)):A?M?(B=E>=0||S>=0)?(N.set(T),V.setMul(-1,T),R.set(L)):(N.setMul(-1,T),V.setMul(-1,T),R.set(T)):(B=E>=0&&S>=0)?(N.set(T),V.setMul(-1,T),R.set(T)):(N.setMul(-1,T),V.setMul(-1,L),R.set(T)):(B=E>=0)?(N.set(T),V.setMul(-1,T),R.setMul(-1,T)):(N.setMul(-1,T),V.set(T),R.set(T)),v.count=n.m_count;for(var F=0;F<n.m_count;++F)v.vertices[F]=s.mulVec2(u,n.m_vertices[F]),v.normals[F]=h.mulVec2(u.q,n.m_normals[F]);var z=2*c.polygonRadius;for(t.pointCount=0,f.type=1,f.index=B?0:1,f.separation=1/0,F=0;F<v.count;++F)(j=a.dot(N,a.sub(v.vertices[F],d)))<f.separation&&(f.separation=j);if(-1!=f.type&&!(f.separation>z)){y.type=-1,y.index=-1,y.separation=-1/0;var k=a.neo(-N.y,N.x);for(F=0;F<v.count;++F){var j,q=a.neg(v.normals[F]),U=a.dot(q,a.sub(v.vertices[F],d)),G=a.dot(q,a.sub(v.vertices[F],_));if((j=o.min(U,G))>z){y.type=2,y.index=F,y.separation=j;break}if(a.dot(q,k)>=0){if(a.dot(a.sub(q,R),N)<-c.angularSlop)continue}else if(a.dot(a.sub(q,V),N)<-c.angularSlop)continue;j>y.separation&&(y.type=2,y.index=F,y.separation=j)}if(!(-1!=y.type&&y.separation>z)){var Y;Y=-1==y.type?f:y.separation>.98*f.separation+.001?y:f;var W=[new l.clipVertex,new l.clipVertex];if(1==Y.type){t.type=l.e_faceA;var $=0,H=a.dot(N,v.normals[0]);for(F=1;F<v.count;++F){var J=a.dot(N,v.normals[F]);J<H&&(H=J,$=F)}var X=$,K=X+1<v.count?X+1:0;W[0].v=v.vertices[X],W[0].id.cf.indexA=0,W[0].id.cf.indexB=X,W[0].id.cf.typeA=l.e_face,W[0].id.cf.typeB=l.e_vertex,W[1].v=v.vertices[K],W[1].id.cf.indexA=0,W[1].id.cf.indexB=K,W[1].id.cf.typeA=l.e_face,W[1].id.cf.typeB=l.e_vertex,B?(g.i1=0,g.i2=1,g.v1=d,g.v2=_,g.normal.set(T)):(g.i1=1,g.i2=0,g.v1=_,g.v2=d,g.normal.setMul(-1,T))}else t.type=l.e_faceB,W[0].v=d,W[0].id.cf.indexA=0,W[0].id.cf.indexB=Y.index,W[0].id.cf.typeA=l.e_vertex,W[0].id.cf.typeB=l.e_face,W[1].v=_,W[1].id.cf.indexA=0,W[1].id.cf.indexB=Y.index,W[1].id.cf.typeA=l.e_vertex,W[1].id.cf.typeB=l.e_face,g.i1=Y.index,g.i2=g.i1+1<v.count?g.i1+1:0,g.v1=v.vertices[g.i1],g.v2=v.vertices[g.i2],g.normal.set(v.normals[g.i1]);g.sideNormal1.set(g.normal.y,-g.normal.x),g.sideNormal2.setMul(-1,g.sideNormal1),g.sideOffset1=a.dot(g.sideNormal1,g.v1),g.sideOffset2=a.dot(g.sideNormal2,g.v2);var Z=[new l.clipVertex,new l.clipVertex],Q=[new l.clipVertex,new l.clipVertex];if(!(l.clipSegmentToLine(Z,W,g.sideNormal1,g.sideOffset1,g.i1)<c.maxManifoldPoints||l.clipSegmentToLine(Q,Z,g.sideNormal2,g.sideOffset2,g.i2)<c.maxManifoldPoints)){1==Y.type?(t.localNormal=a.clone(g.normal),t.localPoint=a.clone(g.v1)):(t.localNormal=a.clone(n.m_normals[g.i1]),t.localPoint=a.clone(n.m_vertices[g.i1]));var tt=0;for(F=0;F<c.maxManifoldPoints;++F)if(a.dot(g.normal,a.sub(Q[F].v,g.v1))<=z){var et=t.points[tt];1==Y.type?(et.localPoint=s.mulT(u,Q[F].v),et.id=Q[F].id):(et.localPoint=Q[F].v,et.id.cf.typeA=Q[F].id.cf.typeB,et.id.cf.typeB=Q[F].id.cf.typeA,et.id.cf.indexA=Q[F].id.cf.indexB,et.id.cf.indexB=Q[F].id.cf.indexA),++tt}t.pointCount=tt}}}}},6891:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),o=(i(5387),i(8850)),s=i(3766),a=i(6306),h=(i(3406),i(1099)),c=i(226),u=i(8730),l=(i(2322),i(8901));function m(t,e,i,n){for(var r=t.m_count,h=i.m_count,c=t.m_normals,u=t.m_vertices,l=i.m_vertices,p=o.mulTXf(n,e),d=0,_=-1/0,f=0;f<r;++f){for(var y=s.mulVec2(p.q,c[f]),v=o.mulVec2(p,u[f]),g=1/0,b=0;b<h;++b){var x=a.dot(y,l[b])-a.dot(y,v);x<g&&(g=x)}g>_&&(_=g,d=f)}m._maxSeparation=_,m._bestIndex=d}function p(t,e,i,u,l){t.pointCount=0;var p=e.m_radius+u.m_radius;m(e,i,u,l);var d=m._bestIndex,_=m._maxSeparation;if(!(_>p)){m(u,l,e,i);var f=m._bestIndex,y=m._maxSeparation;if(!(y>p)){var v,g,b,x,A,w;y>_+.1*h.linearSlop?(v=u,g=e,b=l,x=i,A=f,t.type=c.e_faceB,w=1):(v=e,g=u,b=i,x=l,A=d,t.type=c.e_faceA,w=0);var B=[new c.clipVertex,new c.clipVertex];!function(t,e,i,h,u,l){var m=e.m_normals,p=u.m_count,d=u.m_vertices,_=u.m_normals;n&&r.assert(0<=h&&h<e.m_count);for(var f=s.mulT(l.q,s.mulVec2(i.q,m[h])),y=0,v=1/0,g=0;g<p;++g){var b=a.dot(f,_[g]);b<v&&(v=b,y=g)}var x=y,A=x+1<p?x+1:0;t[0].v=o.mulVec2(l,d[x]),t[0].id.cf.indexA=h,t[0].id.cf.indexB=x,t[0].id.cf.typeA=c.e_face,t[0].id.cf.typeB=c.e_vertex,t[1].v=o.mulVec2(l,d[A]),t[1].id.cf.indexA=h,t[1].id.cf.indexB=A,t[1].id.cf.typeA=c.e_face,t[1].id.cf.typeB=c.e_vertex}(B,v,b,A,g,x);var T=v.m_count,E=v.m_vertices,C=A,S=A+1<T?A+1:0,I=E[C],M=E[S],P=a.sub(M,I);P.normalize();var D=a.cross(P,1),O=a.combine(.5,I,.5,M),L=s.mulVec2(b.q,P),N=a.cross(L,1);I=o.mulVec2(b,I),M=o.mulVec2(b,M);var V=a.dot(N,I),R=-a.dot(L,I)+p,F=a.dot(L,M)+p,z=[new c.clipVertex,new c.clipVertex],k=[new c.clipVertex,new c.clipVertex];if(!(c.clipSegmentToLine(z,B,a.neg(L),R,C)<2||c.clipSegmentToLine(k,z,L,F,S)<2)){t.localNormal=D,t.localPoint=O;for(var j=0,q=0;q<k.length;++q)if(a.dot(N,k[q].v)-V<=p){var U=t.points[j];if(U.localPoint.set(o.mulTVec2(x,k[q].v)),U.id=k[q].id,w){var G=U.id.cf,Y=G.indexA,W=G.indexB,$=G.typeA,H=G.typeB;G.indexA=W,G.indexB=Y,G.typeA=H,G.typeB=$}++j}t.pointCount=j}}}}t.exports=p,u.addType(l.TYPE,l.TYPE,(function(t,e,i,o,s,a,h){n&&r.assert(i.getType()==l.TYPE),n&&r.assert(a.getType()==l.TYPE),p(t,i.getShape(),e,a.getShape(),s)}))},3581:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=c;var n=i(4175),r=(i(4896),i(1099)),o=i(2322),s=(i(5387),i(8850)),a=i(3766),h=i(6306);function c(t,e){if(!(this instanceof c))return new c(t,e);c._super.call(this),this.m_type=c.TYPE,this.m_radius=r.polygonRadius,this.m_vertex1=t?h.clone(t):h.zero(),this.m_vertex2=e?h.clone(e):h.zero(),this.m_vertex0=h.zero(),this.m_vertex3=h.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1}i(3406),c._super=o,c.prototype=n(c._super.prototype),c.TYPE="edge",o.TYPES[c.TYPE]=c,c.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}},c._deserialize=function(t){var e=new c(t.vertex1,t.vertex2);return e.hasVertex0&&e.setPrev(t.vertex0),e.hasVertex3&&e.setNext(t.vertex3),e},c.prototype.setNext=function(t){return t?(this.m_vertex3.set(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},c.prototype.setPrev=function(t){return t?(this.m_vertex0.set(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},c.prototype._set=function(t,e){return this.m_vertex1.set(t),this.m_vertex2.set(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},c.prototype._clone=function(){var t=new c;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.set(this.m_vertex1),t.m_vertex2.set(this.m_vertex2),t.m_vertex0.set(this.m_vertex0),t.m_vertex3.set(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t},c.prototype.getChildCount=function(){return 1},c.prototype.testPoint=function(t,e){return!1},c.prototype.rayCast=function(t,e,i,n){var r=a.mulTVec2(i.q,h.sub(e.p1,i.p)),o=a.mulTVec2(i.q,h.sub(e.p2,i.p)),s=h.sub(o,r),c=this.m_vertex1,u=this.m_vertex2,l=h.sub(u,c),m=h.neo(l.y,-l.x);m.normalize();var p=h.dot(m,h.sub(c,r)),d=h.dot(m,s);if(0==d)return!1;var _=p/d;if(_<0||e.maxFraction<_)return!1;var f=h.add(r,h.mul(_,s)),y=h.sub(u,c),v=h.dot(y,y);if(0==v)return!1;var g=h.dot(h.sub(f,c),y)/v;return!(g<0||1<g||(t.fraction=_,t.normal=p>0?a.mulVec2(i.q,m).neg():a.mulVec2(i.q,m),0))},c.prototype.computeAABB=function(t,e,i){var n=s.mulVec2(e,this.m_vertex1),r=s.mulVec2(e,this.m_vertex2);t.combinePoints(n,r),t.extend(this.m_radius)},c.prototype.computeMass=function(t,e){t.mass=0,t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},c.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}},8901:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var r=i(2274),o=i(4175),s=(i(4896),i(5387)),a=i(8850),h=i(3766),c=i(6306),u=(i(3406),i(1099)),l=i(2322);function m(t){if(!(this instanceof m))return new m(t);m._super.call(this),this.m_type=m.TYPE,this.m_radius=u.polygonRadius,this.m_centroid=c.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,t&&t.length&&this._set(t)}m._super=l,m.prototype=o(m._super.prototype),m.TYPE="polygon",l.TYPES[m.TYPE]=m,m.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}},m._deserialize=function(t,e,i){return new m(t.vertices&&t.vertices.map((t=>c._deserialize(t))))},m.prototype.getVertex=function(t){return n&&r.assert(0<=t&&t<this.m_count),this.m_vertices[t]},m.prototype._clone=function(){var t=new m;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.set(this.m_centroid);for(var e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t},m.prototype.getChildCount=function(){return 1},m.prototype._reset=function(){this._set(this.m_vertices)},m.prototype._set=function(t){if(n&&r.assert(3<=t.length&&t.length<=u.maxPolygonVertices),t.length<3)this._setAsBox(1,1);else{for(var e=s.min(t.length,u.maxPolygonVertices),i=[],o=0;o<e;++o){for(var a=t[o],h=!0,l=0;l<i.length;++l)if(c.distanceSquared(a,i[l])<.25*u.linearSlopSquared){h=!1;break}h&&i.push(a)}if((e=i.length)<3)return n&&r.assert(!1),void this._setAsBox(1,1);var m=0,p=i[0].x;for(o=1;o<e;++o){var d=i[o].x;(d>p||d===p&&i[o].y<i[m].y)&&(m=o,p=d)}for(var _=[],f=0,y=m;;){_[f]=y;var v=0;for(l=1;l<e;++l)if(v!==y){var g=c.sub(i[v],i[_[f]]),b=(a=c.sub(i[l],i[_[f]]),c.cross(g,a));b<0&&(v=l),0===b&&a.lengthSquared()>g.lengthSquared()&&(v=l)}else v=l;if(++f,y=v,v===m)break}if(f<3)return n&&r.assert(!1),void this._setAsBox(1,1);for(this.m_count=f,this.m_vertices=[],o=0;o<f;++o)this.m_vertices[o]=i[_[o]];for(o=0;o<f;++o){var x=o,A=o+1<f?o+1:0,w=c.sub(this.m_vertices[A],this.m_vertices[x]);n&&r.assert(w.lengthSquared()>s.EPSILON*s.EPSILON),this.m_normals[o]=c.cross(w,1),this.m_normals[o].normalize()}this.m_centroid=function(t,e){n&&r.assert(e>=3);for(var i=c.zero(),o=0,a=c.zero(),h=1/3,u=0;u<e;++u){var l=a,m=t[u],p=u+1<e?t[u+1]:t[0],d=c.sub(m,l),_=c.sub(p,l),f=.5*c.cross(d,_);o+=f,i.addMul(f*h,l),i.addMul(f*h,m),i.addMul(f*h,p)}return n&&r.assert(o>s.EPSILON),i.mul(1/o),i}(this.m_vertices,f)}},m.prototype._setAsBox=function(t,e,i,n){if(this.m_vertices[0]=c.neo(t,-e),this.m_vertices[1]=c.neo(t,e),this.m_vertices[2]=c.neo(-t,e),this.m_vertices[3]=c.neo(-t,-e),this.m_normals[0]=c.neo(1,0),this.m_normals[1]=c.neo(0,1),this.m_normals[2]=c.neo(-1,0),this.m_normals[3]=c.neo(0,-1),this.m_count=4,c.isValid(i)){n=n||0,this.m_centroid.set(i);var r=a.identity();r.p.set(i),r.q.set(n);for(var o=0;o<this.m_count;++o)this.m_vertices[o]=a.mulVec2(r,this.m_vertices[o]),this.m_normals[o]=h.mulVec2(r.q,this.m_normals[o])}},m.prototype.testPoint=function(t,e){for(var i=h.mulTVec2(t.q,c.sub(e,t.p)),n=0;n<this.m_count;++n)if(c.dot(this.m_normals[n],c.sub(i,this.m_vertices[n]))>0)return!1;return!0},m.prototype.rayCast=function(t,e,i,o){for(var s=h.mulTVec2(i.q,c.sub(e.p1,i.p)),a=h.mulTVec2(i.q,c.sub(e.p2,i.p)),u=c.sub(a,s),l=0,m=e.maxFraction,p=-1,d=0;d<this.m_count;++d){var _=c.dot(this.m_normals[d],c.sub(this.m_vertices[d],s)),f=c.dot(this.m_normals[d],u);if(0==f){if(_<0)return!1}else f<0&&_<l*f?(l=_/f,p=d):f>0&&_<m*f&&(m=_/f);if(m<l)return!1}return n&&r.assert(0<=l&&l<=e.maxFraction),p>=0&&(t.fraction=l,t.normal=h.mulVec2(i.q,this.m_normals[p]),!0)},m.prototype.computeAABB=function(t,e,i){for(var n=1/0,r=1/0,o=-1/0,h=-1/0,c=0;c<this.m_count;++c){var u=a.mulVec2(e,this.m_vertices[c]);n=s.min(n,u.x),o=s.max(o,u.x),r=s.min(r,u.y),h=s.max(h,u.y)}t.lowerBound.set(n,r),t.upperBound.set(o,h),t.extend(this.m_radius)},m.prototype.computeMass=function(t,e){n&&r.assert(this.m_count>=3);for(var i=c.zero(),o=0,a=0,h=c.zero(),u=0;u<this.m_count;++u)h.add(this.m_vertices[u]);h.mul(1/this.m_count);var l=1/3;for(u=0;u<this.m_count;++u){var m=c.sub(this.m_vertices[u],h),p=u+1<this.m_count?c.sub(this.m_vertices[u+1],h):c.sub(this.m_vertices[0],h),d=c.cross(m,p),_=.5*d;o+=_,i.addCombine(_*l,m,_*l,p);var f=m.x,y=m.y,v=p.x,g=p.y;a+=.25*l*d*(f*f+v*f+v*v+(y*y+g*y+g*g))}t.mass=e*o,n&&r.assert(o>s.EPSILON),i.mul(1/o),t.center.setCombine(1,i,1,h),t.I=e*a,t.I+=t.mass*(c.dot(t.center,t.center)-c.dot(i,i))},m.prototype.validate=function(){for(var t=0;t<this.m_count;++t)for(var e=t,i=t<this.m_count-1?e+1:0,n=this.m_vertices[e],r=c.sub(this.m_vertices[i],n),o=0;o<this.m_count;++o)if(o!=e&&o!=i){var s=c.sub(this.m_vertices[o],n);if(c.cross(r,s)<0)return!1}return!0},m.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}},5706:t=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=function(t){var e=[],i=t.max||1/0,n=t.create,r=t.allocate,o=t.release,s=t.discard,a=0,h=0,c=0,u=0;this.max=function(t){return"number"==typeof t?(i=t,this):i},this.size=function(){return e.length},this.allocate=function(){var t;return e.length>0?t=e.shift():(a++,t="function"==typeof n?n():{}),h++,"function"==typeof r&&r(t),t},this.release=function(t){e.length<i?(c++,"function"==typeof o&&o(t),e.push(t)):(u++,"function"==typeof s&&(t=s(t)))},this.toString=function(){return" +"+a+" >"+h+" <"+c+" -"+u+" ="+e.length+"/"+i}}},9205:t=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports.now=function(){return Date.now()},t.exports.diff=function(t){return Date.now()-t}},2274:(t,e)=>{var i="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;e.debug=function(){i&&console.log.apply(console,arguments)},e.assert=function(t,e,i){if(n&&!t)throw i&&console.log(i),new Error(e)}},4175:t=>{if("function"==typeof Object.create)t.exports=function(t,e){return Object.create.call(Object,t,e)};else{function e(){}t.exports=function(t,i){if(i)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return e.prototype=t,new e}}},4896:t=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,Object.prototype.propertyIsEnumerable,t.exports=function(t,e){for(var i in null==t&&(t={}),e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i]);if("function"==typeof Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),r=0;r<n.length;r++){var o=n[r];e.propertyIsEnumerable(o)&&void 0===t[i]&&(t[o]=e[o])}return t}},6099:(t,e,i)=>{!function(t){t.parser=function(t,e){return new r(t,e)},t.SAXParser=r,t.SAXStream=s,t.createStream=function(t,e){return new s(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function r(e,i){if(!(this instanceof r))return new r(e,i);var o=this;!function(t){for(var e=0,i=n.length;e<i;e++)t[n[e]]=""}(o),o.q=o.c="",o.bufferCheckPosition=t.MAX_BUFFER_LENGTH,o.opt=i||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!e,o.noscript=!(!e&&!o.opt.noscript),o.state=A.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(c)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),B(o,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),r.prototype={end:function(){I(this)},write:function(e){var i=this;if(this.error)throw this.error;if(i.closed)return S(i,"Cannot write after close. Assign an onready handler.");if(null===e)return I(i);"object"==typeof e&&(e=e.toString());for(var r=0,o="";o=F(e,r++),i.c=o,o;)switch(i.trackPosition&&(i.position++,"\n"===o?(i.line++,i.column=0):i.column++),i.state){case A.BEGIN:if(i.state=A.BEGIN_WHITESPACE,"\ufeff"===o)continue;R(i,o);continue;case A.BEGIN_WHITESPACE:R(i,o);continue;case A.TEXT:if(i.sawRoot&&!i.closedRoot){for(var s=r-1;o&&"<"!==o&&"&"!==o;)(o=F(e,r++))&&i.trackPosition&&(i.position++,"\n"===o?(i.line++,i.column=0):i.column++);i.textNode+=e.substring(s,r-1)}"<"!==o||i.sawRoot&&i.closedRoot&&!i.strict?(d(o)||i.sawRoot&&!i.closedRoot||M(i,"Text data outside of root node."),"&"===o?i.state=A.TEXT_ENTITY:i.textNode+=o):(i.state=A.OPEN_WAKA,i.startTagPosition=i.position);continue;case A.SCRIPT:"<"===o?i.state=A.SCRIPT_ENDING:i.script+=o;continue;case A.SCRIPT_ENDING:"/"===o?i.state=A.CLOSE_TAG:(i.script+="<"+o,i.state=A.SCRIPT);continue;case A.OPEN_WAKA:if("!"===o)i.state=A.SGML_DECL,i.sgmlDecl="";else if(d(o));else if(y(u,o))i.state=A.OPEN_TAG,i.tagName=o;else if("/"===o)i.state=A.CLOSE_TAG,i.tagName="";else if("?"===o)i.state=A.PROC_INST,i.procInstName=i.procInstBody="";else{if(M(i,"Unencoded <"),i.startTagPosition+1<i.position){var a=i.position-i.startTagPosition;o=new Array(a).join(" ")+o}i.textNode+="<"+o,i.state=A.TEXT}continue;case A.SGML_DECL:"[CDATA["===(i.sgmlDecl+o).toUpperCase()?(T(i,"onopencdata"),i.state=A.CDATA,i.sgmlDecl="",i.cdata=""):i.sgmlDecl+o==="--"?(i.state=A.COMMENT,i.comment="",i.sgmlDecl=""):"DOCTYPE"===(i.sgmlDecl+o).toUpperCase()?(i.state=A.DOCTYPE,(i.doctype||i.sawRoot)&&M(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):">"===o?(T(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=A.TEXT):_(o)?(i.state=A.SGML_DECL_QUOTED,i.sgmlDecl+=o):i.sgmlDecl+=o;continue;case A.SGML_DECL_QUOTED:o===i.q&&(i.state=A.SGML_DECL,i.q=""),i.sgmlDecl+=o;continue;case A.DOCTYPE:">"===o?(i.state=A.TEXT,T(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=o,"["===o?i.state=A.DOCTYPE_DTD:_(o)&&(i.state=A.DOCTYPE_QUOTED,i.q=o));continue;case A.DOCTYPE_QUOTED:i.doctype+=o,o===i.q&&(i.q="",i.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:i.doctype+=o,"]"===o?i.state=A.DOCTYPE:_(o)&&(i.state=A.DOCTYPE_DTD_QUOTED,i.q=o);continue;case A.DOCTYPE_DTD_QUOTED:i.doctype+=o,o===i.q&&(i.state=A.DOCTYPE_DTD,i.q="");continue;case A.COMMENT:"-"===o?i.state=A.COMMENT_ENDING:i.comment+=o;continue;case A.COMMENT_ENDING:"-"===o?(i.state=A.COMMENT_ENDED,i.comment=C(i.opt,i.comment),i.comment&&T(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+o,i.state=A.COMMENT);continue;case A.COMMENT_ENDED:">"!==o?(M(i,"Malformed comment"),i.comment+="--"+o,i.state=A.COMMENT):i.state=A.TEXT;continue;case A.CDATA:"]"===o?i.state=A.CDATA_ENDING:i.cdata+=o;continue;case A.CDATA_ENDING:"]"===o?i.state=A.CDATA_ENDING_2:(i.cdata+="]"+o,i.state=A.CDATA);continue;case A.CDATA_ENDING_2:">"===o?(i.cdata&&T(i,"oncdata",i.cdata),T(i,"onclosecdata"),i.cdata="",i.state=A.TEXT):"]"===o?i.cdata+="]":(i.cdata+="]]"+o,i.state=A.CDATA);continue;case A.PROC_INST:"?"===o?i.state=A.PROC_INST_ENDING:d(o)?i.state=A.PROC_INST_BODY:i.procInstName+=o;continue;case A.PROC_INST_BODY:if(!i.procInstBody&&d(o))continue;"?"===o?i.state=A.PROC_INST_ENDING:i.procInstBody+=o;continue;case A.PROC_INST_ENDING:">"===o?(T(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=A.TEXT):(i.procInstBody+="?"+o,i.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:y(l,o)?i.tagName+=o:(P(i),">"===o?L(i):"/"===o?i.state=A.OPEN_TAG_SLASH:(d(o)||M(i,"Invalid character in tag name"),i.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:">"===o?(L(i,!0),N(i)):(M(i,"Forward-slash in opening tag not followed by >"),i.state=A.ATTRIB);continue;case A.ATTRIB:if(d(o))continue;">"===o?L(i):"/"===o?i.state=A.OPEN_TAG_SLASH:y(u,o)?(i.attribName=o,i.attribValue="",i.state=A.ATTRIB_NAME):M(i,"Invalid attribute name");continue;case A.ATTRIB_NAME:"="===o?i.state=A.ATTRIB_VALUE:">"===o?(M(i,"Attribute without value"),i.attribValue=i.attribName,O(i),L(i)):d(o)?i.state=A.ATTRIB_NAME_SAW_WHITE:y(l,o)?i.attribName+=o:M(i,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if("="===o)i.state=A.ATTRIB_VALUE;else{if(d(o))continue;M(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",T(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",">"===o?L(i):y(u,o)?(i.attribName=o,i.state=A.ATTRIB_NAME):(M(i,"Invalid attribute name"),i.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(d(o))continue;_(o)?(i.q=o,i.state=A.ATTRIB_VALUE_QUOTED):(M(i,"Unquoted attribute value"),i.state=A.ATTRIB_VALUE_UNQUOTED,i.attribValue=o);continue;case A.ATTRIB_VALUE_QUOTED:if(o!==i.q){"&"===o?i.state=A.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=o;continue}O(i),i.q="",i.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:d(o)?i.state=A.ATTRIB:">"===o?L(i):"/"===o?i.state=A.OPEN_TAG_SLASH:y(u,o)?(M(i,"No whitespace between attributes"),i.attribName=o,i.attribValue="",i.state=A.ATTRIB_NAME):M(i,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!f(o)){"&"===o?i.state=A.ATTRIB_VALUE_ENTITY_U:i.attribValue+=o;continue}O(i),">"===o?L(i):i.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(i.tagName)">"===o?N(i):y(l,o)?i.tagName+=o:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=A.SCRIPT):(d(o)||M(i,"Invalid tagname in closing tag"),i.state=A.CLOSE_TAG_SAW_WHITE);else{if(d(o))continue;v(u,o)?i.script?(i.script+="</"+o,i.state=A.SCRIPT):M(i,"Invalid tagname in closing tag."):i.tagName=o}continue;case A.CLOSE_TAG_SAW_WHITE:if(d(o))continue;">"===o?N(i):M(i,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var h,c;switch(i.state){case A.TEXT_ENTITY:h=A.TEXT,c="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:h=A.ATTRIB_VALUE_QUOTED,c="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:h=A.ATTRIB_VALUE_UNQUOTED,c="attribValue"}";"===o?(i[c]+=V(i),i.entity="",i.state=h):y(i.entity.length?p:m,o)?i.entity+=o:(M(i,"Invalid character in entity name"),i[c]+="&"+i.entity+o,i.entity="",i.state=h);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&function(e){for(var i=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,o=0,s=n.length;o<s;o++){var a=e[n[o]].length;if(a>i)switch(n[o]){case"textNode":E(e);break;case"cdata":T(e,"oncdata",e.cdata),e.cdata="";break;case"script":T(e,"onscript",e.script),e.script="";break;default:S(e,"Max buffer length exceeded: "+n[o])}r=Math.max(r,a)}var h=t.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=h+e.position}(i),i},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;E(t=this),""!==t.cdata&&(T(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(T(t,"onscript",t.script),t.script="")}};try{e=i(2830).Stream}catch(t){e=function(){}}var o=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function s(t,i){if(!(this instanceof s))return new s(t,i);e.apply(this),this._parser=new r(t,i),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(t){n.emit("error",t),n._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(n,"on"+t,{get:function(){return n._parser["on"+t]},set:function(e){if(!e)return n.removeAllListeners(t),n._parser["on"+t]=e,e;n.on(t,e)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(e.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=i(2553).s;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(t,i){var n=this;return n._parser["on"+t]||-1===o.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e)}),e.prototype.on.call(n,t,i)};var a="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",c={xml:a,xmlns:h},u=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,l=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function d(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function _(t){return'"'===t||"'"===t}function f(t){return">"===t||d(t)}function y(t,e){return t.test(e)}function v(t,e){return!y(t,e)}var g,b,x,A=0;for(var w in t.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var i=t.ENTITIES[e],n="number"==typeof i?String.fromCharCode(i):i;t.ENTITIES[e]=n})),t.STATE)t.STATE[t.STATE[w]]=w;function B(t,e,i){t[e]&&t[e](i)}function T(t,e,i){t.textNode&&E(t),B(t,e,i)}function E(t){t.textNode=C(t.opt,t.textNode),t.textNode&&B(t,"ontext",t.textNode),t.textNode=""}function C(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function S(t,e){return E(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,B(t,"onerror",e),t}function I(t){return t.sawRoot&&!t.closedRoot&&M(t,"Unclosed root tag"),t.state!==A.BEGIN&&t.state!==A.BEGIN_WHITESPACE&&t.state!==A.TEXT&&S(t,"Unexpected end"),E(t),t.c="",t.closed=!0,B(t,"onend"),r.call(t,t.strict,t.opt),t}function M(t,e){if("object"!=typeof t||!(t instanceof r))throw new Error("bad call to strictFail");t.strict&&S(t,e)}function P(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,i=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(i.ns=e.ns),t.attribList.length=0,T(t,"onopentagstart",i)}function D(t,e){var i=t.indexOf(":")<0?["",t]:t.split(":"),n=i[0],r=i[1];return e&&"xmlns"===t&&(n="xmlns",r=""),{prefix:n,local:r}}function O(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=D(t.attribName,!0),i=e.prefix,n=e.local;if("xmlns"===i)if("xml"===n&&t.attribValue!==a)M(t,"xml: prefix must be bound to "+a+"\nActual: "+t.attribValue);else if("xmlns"===n&&t.attribValue!==h)M(t,"xmlns: prefix must be bound to "+h+"\nActual: "+t.attribValue);else{var r=t.tag,o=t.tags[t.tags.length-1]||t;r.ns===o.ns&&(r.ns=Object.create(o.ns)),r.ns[n]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,T(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function L(t,e){if(t.opt.xmlns){var i=t.tag,n=D(t.tagName);i.prefix=n.prefix,i.local=n.local,i.uri=i.ns[n.prefix]||"",i.prefix&&!i.uri&&(M(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),i.uri=n.prefix);var r=t.tags[t.tags.length-1]||t;i.ns&&r.ns!==i.ns&&Object.keys(i.ns).forEach((function(e){T(t,"onopennamespace",{prefix:e,uri:i.ns[e]})}));for(var o=0,s=t.attribList.length;o<s;o++){var a=t.attribList[o],h=a[0],c=a[1],u=D(h,!0),l=u.prefix,m=u.local,p=""===l?"":i.ns[l]||"",d={name:h,value:c,prefix:l,local:m,uri:p};l&&"xmlns"!==l&&!p&&(M(t,"Unbound namespace prefix: "+JSON.stringify(l)),d.uri=l),t.tag.attributes[h]=d,T(t,"onattribute",d)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),T(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=A.TEXT:t.state=A.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function N(t){if(!t.tagName)return M(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=A.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=A.SCRIPT);T(t,"onscript",t.script),t.script=""}var e=t.tags.length,i=t.tagName;t.strict||(i=i[t.looseCase]());for(var n=i;e--&&t.tags[e].name!==n;)M(t,"Unexpected close tag");if(e<0)return M(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=A.TEXT);t.tagName=i;for(var r=t.tags.length;r-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,T(t,"onclosetag",t.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var h=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==h.ns&&Object.keys(o.ns).forEach((function(e){var i=o.ns[e];T(t,"onclosenamespace",{prefix:e,uri:i})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=A.TEXT}function V(t){var e,i=t.entity,n=i.toLowerCase(),r="";return t.ENTITIES[i]?t.ENTITIES[i]:t.ENTITIES[n]?t.ENTITIES[n]:("#"===(i=n).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),r=(e=parseInt(i,16)).toString(16)):(i=i.slice(1),r=(e=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),isNaN(e)||r.toLowerCase()!==i?(M(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function R(t,e){"<"===e?(t.state=A.OPEN_WAKA,t.startTagPosition=t.position):d(e)||(M(t,"Non-whitespace before first tag."),t.textNode=e,t.state=A.TEXT)}function F(t,e){var i="";return e<t.length&&(i=t.charAt(e)),i}A=t.STATE,String.fromCodePoint||(g=String.fromCharCode,b=Math.floor,x=function(){var t,e,i=16384,n=[],r=-1,o=arguments.length;if(!o)return"";for(var s="";++r<o;){var a=Number(arguments[r]);if(!isFinite(a)||a<0||a>1114111||b(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?n.push(a):(t=55296+((a-=65536)>>10),e=a%1024+56320,n.push(t,e)),(r+1===o||n.length>i)&&(s+=g.apply(null,n),n.length=0)}return s},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:x,configurable:!0,writable:!0}):String.fromCodePoint=x)}(e)},4889:function(t,e,i){!function(t,e){"use strict";if(!t.setImmediate){var i,n,r,o,s,a=1,h={},c=!1,u=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?i=function(t){process.nextTick((function(){p(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&p(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(o+e,"*")}):t.MessageChannel?((r=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){r.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,i=function(t){var e=u.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):i=function(t){setTimeout(p,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return h[a]=r,i(a),a++},l.clearImmediate=m}function m(t){delete h[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=h[t];if(e){c=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(void 0,i)}}(e)}finally{m(t),c=!1}}}}}("undefined"==typeof self?void 0===i.g?this:i.g:self)},2830:(t,e,i)=>{t.exports=r;var n=i(7187).EventEmitter;function r(){n.call(this)}i(5717)(r,n),r.Readable=i(6577),r.Writable=i(323),r.Duplex=i(8656),r.Transform=i(4473),r.PassThrough=i(2366),r.finished=i(1086),r.pipeline=i(6472),r.Stream=r,r.prototype.pipe=function(t,e){var i=this;function r(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function o(){i.readable&&i.resume&&i.resume()}i.on("data",r),t.on("drain",o),t._isStdio||e&&!1===e.end||(i.on("end",a),i.on("close",h));var s=!1;function a(){s||(s=!0,t.end())}function h(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(u(),0===n.listenerCount(this,"error"))throw t}function u(){i.removeListener("data",r),t.removeListener("drain",o),i.removeListener("end",a),i.removeListener("close",h),i.removeListener("error",c),t.removeListener("error",c),i.removeListener("end",u),i.removeListener("close",u),t.removeListener("close",u)}return i.on("error",c),t.on("error",c),i.on("end",u),i.on("close",u),t.on("close",u),t.emit("pipe",i),t}},8106:t=>{"use strict";var e={};function i(t,i,n){n||(n=Error);var r=function(t){var e,n;function r(e,n,r){return t.call(this,function(t,e,n){return"string"==typeof i?i:i(t,e,n)}(e,n,r))||this}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r}(n);r.prototype.name=n.name,r.prototype.code=t,e[t]=r}function n(t,e){if(Array.isArray(t)){var i=t.length;return t=t.map((function(t){return String(t)})),i>2?"one of ".concat(e," ").concat(t.slice(0,i-1).join(", "),", or ")+t[i-1]:2===i?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}i("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(t,e,i){var r,o,s,a,h;if("string"==typeof e&&(o="not ",e.substr(0,o.length)===o)?(r="must not be",e=e.replace(/^not /,"")):r="must be",function(t,e,i){return(void 0===i||i>t.length)&&(i=t.length),t.substring(i-e.length,i)===e}(t," argument"))s="The ".concat(t," ").concat(r," ").concat(n(e,"type"));else{var c=("number"!=typeof h&&(h=0),h+".".length>(a=t).length||-1===a.indexOf(".",h)?"argument":"property");s='The "'.concat(t,'" ').concat(c," ").concat(r," ").concat(n(e,"type"))}return s+". Received type ".concat(typeof i)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.q=e},8656:(t,e,i)=>{"use strict";var n=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=c;var r=i(6577),o=i(323);i(5717)(c,r);for(var s=n(o.prototype),a=0;a<s.length;a++){var h=s[a];c.prototype[h]||(c.prototype[h]=o.prototype[h])}function c(t){if(!(this instanceof c))return new c(t);r.call(this,t),o.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||process.nextTick(l,this)}function l(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},2366:(t,e,i)=>{"use strict";t.exports=r;var n=i(4473);function r(t){if(!(this instanceof r))return new r(t);n.call(this,t)}i(5717)(r,n),r.prototype._transform=function(t,e,i){i(null,t)}},6577:(t,e,i)=>{"use strict";var n;t.exports=B,B.ReadableState=w,i(7187).EventEmitter;var r,o=function(t,e){return t.listeners(e).length},s=i(3194),a=i(8764).Buffer,h=i.g.Uint8Array||function(){},c=i(1758);r=c&&c.debuglog?c.debuglog("stream"):function(){};var u,l,m,p=i(9686),d=i(1029),_=i(94).getHighWaterMark,f=i(8106).q,y=f.ERR_INVALID_ARG_TYPE,v=f.ERR_STREAM_PUSH_AFTER_EOF,g=f.ERR_METHOD_NOT_IMPLEMENTED,b=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(5717)(B,s);var x=d.errorOrDestroy,A=["error","close","destroy","pause","resume"];function w(t,e,r){n=n||i(8656),t=t||{},"boolean"!=typeof r&&(r=e instanceof n),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=_(this,t,"readableHighWaterMark",r),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(u||(u=i(2553).s),this.decoder=new u(t.encoding),this.encoding=t.encoding)}function B(t){if(n=n||i(8656),!(this instanceof B))return new B(t);var e=this instanceof n;this._readableState=new w(t,this,e),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function T(t,e,i,n,o){r("readableAddChunk",e);var s,c=t._readableState;if(null===e)c.reading=!1,function(t,e){if(r("onEofChunk"),!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,e.sync?I(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,M(t)))}}(t,c);else if(o||(s=function(t,e){var i,n;return n=e,a.isBuffer(n)||n instanceof h||"string"==typeof e||void 0===e||t.objectMode||(i=new y("chunk",["string","Buffer","Uint8Array"],e)),i}(c,e)),s)x(t,s);else if(c.objectMode||e&&e.length>0)if("string"==typeof e||c.objectMode||Object.getPrototypeOf(e)===a.prototype||(e=function(t){return a.from(t)}(e)),n)c.endEmitted?x(t,new b):E(t,c,e,!0);else if(c.ended)x(t,new v);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!i?(e=c.decoder.write(e),c.objectMode||0!==e.length?E(t,c,e,!1):P(t,c)):E(t,c,e,!1)}else n||(c.reading=!1,P(t,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function E(t,e,i,n){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",i)):(e.length+=e.objectMode?1:i.length,n?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&I(t)),P(t,e)}Object.defineProperty(B.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),B.prototype.destroy=d.destroy,B.prototype._undestroy=d.undestroy,B.prototype._destroy=function(t,e){e(t)},B.prototype.push=function(t,e){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=a.from(t,e),e=""),i=!0),T(this,t,e,!1,i)},B.prototype.unshift=function(t){return T(this,t,null,!0,!1)},B.prototype.isPaused=function(){return!1===this._readableState.flowing},B.prototype.setEncoding=function(t){u||(u=i(2553).s);var e=new u(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=e.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var C=1073741824;function S(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=C?t=C:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function I(t){var e=t._readableState;r("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(r("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(M,t))}function M(t){var e=t._readableState;r("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,V(t)}function P(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(D,t,e))}function D(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var i=e.length;if(r("maybeReadMore read 0"),t.read(0),i===e.length)break}e.readingMore=!1}function O(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function L(t){r("readable nexttick read 0"),t.read(0)}function N(t,e){r("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),V(t),e.flowing&&!e.reading&&t.read(0)}function V(t){var e=t._readableState;for(r("flow",e.flowing);e.flowing&&null!==t.read(););}function R(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):i=e.buffer.consume(t,e.decoder),i);var i}function F(t){var e=t._readableState;r("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(z,e,t))}function z(t,e){if(r("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var i=e._writableState;(!i||i.autoDestroy&&i.finished)&&e.destroy()}}function k(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}B.prototype.read=function(t){r("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return r("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?F(this):I(this),null;if(0===(t=S(t,e))&&e.ended)return 0===e.length&&F(this),null;var n,o=e.needReadable;return r("need readable",o),(0===e.length||e.length-t<e.highWaterMark)&&r("length less than watermark",o=!0),e.ended||e.reading?r("reading or ended",o=!1):o&&(r("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=S(i,e))),null===(n=t>0?R(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&F(this)),null!==n&&this.emit("data",n),n},B.prototype._read=function(t){x(this,new g("_read()"))},B.prototype.pipe=function(t,e){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t)}n.pipesCount+=1,r("pipe count=%d opts=%j",n.pipesCount,e);var s=e&&!1===e.end||t===process.stdout||t===process.stderr?d:a;function a(){r("onend"),t.end()}n.endEmitted?process.nextTick(s):i.once("end",s),t.on("unpipe",(function e(o,s){r("onunpipe"),o===i&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,r("cleanup"),t.removeListener("close",m),t.removeListener("finish",p),t.removeListener("drain",h),t.removeListener("error",l),t.removeListener("unpipe",e),i.removeListener("end",a),i.removeListener("end",d),i.removeListener("data",u),c=!0,!n.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}));var h=function(t){return function(){var e=t._readableState;r("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,V(t))}}(i);t.on("drain",h);var c=!1;function u(e){r("ondata");var o=t.write(e);r("dest.write",o),!1===o&&((1===n.pipesCount&&n.pipes===t||n.pipesCount>1&&-1!==k(n.pipes,t))&&!c&&(r("false write response, pause",n.awaitDrain),n.awaitDrain++),i.pause())}function l(e){r("onerror",e),d(),t.removeListener("error",l),0===o(t,"error")&&x(t,e)}function m(){t.removeListener("finish",p),d()}function p(){r("onfinish"),t.removeListener("close",m),d()}function d(){r("unpipe"),i.unpipe(t)}return i.on("data",u),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(i):t._events.error=[i,t._events.error]:t.on(e,i)}(t,"error",l),t.once("close",m),t.once("finish",p),t.emit("pipe",i),n.flowing||(r("pipe resume"),i.resume()),t},B.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i)),this;if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=k(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i)),this},B.prototype.on=function(t,e){var i=s.prototype.on.call(this,t,e),n=this._readableState;return"data"===t?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===t&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,r("on readable",n.length,n.reading),n.length?I(this):n.reading||process.nextTick(L,this))),i},B.prototype.addListener=B.prototype.on,B.prototype.removeListener=function(t,e){var i=s.prototype.removeListener.call(this,t,e);return"readable"===t&&process.nextTick(O,this),i},B.prototype.removeAllListeners=function(t){var e=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||process.nextTick(O,this),e},B.prototype.resume=function(){var t=this._readableState;return t.flowing||(r("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(N,t,e))}(this,t)),t.paused=!1,this},B.prototype.pause=function(){return r("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(r("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},B.prototype.wrap=function(t){var e=this,i=this._readableState,n=!1;for(var o in t.on("end",(function(){if(r("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(o){r("wrapped data"),i.decoder&&(o=i.decoder.write(o)),i.objectMode&&null==o||(i.objectMode||o&&o.length)&&(e.push(o)||(n=!0,t.pause()))})),t)void 0===this[o]&&"function"==typeof t[o]&&(this[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));for(var s=0;s<A.length;s++)t.on(A[s],this.emit.bind(this,A[s]));return this._read=function(e){r("wrapped _read",e),n&&(n=!1,t.resume())},this},"function"==typeof Symbol&&(B.prototype[Symbol.asyncIterator]=function(){return void 0===l&&(l=i(828)),l(this)}),Object.defineProperty(B.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(B.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(B.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),B._fromList=R,Object.defineProperty(B.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(B.from=function(t,e){return void 0===m&&(m=i(1265)),m(B,t,e)})},4473:(t,e,i)=>{"use strict";t.exports=u;var n=i(8106).q,r=n.ERR_METHOD_NOT_IMPLEMENTED,o=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,h=i(8656);function c(t,e){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(null===n)return this.emit("error",new o);i.writechunk=null,i.writecb=null,null!=e&&this.push(e),n(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function u(t){if(!(this instanceof u))return new u(t);h.call(this,t),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",l)}function l(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?m(this,null,null):this._flush((function(e,i){m(t,e,i)}))}function m(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new a;if(t._transformState.transforming)throw new s;return t.push(null)}i(5717)(u,h),u.prototype.push=function(t,e){return this._transformState.needTransform=!1,h.prototype.push.call(this,t,e)},u.prototype._transform=function(t,e,i){i(new r("_transform()"))},u.prototype._write=function(t,e,i){var n=this._transformState;if(n.writecb=i,n.writechunk=t,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},u.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},u.prototype._destroy=function(t,e){h.prototype._destroy.call(this,t,(function(t){e(t)}))}},323:(t,e,i)=>{"use strict";function n(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var n=t.entry;for(t.entry=null;n;){var r=n.callback;e.pendingcb--,r(undefined),n=n.next}e.corkedRequestsFree.next=t}(e,t)}}var r;t.exports=B,B.WritableState=w;var o,s={deprecate:i(4927)},a=i(3194),h=i(8764).Buffer,c=i.g.Uint8Array||function(){},u=i(1029),l=i(94).getHighWaterMark,m=i(8106).q,p=m.ERR_INVALID_ARG_TYPE,d=m.ERR_METHOD_NOT_IMPLEMENTED,_=m.ERR_MULTIPLE_CALLBACK,f=m.ERR_STREAM_CANNOT_PIPE,y=m.ERR_STREAM_DESTROYED,v=m.ERR_STREAM_NULL_VALUES,g=m.ERR_STREAM_WRITE_AFTER_END,b=m.ERR_UNKNOWN_ENCODING,x=u.errorOrDestroy;function A(){}function w(t,e,o){r=r||i(8656),t=t||{},"boolean"!=typeof o&&(o=e instanceof r),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=l(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===t.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,n=i.sync,r=i.writecb;if("function"!=typeof r)throw new _;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,n,r){--e.pendingcb,i?(process.nextTick(r,n),process.nextTick(M,t,e),t._writableState.errorEmitted=!0,x(t,n)):(r(n),t._writableState.errorEmitted=!0,x(t,n),M(t,e))}(t,i,n,e,r);else{var o=S(i)||t.destroyed;o||i.corked||i.bufferProcessing||!i.bufferedRequest||C(t,i),n?process.nextTick(E,t,i,o,r):E(t,i,o,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function B(t){var e=this instanceof(r=r||i(8656));if(!e&&!o.call(B,this))return new B(t);this._writableState=new w(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),a.call(this)}function T(t,e,i,n,r,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new y("write")):i?t._writev(r,e.onwrite):t._write(r,o,e.onwrite),e.sync=!1}function E(t,e,i,n){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),M(t,e)}function C(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,o=new Array(r),s=e.corkedRequestsFree;s.entry=i;for(var a=0,h=!0;i;)o[a]=i,i.isBuf||(h=!1),i=i.next,a+=1;o.allBuffers=h,T(t,e,!0,e.length,o,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new n(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,u=i.encoding,l=i.callback;if(T(t,e,!1,e.objectMode?1:c.length,c,u,l),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function S(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function I(t,e){t._final((function(i){e.pendingcb--,i&&x(t,i),e.prefinished=!0,t.emit("prefinish"),M(t,e)}))}function M(t,e){var i=S(e);if(i&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,process.nextTick(I,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return i}i(5717)(B,a),w.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(w.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(B,Symbol.hasInstance,{value:function(t){return!!o.call(this,t)||this===B&&t&&t._writableState instanceof w}})):o=function(t){return t instanceof this},B.prototype.pipe=function(){x(this,new f)},B.prototype.write=function(t,e,i){var n,r=this._writableState,o=!1,s=!r.objectMode&&(n=t,h.isBuffer(n)||n instanceof c);return s&&!h.isBuffer(t)&&(t=function(t){return h.from(t)}(t)),"function"==typeof e&&(i=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof i&&(i=A),r.ending?function(t,e){var i=new g;x(t,i),process.nextTick(e,i)}(this,i):(s||function(t,e,i,n){var r;return null===i?r=new v:"string"==typeof i||e.objectMode||(r=new p("chunk",["string","Buffer"],i)),!r||(x(t,r),process.nextTick(n,r),!1)}(this,r,t,i))&&(r.pendingcb++,o=function(t,e,i,n,r,o){if(!i){var s=function(t,e,i){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,i)),e}(e,n,r);n!==s&&(i=!0,r="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else T(t,e,!1,a,n,r,o);return c}(this,r,s,t,e,i)),o},B.prototype.cork=function(){this._writableState.corked++},B.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||C(this,t))},B.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new b(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(B.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(B.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),B.prototype._write=function(t,e,i){i(new d("_write()"))},B.prototype._writev=null,B.prototype.end=function(t,e,i){var n=this._writableState;return"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!=t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||function(t,e,i){e.ending=!0,M(t,e),i&&(e.finished?process.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}(this,n,i),this},Object.defineProperty(B.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(B.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),B.prototype.destroy=u.destroy,B.prototype._undestroy=u.undestroy,B.prototype._destroy=function(t,e){e(t)}},828:(t,e,i)=>{"use strict";var n;function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o=i(1086),s=Symbol("lastResolve"),a=Symbol("lastReject"),h=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),l=Symbol("handlePromise"),m=Symbol("stream");function p(t,e){return{value:t,done:e}}function d(t){var e=t[s];if(null!==e){var i=t[m].read();null!==i&&(t[u]=null,t[s]=null,t[a]=null,e(p(i,!1)))}}function _(t){process.nextTick(d,t)}var f=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((r(n={get stream(){return this[m]},next:function(){var t=this,e=this[h];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(p(void 0,!0));if(this[m].destroyed)return new Promise((function(e,i){process.nextTick((function(){t[h]?i(t[h]):e(p(void 0,!0))}))}));var i,n=this[u];if(n)i=new Promise(function(t,e){return function(i,n){t.then((function(){e[c]?i(p(void 0,!0)):e[l](i,n)}),n)}}(n,this));else{var r=this[m].read();if(null!==r)return Promise.resolve(p(r,!1));i=new Promise(this[l])}return this[u]=i,i}},Symbol.asyncIterator,(function(){return this})),r(n,"return",(function(){var t=this;return new Promise((function(e,i){t[m].destroy(null,(function(t){t?i(t):e(p(void 0,!0))}))}))})),n),f);t.exports=function(t){var e,i=Object.create(y,(r(e={},m,{value:t,writable:!0}),r(e,s,{value:null,writable:!0}),r(e,a,{value:null,writable:!0}),r(e,h,{value:null,writable:!0}),r(e,c,{value:t._readableState.endEmitted,writable:!0}),r(e,l,{value:function(t,e){var n=i[m].read();n?(i[u]=null,i[s]=null,i[a]=null,t(p(n,!1))):(i[s]=t,i[a]=e)},writable:!0}),e));return i[u]=null,o(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=i[a];return null!==e&&(i[u]=null,i[s]=null,i[a]=null,e(t)),void(i[h]=t)}var n=i[s];null!==n&&(i[u]=null,i[s]=null,i[a]=null,n(p(void 0,!0))),i[c]=!0})),t.on("readable",_.bind(null,i)),i}},9686:(t,e,i)=>{"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=i(8764).Buffer,a=i(1758).inspect,h=a&&a.custom||"inspect";t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e,i;return e=t,(i=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i}},{key:"concat",value:function(t){if(0===this.length)return s.alloc(0);for(var e,i,n,r=s.allocUnsafe(t>>>0),o=this.head,a=0;o;)e=o.data,i=r,n=a,s.prototype.copy.call(e,i,n),a+=o.data.length,o=o.next;return r}},{key:"consume",value:function(t,e){var i;return t<this.head.data.length?(i=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):i=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,i=1,n=e.data;for(t-=n.length;e=e.next;){var r=e.data,o=t>r.length?r.length:t;if(o===r.length?n+=r:n+=r.slice(0,t),0==(t-=o)){o===r.length?(++i,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=r.slice(o));break}++i}return this.length-=i,n}},{key:"_getBuffer",value:function(t){var e=s.allocUnsafe(t),i=this.head,n=1;for(i.data.copy(e),t-=i.data.length;i=i.next;){var r=i.data,o=t>r.length?r.length:t;if(r.copy(e,e.length-t,0,o),0==(t-=o)){o===r.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=r.slice(o));break}++n}return this.length-=n,e}},{key:h,value:function(t,e){return a(this,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}])&&o(e.prototype,i),t}()},1029:t=>{"use strict";function e(t,e){n(t,e),i(t)}function i(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function n(t,e){t.emit("error",e)}t.exports={destroy:function(t,r){var o=this,s=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return s||a?(r?r(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(n,this,t)):process.nextTick(n,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!r&&t?o._writableState?o._writableState.errorEmitted?process.nextTick(i,o):(o._writableState.errorEmitted=!0,process.nextTick(e,o,t)):process.nextTick(e,o,t):r?(process.nextTick(i,o),r(t)):process.nextTick(i,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var i=t._readableState,n=t._writableState;i&&i.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}}},1086:(t,e,i)=>{"use strict";var n=i(8106).q.ERR_STREAM_PREMATURE_CLOSE;function r(){}t.exports=function t(e,i,o){if("function"==typeof i)return t(e,null,i);i||(i={}),o=function(t){var e=!1;return function(){if(!e){e=!0;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];t.apply(this,n)}}}(o||r);var s=i.readable||!1!==i.readable&&e.readable,a=i.writable||!1!==i.writable&&e.writable,h=function(){e.writable||u()},c=e._writableState&&e._writableState.finished,u=function(){a=!1,c=!0,s||o.call(e)},l=e._readableState&&e._readableState.endEmitted,m=function(){s=!1,l=!0,a||o.call(e)},p=function(t){o.call(e,t)},d=function(){var t;return s&&!l?(e._readableState&&e._readableState.ended||(t=new n),o.call(e,t)):a&&!c?(e._writableState&&e._writableState.ended||(t=new n),o.call(e,t)):void 0},_=function(){e.req.on("finish",u)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",u),e.on("abort",d),e.req?_():e.on("request",_)):a&&!e._writableState&&(e.on("end",h),e.on("close",h)),e.on("end",m),e.on("finish",u),!1!==i.error&&e.on("error",p),e.on("close",d),function(){e.removeListener("complete",u),e.removeListener("abort",d),e.removeListener("request",_),e.req&&e.req.removeListener("finish",u),e.removeListener("end",h),e.removeListener("close",h),e.removeListener("finish",u),e.removeListener("end",m),e.removeListener("error",p),e.removeListener("close",d)}}},1265:t=>{t.exports=function(){throw new Error("Readable.from is not available in the browser")}},6472:(t,e,i)=>{"use strict";var n,r=i(8106).q,o=r.ERR_MISSING_ARGS,s=r.ERR_STREAM_DESTROYED;function a(t){if(t)throw t}function h(t,e,r,o){o=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(o);var a=!1;t.on("close",(function(){a=!0})),void 0===n&&(n=i(1086)),n(t,{readable:e,writable:r},(function(t){if(t)return o(t);a=!0,o()}));var h=!1;return function(e){if(!a&&!h)return h=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new s("pipe"))}}function c(t){t()}function u(t,e){return t.pipe(e)}function l(t){return t.length?"function"!=typeof t[t.length-1]?a:t.pop():a}t.exports=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n,r=l(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new o("streams");var s=e.map((function(t,i){var o=i<e.length-1;return h(t,o,i>0,(function(t){n||(n=t),t&&s.forEach(c),o||(s.forEach(c),r(n))}))}));return e.reduce(u)}},94:(t,e,i)=>{"use strict";var n=i(8106).q.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(t,e,i,r){var o=function(t,e,i){return null!=t.highWaterMark?t.highWaterMark:e?t[i]:null}(e,r,i);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(r?i:"highWaterMark",o);return Math.floor(o)}return t.objectMode?16:16384}}},3194:(t,e,i)=>{t.exports=i(7187).EventEmitter},2553:(t,e,i)=>{"use strict";var n=i(396).Buffer,r=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=h,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=l,e=3;break;default:return this.write=m,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function u(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function l(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function m(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.s=o,o.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var i=function(t,e,i){var n=e.length-1;if(n<i)return 0;var r=s(e[n]);return r>=0?(r>0&&(t.lastNeed=r-1),r):--n<i||-2===r?0:(r=s(e[n]))>=0?(r>0&&(t.lastNeed=r-2),r):--n<i||-2===r?0:(r=s(e[n]))>=0?(r>0&&(2===r?r=0:t.lastNeed=r-3),r):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var n=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},396:(t,e,i)=>{var n=i(8764),r=n.Buffer;function o(t,e){for(var i in t)e[i]=t[i]}function s(t,e,i){return r(t,e,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(o(n,e),e.Buffer=s),o(r,s),s.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,i)},s.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=r(t);return void 0!==e?"string"==typeof i?n.fill(e,i):n.fill(e):n.fill(0),n},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},5475:function(t,e,i){var n=void 0!==i.g&&i.g||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i(4889),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==i.g&&i.g.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==i.g&&i.g.clearImmediate||this&&this.clearImmediate},4927:(t,e,i)=>{function n(t){try{if(!i.g.localStorage)return!1}catch(t){return!1}var e=i.g.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),i=!0}return t.apply(this,arguments)}}},306:function(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},4096:function(t,e,i){(function(){"use strict";var t,n,r,o,s,a={}.hasOwnProperty;t=i(5532),n=i(8381).defaults,o=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+r(t)+"]]>"},r=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,i,r;for(e in this.options={},i=n[.2])a.call(i,e)&&(r=i[e],this.options[e]=r);for(e in t)a.call(t,e)&&(r=t[e],this.options[e]=r)}return e.prototype.buildObject=function(e){var i,r,h,c,u,l;return i=this.options.attrkey,r=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===n[.2].rootName?e=e[u=Object.keys(e)[0]]:u=this.options.rootName,l=this,h=function(t,e){var n,c,u,m,p,d;if("object"!=typeof e)l.options.cdata&&o(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(m in e)if(a.call(e,m))for(p in c=e[m])u=c[p],t=h(t.ele(p),u).up()}else for(p in e)if(a.call(e,p))if(c=e[p],p===i){if("object"==typeof c)for(n in c)d=c[n],t=t.att(n,d)}else if(p===r)t=l.options.cdata&&o(c)?t.raw(s(c)):t.txt(c);else if(Array.isArray(c))for(m in c)a.call(c,m)&&(t="string"==typeof(u=c[m])?l.options.cdata&&o(u)?t.ele(p).raw(s(u)).up():t.ele(p,u).up():h(t.ele(p),u).up());else"object"==typeof c?t=h(t.ele(p),c).up():"string"==typeof c&&l.options.cdata&&o(c)?t=t.ele(p).raw(s(c)).up():(null==c&&(c=""),t=t.ele(p,c.toString()).up());return t},c=t.create(u,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),h(c,e).end(this.options.renderOpts)},e}()}).call(this)},8381:function(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},9082:function(t,e,i){(function(){"use strict";var t,n,r,o,s,a,h,c,u=function(t,e){return function(){return t.apply(e,arguments)}},l={}.hasOwnProperty;h=i(6099),r=i(7187),t=i(306),a=i(7526),c=i(5475).setImmediate,n=i(8381).defaults,o=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},s=function(t,e,i){var n,r;for(n=0,r=t.length;n<r;n++)e=(0,t[n])(e,i);return e},e.Parser=function(i){function r(t){var i,r,o;if(this.parseStringPromise=u(this.parseStringPromise,this),this.parseString=u(this.parseString,this),this.reset=u(this.reset,this),this.assignOrPush=u(this.assignOrPush,this),this.processAsync=u(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(i in this.options={},r=n[.2])l.call(r,i)&&(o=r[i],this.options[i]=o);for(i in t)l.call(t,i)&&(o=t[i],this.options[i]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(a.normalize)),this.reset()}return function(t,e){for(var i in e)l.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(r,i),r.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),c(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},r.prototype.assignOrPush=function(t,e,i){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(i)):this.options.explicitArray?t[e]=[i]:t[e]=i},r.prototype.reset=function(){var t,e,i,n,r;return this.removeAllListeners(),this.saxParser=h.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(r=this,function(t){if(r.saxParser.resume(),!r.saxParser.errThrown)return r.saxParser.errThrown=!0,r.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,n=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(i){return function(r){var o,a,h,c,u;if((h={})[e]="",!i.options.ignoreAttrs)for(o in u=r.attributes)l.call(u,o)&&(t in h||i.options.mergeAttrs||(h[t]={}),a=i.options.attrValueProcessors?s(i.options.attrValueProcessors,r.attributes[o],o):r.attributes[o],c=i.options.attrNameProcessors?s(i.options.attrNameProcessors,o):o,i.options.mergeAttrs?i.assignOrPush(h,c,a):h[t][c]=a);return h["#name"]=i.options.tagNameProcessors?s(i.options.tagNameProcessors,r.name):r.name,i.options.xmlns&&(h[i.options.xmlnskey]={uri:r.uri,local:r.local}),n.push(h)}}(this),this.saxParser.onclosetag=function(t){return function(){var i,r,a,h,c,u,m,p,d,_;if(u=n.pop(),c=u["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete u["#name"],!0===u.cdata&&(i=u.cdata,delete u.cdata),d=n[n.length-1],u[e].match(/^\s*$/)&&!i?(r=u[e],delete u[e]):(t.options.trim&&(u[e]=u[e].trim()),t.options.normalize&&(u[e]=u[e].replace(/\s{2,}/g," ").trim()),u[e]=t.options.valueProcessors?s(t.options.valueProcessors,u[e],c):u[e],1===Object.keys(u).length&&e in u&&!t.EXPLICIT_CHARKEY&&(u=u[e])),o(u)&&(u=""!==t.options.emptyTag?t.options.emptyTag:r),null!=t.options.validator&&(_="/"+function(){var t,e,i;for(i=[],t=0,e=n.length;t<e;t++)h=n[t],i.push(h["#name"]);return i}().concat(c).join("/"),function(){var e;try{u=t.options.validator(_,d&&d[c],u)}catch(i){return e=i,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof u)if(t.options.preserveChildrenOrder){if(d){for(a in d[t.options.childkey]=d[t.options.childkey]||[],m={},u)l.call(u,a)&&(m[a]=u[a]);d[t.options.childkey].push(m),delete u["#name"],1===Object.keys(u).length&&e in u&&!t.EXPLICIT_CHARKEY&&(u=u[e])}}else h={},t.options.attrkey in u&&(h[t.options.attrkey]=u[t.options.attrkey],delete u[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in u&&(h[t.options.charkey]=u[t.options.charkey],delete u[t.options.charkey]),Object.getOwnPropertyNames(u).length>0&&(h[t.options.childkey]=u),u=h;return n.length>0?t.assignOrPush(d,c,u):(t.options.explicitRoot&&(p=u,(u={})[c]=p),t.resultObject=u,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),i=function(t){return function(i){var r,o;if(o=n[n.length-1])return o[e]+=i,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==i.replace(/\\n/g,"").trim())&&(o[t.options.childkey]=o[t.options.childkey]||[],(r={"#name":"__text__"})[e]=i,t.options.normalize&&(r[e]=r[e].replace(/\s{2,}/g," ").trim()),o[t.options.childkey].push(r)),o}}(this),this.saxParser.ontext=i,this.saxParser.oncdata=function(t){var e;if(e=i(t))return e.cdata=!0}},r.prototype.parseString=function(e,i){var n;null!=i&&"function"==typeof i&&(this.on("end",(function(t){return this.reset(),i(null,t)})),this.on("error",(function(t){return this.reset(),i(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,c(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(n=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",n),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw n}},r.prototype.parseStringPromise=function(t){return new Promise((e=this,function(i,n){return e.parseString(t,(function(t,e){return t?n(t):i(e)}))}));var e},r}(r),e.parseString=function(t,i,n){var r,o;return null!=n?("function"==typeof n&&(r=n),"object"==typeof i&&(o=i)):("function"==typeof i&&(r=i),o={}),new e.Parser(o).parseString(t,r)},e.parseStringPromise=function(t,i){var n;return"object"==typeof i&&(n=i),new e.Parser(n).parseStringPromise(t)}}).call(this)},7526:function(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},5055:function(t,e,i){(function(){"use strict";var t,n,r,o,s={}.hasOwnProperty;n=i(8381),t=i(4096),r=i(9082),o=i(7526),e.defaults=n.defaults,e.processors=o,e.ValidationError=function(t){function e(t){this.message=t}return function(t,e){for(var i in e)s.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,Error),e}(),e.Builder=t.Builder,e.Parser=r.Parser,e.parseString=r.parseString,e.parseStringPromise=r.parseStringPromise}).call(this)},7557:function(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},9335:function(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},8369:function(t){(function(){var e,i,n,r,o,s,a,h=[].slice,c={}.hasOwnProperty;e=function(){var t,e,i,n,r,s;if(s=arguments[0],r=2<=arguments.length?h.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(t=0,i=r.length;t<i;t++)if(null!=(n=r[t]))for(e in n)c.call(n,e)&&(s[e]=n[e]);return s},o=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},s=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},n=function(t){return o(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},r=function(t){var e;if(n(t))return!t.length;for(e in t)if(c.call(t,e))return!1;return!0},a=function(t){var e,i;return s(t)&&(i=Object.getPrototypeOf(t))&&(e=i.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},i=function(t){return o(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=o,t.exports.isObject=s,t.exports.isArray=n,t.exports.isEmpty=r,t.exports.isPlainObject=a,t.exports.getValue=i}).call(this)},594:function(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},2750:function(t,e,i){(function(){var e;e=i(9335),i(2026),t.exports=function(){function t(t,i,n){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==i)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(n),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&t.prefix===this.prefix&&t.localName===this.localName&&t.value===this.value},t}()}).call(this)},6170:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;e=i(9335),n=i(6488),t.exports=function(t){function i(t,n){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(n)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},6488:function(t,e,i){(function(){var e,n={}.hasOwnProperty;e=i(2026),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},2096:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;e=i(9335),n=i(6488),t.exports=function(t){function i(t,n){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(n)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},383:function(t,e,i){(function(){var e,n;e=i(3933),n=i(6210),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new n(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},3933:function(t){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},1770:function(t){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},6210:function(t){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},1179:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;n=i(2026),e=i(9335),t.exports=function(t){function i(t,n,r,o,s,a){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==r)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(r),this.attributeType=this.stringify.dtdAttType(o),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},6347:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;n=i(2026),e=i(9335),t.exports=function(t){function i(t,n,r){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());r||(r="(#PCDATA)"),Array.isArray(r)&&(r="("+r.join(",")+")"),this.name=this.stringify.name(n),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(r)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},9078:function(t,e,i){(function(){var e,n,r,o={}.hasOwnProperty;r=i(8369).isObject,n=i(2026),e=i(9335),t.exports=function(t){function i(t,n,o,s){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!n,this.name=this.stringify.name(o),this.type=e.EntityDeclaration,r(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},4777:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;n=i(2026),e=i(9335),t.exports=function(t){function i(t,n,r){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!r.pubID&&!r.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=e.NotationDeclaration,null!=r.pubID&&(this.pubID=this.stringify.dtdPubID(r.pubID)),null!=r.sysID&&(this.sysID=this.stringify.dtdSysID(r.sysID))}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),i.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},9077:function(t,e,i){(function(){var e,n,r,o={}.hasOwnProperty;r=i(8369).isObject,n=i(2026),e=i(9335),t.exports=function(t){function i(t,n,o,s){var a;i.__super__.constructor.call(this,t),r(n)&&(n=(a=n).version,o=a.encoding,s=a.standalone),n||(n="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(n),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},6544:function(t,e,i){(function(){var e,n,r,o,s,a,h,c,u={}.hasOwnProperty;c=i(8369).isObject,h=i(2026),e=i(9335),n=i(1179),o=i(9078),r=i(6347),s=i(4777),a=i(663),t.exports=function(t){function i(t,n,r){var o,s,a,h,u,l;if(i.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(s=0,a=(h=t.children).length;s<a;s++)if((o=h[s]).type===e.Element){this.name=o.name;break}this.documentObject=t,c(n)&&(n=(u=n).pubID,r=u.sysID),null==r&&(r=(l=[n,r])[0],n=l[1]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=r&&(this.sysID=this.stringify.dtdSysID(r))}return function(t,e){for(var i in e)u.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"entities",{get:function(){var t,i,n,r,o;for(r={},i=0,n=(o=this.children).length;i<n;i++)(t=o[i]).type!==e.EntityDeclaration||t.pe||(r[t.name]=t);return new a(r)}}),Object.defineProperty(i.prototype,"notations",{get:function(){var t,i,n,r,o;for(r={},i=0,n=(o=this.children).length;i<n;i++)(t=o[i]).type===e.NotationDeclaration&&(r[t.name]=t);return new a(r)}}),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),i.prototype.element=function(t,e){var i;return i=new r(this,t,e),this.children.push(i),this},i.prototype.attList=function(t,e,i,r,o){var s;return s=new n(this,t,e,i,r,o),this.children.push(s),this},i.prototype.entity=function(t,e){var i;return i=new o(this,!1,t,e),this.children.push(i),this},i.prototype.pEntity=function(t,e){var i;return i=new o(this,!0,t,e),this.children.push(i),this},i.prototype.notation=function(t,e){var i;return i=new s(this,t,e),this.children.push(i),this},i.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},i.prototype.ele=function(t,e){return this.element(t,e)},i.prototype.att=function(t,e,i,n,r){return this.attList(t,e,i,n,r)},i.prototype.ent=function(t,e){return this.entity(t,e)},i.prototype.pent=function(t,e){return this.pEntity(t,e)},i.prototype.not=function(t,e){return this.notation(t,e)},i.prototype.up=function(){return this.root()||this.documentObject},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.name===this.name&&t.publicId===this.publicId&&t.systemId===this.systemId},i}(h)}).call(this)},6934:function(t,e,i){(function(){var e,n,r,o,s,a,h,c={}.hasOwnProperty;h=i(8369).isPlainObject,r=i(1770),n=i(383),o=i(2026),e=i(9335),a=i(5549),s=i(6434),t.exports=function(t){function i(t){i.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new n,t||(t={}),t.writer||(t.writer=new s),this.options=t,this.stringify=new a(t)}return function(t,e){for(var i in e)c.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"implementation",{value:new r}),Object.defineProperty(i.prototype,"doctype",{get:function(){var t,i,n,r;for(i=0,n=(r=this.children).length;i<n;i++)if((t=r[i]).type===e.DocType)return t;return null}}),Object.defineProperty(i.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(i.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(i.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(i.prototype,"origin",{get:function(){return null}}),Object.defineProperty(i.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(i.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(i.prototype,"contentType",{get:function(){return null}}),i.prototype.end=function(t){var e;return e={},t?h(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},i.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},i.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.renameNode=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createNodeIterator=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTreeWalker=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(o)}).call(this)},9227:function(t,e,i){(function(){var e,n,r,o,s,a,h,c,u,l,m,p,d,_,f,y,v,g,b,x,A,w,B,T={}.hasOwnProperty;B=i(8369),A=B.isObject,x=B.isFunction,w=B.isPlainObject,b=B.getValue,e=i(9335),p=i(6934),d=i(2161),o=i(6170),s=i(2096),f=i(9406),g=i(3595),_=i(9181),l=i(9077),m=i(6544),a=i(1179),c=i(9078),h=i(6347),u=i(4777),r=i(2750),v=i(5549),y=i(6434),n=i(594),t.exports=function(){function t(t,i,n){var r;this.name="?xml",this.type=e.Document,t||(t={}),r={},t.writer?w(t.writer)&&(r=t.writer,t.writer=new y):t.writer=new y,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(r),this.stringify=new v(t),this.onDataCallback=i||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var i,n,r,o,s,a,h,c;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(n in r={},h=t.attribs)T.call(h,n)&&(i=h[n],r[n]=i.value);this.node(t.name,r);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(s=0,a=(c=t.children).length;s<a;s++)o=c[s],this.createChildNode(o),o.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,i){var n;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=b(t),null==e&&(e={}),e=b(e),A(e)||(i=(n=[e,i])[0],e=n[1]),this.currentNode=new d(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=i&&this.text(i),this},t.prototype.element=function(t,i,n){var r,o,s,a,h,c;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||A(t)||x(t))for(a=this.options.noValidation,this.options.noValidation=!0,(c=new p(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,o=0,s=(h=c.children).length;o<s;o++)r=h[o],this.createChildNode(r),r.type===e.Element&&this.up();else this.node(t,i,n);return this},t.prototype.attribute=function(t,e){var i,n;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=b(t)),A(t))for(i in t)T.call(t,i)&&(n=t[i],this.attribute(i,n));else x(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new r(this,t,""):null!=e&&(this.currentNode.attribs[t]=new r(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new g(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new f(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var i,n,r,o,s;if(this.openCurrent(),null!=t&&(t=b(t)),null!=e&&(e=b(e)),Array.isArray(t))for(i=0,o=t.length;i<o;i++)n=t[i],this.instruction(n);else if(A(t))for(n in t)T.call(t,n)&&(r=t[n],this.instruction(n,r));else x(e)&&(e=e.apply()),s=new _(this,t,e),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,i){var n;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return n=new l(this,t,e,i),this.onData(this.writer.declaration(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,i){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new m(this,e,i),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var i;return this.openCurrent(),i=new h(this,t,e),this.onData(this.writer.dtdElement(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,i,n,r){var o;return this.openCurrent(),o=new a(this,t,e,i,n,r),this.onData(this.writer.dtdAttList(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var i;return this.openCurrent(),i=new c(this,!1,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var i;return this.openCurrent(),i=new c(this,!0,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var i;return this.openCurrent(),i=new u(this,t,e),this.onData(this.writer.dtdNotation(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var i,r,o,s;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),r="",t.type===e.Element){for(o in this.writerOptions.state=n.OpenTag,r=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,s=t.attribs)T.call(s,o)&&(i=s[o],r+=this.writer.attribute(i,this.writerOptions,this.currentLevel));r+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=n.InsideTag}else this.writerOptions.state=n.OpenTag,r=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?r+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(r+=' SYSTEM "'+t.sysID+'"'),t.children?(r+=" [",this.writerOptions.state=n.InsideTag):(this.writerOptions.state=n.CloseTag,r+=">"),r+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(r,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var i;if(!t.isClosed)return"",this.writerOptions.state=n.CloseTag,i=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=n.None,this.onData(i,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.dtd=function(t,e,i){return this.doctype(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},8833:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;n=i(2026),e=i(9335),t.exports=function(t){function i(t){i.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return""},i}(n)}).call(this)},2161:function(t,e,i){(function(){var e,n,r,o,s,a,h,c,u={}.hasOwnProperty;c=i(8369),h=c.isObject,a=c.isFunction,s=c.getValue,o=i(2026),e=i(9335),n=i(2750),r=i(663),t.exports=function(t){function i(t,n,r){var o,s,a,h;if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=r&&this.attribute(r),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,a=(h=t.children).length;s<a;s++)if((o=h[s]).type===e.DocType){o.name=this.name;break}}return function(t,e){for(var i in e)u.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(i.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(i.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new r(this.attribs)),this.attributeMap}}),i.prototype.clone=function(){var t,e,i,n;for(e in(i=Object.create(this)).isRoot&&(i.documentObject=null),i.attribs={},n=this.attribs)u.call(n,e)&&(t=n[e],i.attribs[e]=t.clone());return i.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=i,i.children.push(e)})),i},i.prototype.attribute=function(t,e){var i,r;if(null!=t&&(t=s(t)),h(t))for(i in t)u.call(t,i)&&(r=t[i],this.attribute(i,r));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new n(this,t,""):null!=e&&(this.attribs[t]=new n(this,t,e));return this},i.prototype.removeAttribute=function(t){var e,i,n;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(i=0,n=t.length;i<n;i++)e=t[i],delete this.attribs[e];else delete this.attribs[t];return this},i.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},i.prototype.att=function(t,e){return this.attribute(t,e)},i.prototype.a=function(t,e){return this.attribute(t,e)},i.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},i.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},i.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},i.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},i.prototype.setIdAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.isEqualNode=function(t){var e,n,r;if(!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=n=0,r=this.attribs.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},i}(o)}).call(this)},663:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},2026:function(t,e,i){(function(){var e,n,r,o,s,a,h,c,u,l,m,p,d,_,f,y,v,g={}.hasOwnProperty;v=i(8369),y=v.isObject,f=v.isFunction,_=v.isEmpty,d=v.getValue,c=null,r=null,o=null,s=null,a=null,m=null,p=null,l=null,h=null,n=null,u=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,c||(c=i(2161),r=i(6170),o=i(2096),s=i(9077),a=i(6544),m=i(9406),p=i(3595),l=i(9181),h=i(8833),n=i(9335),u=i(2390),i(663),e=i(7557))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,i,r,o;if(this.nodeType===n.Element||this.nodeType===n.DocumentFragment){for(o="",e=0,i=(r=this.children).length;e<i;e++)(t=r[e]).textContent&&(o+=t.textContent);return o}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,i,n,r,o;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),o=[],i=0,n=(r=this.children).length;i<n;i++)e=r[i],o.push(e.setParent(this));return o},t.prototype.element=function(t,e,i){var n,r,o,s,a,h,c,u,l,m,p;if(h=null,null===e&&null==i&&(e=(l=[{},null])[0],i=l[1]),null==e&&(e={}),e=d(e),y(e)||(i=(m=[e,i])[0],e=m[1]),null!=t&&(t=d(t)),Array.isArray(t))for(o=0,c=t.length;o<c;o++)r=t[o],h=this.element(r);else if(f(t))h=this.element(t.apply());else if(y(t)){for(a in t)if(g.call(t,a))if(p=t[a],f(p)&&(p=p.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))h=this.attribute(a.substr(this.stringify.convertAttKey.length),p);else if(!this.options.separateArrayItems&&Array.isArray(p)&&_(p))h=this.dummy();else if(y(p)&&_(p))h=this.element(a);else if(this.options.keepNullNodes||null!=p)if(!this.options.separateArrayItems&&Array.isArray(p))for(s=0,u=p.length;s<u;s++)r=p[s],(n={})[a]=r,h=this.element(n);else y(p)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?h=this.element(p):(h=this.element(a)).element(p):h=this.element(a,p);else h=this.dummy()}else h=this.options.keepNullNodes||null!==i?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(i):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(i):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(i):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(i):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),i):this.node(t,e,i):this.dummy();if(null==h)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return h},t.prototype.insertBefore=function(t,e,i){var n,r,o,s,a;if(null!=t?t.type:void 0)return s=e,(o=t).setParent(this),s?(r=children.indexOf(s),a=children.splice(r),children.push(o),Array.prototype.push.apply(children,a)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r),n=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,a),n},t.prototype.insertAfter=function(t,e,i){var n,r,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return r=this.parent.children.indexOf(this),o=this.parent.children.splice(r+1),n=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,o),n},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,i){var n,r;return null!=t&&(t=d(t)),e||(e={}),e=d(e),y(e)||(i=(r=[e,i])[0],e=r[1]),n=new c(this,t,e),null!=i&&n.text(i),this.children.push(n),n},t.prototype.text=function(t){var e;return y(t)&&this.element(t),e=new p(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new r(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new o(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.commentAfter=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.raw=function(t){var e;return e=new m(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new h(this)},t.prototype.instruction=function(t,e){var i,n,r,o,s;if(null!=t&&(t=d(t)),null!=e&&(e=d(e)),Array.isArray(t))for(o=0,s=t.length;o<s;o++)i=t[o],this.instruction(i);else if(y(t))for(i in t)g.call(t,i)&&(n=t[i],this.instruction(i,n));else f(e)&&(e=e.apply()),r=new l(this,t,e),this.children.push(r);return this},t.prototype.instructionBefore=function(t,e){var i,n;return i=this.parent.children.indexOf(this),n=this.parent.children.splice(i),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.instructionAfter=function(t,e){var i,n;return i=this.parent.children.indexOf(this),n=this.parent.children.splice(i+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.declaration=function(t,e,i){var r,o;return r=this.document(),o=new s(r,t,e,i),0===r.children.length?r.children.unshift(o):r.children[0].type===n.Declaration?r.children[0]=o:r.children.unshift(o),r.root()||r},t.prototype.dtd=function(t,e){var i,r,o,s,h,c,u,l,m;for(i=this.document(),r=new a(i,t,e),o=s=0,c=(l=i.children).length;s<c;o=++s)if(l[o].type===n.DocType)return i.children[o]=r,r;for(o=h=0,u=(m=i.children).length;h<u;o=++h)if(m[o].isRoot)return i.children.splice(o,0,r),r;return i.children.push(r),r},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===n.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===n.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,i;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(i=this.parent)?i.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,i){return this.element(t,e,i)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var i,n;return(i=this)===t?0:this.document()!==t.document()?(n=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?n|=e.Preceding:n|=e.Following,n):i.isAncestor(t)?e.Contains|e.Preceding:i.isDescendant(t)?e.Contains|e.Following:i.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,i,n;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=i=0,n=this.children.length-1;0<=n?i<=n:i>=n;e=0<=n?++i:--i)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,i,n,r;for(i=0,n=(r=this.children).length;i<n;i++){if(t===(e=r[i]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e<i},t.prototype.isFollowing=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e>i},t.prototype.treePosition=function(t){var e,i;return i=0,e=!1,this.foreachTreeNode(this.document(),(function(n){if(i++,!e&&n===t)return e=!0})),e?i:-1},t.prototype.foreachTreeNode=function(t,e){var i,n,r,o,s;for(t||(t=this.document()),n=0,r=(o=t.children).length;n<r;n++){if(s=e(i=o[n]))return s;if(s=this.foreachTreeNode(i,e))return s}},t}()}).call(this)},2390:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},9181:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;e=i(9335),n=i(6488),t.exports=function(t){function i(t,n,r){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,r&&(this.value=this.stringify.insValue(r))}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},i}(n)}).call(this)},9406:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;e=i(9335),n=i(2026),t.exports=function(t){function i(t,n){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(n)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},i}(n)}).call(this)},1996:function(t,e,i){(function(){var e,n,r,o={}.hasOwnProperty;e=i(9335),r=i(751),n=i(594),t.exports=function(t){function i(t,e){this.stream=t,i.__super__.constructor.call(this,e)}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),i.prototype.endline=function(t,e,r){return t.isLastRootNode&&e.state===n.CloseTag?"":i.__super__.endline.call(this,t,e,r)},i.prototype.document=function(t,e){var i,n,r,o,s,a,h,c,u;for(n=r=0,s=(h=t.children).length;r<s;n=++r)(i=h[n]).isLastRootNode=n===t.children.length-1;for(e=this.filterOptions(e),u=[],o=0,a=(c=t.children).length;o<a;o++)i=c[o],u.push(this.writeChildNode(i,e,0));return u},i.prototype.attribute=function(t,e,n){return this.stream.write(i.__super__.attribute.call(this,t,e,n))},i.prototype.cdata=function(t,e,n){return this.stream.write(i.__super__.cdata.call(this,t,e,n))},i.prototype.comment=function(t,e,n){return this.stream.write(i.__super__.comment.call(this,t,e,n))},i.prototype.declaration=function(t,e,n){return this.stream.write(i.__super__.declaration.call(this,t,e,n))},i.prototype.docType=function(t,e,i){var r,o,s,a;if(i||(i=0),this.openNode(t,e,i),e.state=n.OpenTag,this.stream.write(this.indent(t,e,i)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,i)),e.state=n.InsideTag,o=0,s=(a=t.children).length;o<s;o++)r=a[o],this.writeChildNode(r,e,i+1);e.state=n.CloseTag,this.stream.write("]")}return e.state=n.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,i)),e.state=n.None,this.closeNode(t,e,i)},i.prototype.element=function(t,i,r){var s,a,h,c,u,l,m,p,d;for(m in r||(r=0),this.openNode(t,i,r),i.state=n.OpenTag,this.stream.write(this.indent(t,i,r)+"<"+t.name),p=t.attribs)o.call(p,m)&&(s=p[m],this.attribute(s,i,r));if(c=0===(h=t.children.length)?null:t.children[0],0===h||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(this.stream.write(">"),i.state=n.CloseTag,this.stream.write("</"+t.name+">")):(i.state=n.CloseTag,this.stream.write(i.spaceBeforeSlash+"/>"));else if(!i.pretty||1!==h||c.type!==e.Text&&c.type!==e.Raw||null==c.value){for(this.stream.write(">"+this.endline(t,i,r)),i.state=n.InsideTag,u=0,l=(d=t.children).length;u<l;u++)a=d[u],this.writeChildNode(a,i,r+1);i.state=n.CloseTag,this.stream.write(this.indent(t,i,r)+"</"+t.name+">")}else this.stream.write(">"),i.state=n.InsideTag,i.suppressPrettyCount++,this.writeChildNode(c,i,r+1),i.suppressPrettyCount--,i.state=n.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,i,r)),i.state=n.None,this.closeNode(t,i,r)},i.prototype.processingInstruction=function(t,e,n){return this.stream.write(i.__super__.processingInstruction.call(this,t,e,n))},i.prototype.raw=function(t,e,n){return this.stream.write(i.__super__.raw.call(this,t,e,n))},i.prototype.text=function(t,e,n){return this.stream.write(i.__super__.text.call(this,t,e,n))},i.prototype.dtdAttList=function(t,e,n){return this.stream.write(i.__super__.dtdAttList.call(this,t,e,n))},i.prototype.dtdElement=function(t,e,n){return this.stream.write(i.__super__.dtdElement.call(this,t,e,n))},i.prototype.dtdEntity=function(t,e,n){return this.stream.write(i.__super__.dtdEntity.call(this,t,e,n))},i.prototype.dtdNotation=function(t,e,n){return this.stream.write(i.__super__.dtdNotation.call(this,t,e,n))},i}(r)}).call(this)},6434:function(t,e,i){(function(){var e,n={}.hasOwnProperty;e=i(751),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var i,n,r,o,s;for(e=this.filterOptions(e),o="",n=0,r=(s=t.children).length;n<r;n++)i=s[n],o+=this.writeChildNode(i,e,0);return e.pretty&&o.slice(-e.newline.length)===e.newline&&(o=o.slice(0,-e.newline.length)),o},e}(e)}).call(this)},5549:function(t){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty;t.exports=function(){function t(t){var n,r,o;for(n in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),r=t.stringify||{})i.call(r,n)&&(o=r[n],this[n]=o)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,i;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+i.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+i.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},3595:function(t,e,i){(function(){var e,n,r={}.hasOwnProperty;e=i(9335),n=i(6488),t.exports=function(t){function i(t,n){if(i.__super__.constructor.call(this,t),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(n)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"wholeText",{get:function(){var t,e,i;for(i="",e=this.previousSibling;e;)i=e.data+i,e=e.previousSibling;for(i+=this.data,t=this.nextSibling;t;)i+=t.data,t=t.nextSibling;return i}}),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},i.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(n)}).call(this)},751:function(t,e,i){(function(){var e,n,r,o={}.hasOwnProperty;r=i(8369).assign,e=i(9335),i(9077),i(6544),i(6170),i(2096),i(2161),i(9406),i(3595),i(9181),i(8833),i(1179),i(6347),i(9078),i(4777),n=i(594),t.exports=function(){function t(t){var e,i,n;for(e in t||(t={}),this.options=t,i=t.writer||{})o.call(i,e)&&(n=i[e],this["_"+e]=this[e],this[e]=n)}return t.prototype.filterOptions=function(t){var e,i,o,s,a,h,c,u;return t||(t={}),t=r({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(i=t.indent)?i:"  ",e.newline=null!=(o=t.newline)?o:"\n",e.offset=null!=(s=t.offset)?s:0,e.dontPrettyTextNodes=null!=(a=null!=(h=t.dontPrettyTextNodes)?h:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(c=null!=(u=t.spaceBeforeSlash)?u:t.spacebeforeslash)?c:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=n.None,e},t.prototype.indent=function(t,e,i){var n;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(n=(i||0)+e.offset+1)>0?new Array(n).join(e.indent):""},t.prototype.endline=function(t,e,i){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,i){var n;return this.openAttribute(t,e,i),n=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,i),n},t.prototype.cdata=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<![CDATA[",e.state=n.InsideTag,r+=t.value,e.state=n.CloseTag,r+="]]>"+this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.comment=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"\x3c!-- ",e.state=n.InsideTag,r+=t.value,e.state=n.CloseTag,r+=" --\x3e"+this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.declaration=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<?xml",e.state=n.InsideTag,r+=' version="'+t.version+'"',null!=t.encoding&&(r+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(r+=' standalone="'+t.standalone+'"'),e.state=n.CloseTag,r+=e.spaceBeforeSlash+"?>",r+=this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.docType=function(t,e,i){var r,o,s,a,h;if(i||(i=0),this.openNode(t,e,i),e.state=n.OpenTag,a=this.indent(t,e,i),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,i),e.state=n.InsideTag,o=0,s=(h=t.children).length;o<s;o++)r=h[o],a+=this.writeChildNode(r,e,i+1);e.state=n.CloseTag,a+="]"}return e.state=n.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),a},t.prototype.element=function(t,i,r){var s,a,h,c,u,l,m,p,d,_,f,y,v,g;for(d in r||(r=0),_=!1,f="",this.openNode(t,i,r),i.state=n.OpenTag,f+=this.indent(t,i,r)+"<"+t.name,y=t.attribs)o.call(y,d)&&(s=y[d],f+=this.attribute(s,i,r));if(c=0===(h=t.children.length)?null:t.children[0],0===h||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(f+=">",i.state=n.CloseTag,f+="</"+t.name+">"+this.endline(t,i,r)):(i.state=n.CloseTag,f+=i.spaceBeforeSlash+"/>"+this.endline(t,i,r));else if(!i.pretty||1!==h||c.type!==e.Text&&c.type!==e.Raw||null==c.value){if(i.dontPrettyTextNodes)for(u=0,m=(v=t.children).length;u<m;u++)if(((a=v[u]).type===e.Text||a.type===e.Raw)&&null!=a.value){i.suppressPrettyCount++,_=!0;break}for(f+=">"+this.endline(t,i,r),i.state=n.InsideTag,l=0,p=(g=t.children).length;l<p;l++)a=g[l],f+=this.writeChildNode(a,i,r+1);i.state=n.CloseTag,f+=this.indent(t,i,r)+"</"+t.name+">",_&&i.suppressPrettyCount--,f+=this.endline(t,i,r),i.state=n.None}else f+=">",i.state=n.InsideTag,i.suppressPrettyCount++,_=!0,f+=this.writeChildNode(c,i,r+1),i.suppressPrettyCount--,_=!1,i.state=n.CloseTag,f+="</"+t.name+">"+this.endline(t,i,r);return this.closeNode(t,i,r),f},t.prototype.writeChildNode=function(t,i,n){switch(t.type){case e.CData:return this.cdata(t,i,n);case e.Comment:return this.comment(t,i,n);case e.Element:return this.element(t,i,n);case e.Raw:return this.raw(t,i,n);case e.Text:return this.text(t,i,n);case e.ProcessingInstruction:return this.processingInstruction(t,i,n);case e.Dummy:return"";case e.Declaration:return this.declaration(t,i,n);case e.DocType:return this.docType(t,i,n);case e.AttributeDeclaration:return this.dtdAttList(t,i,n);case e.ElementDeclaration:return this.dtdElement(t,i,n);case e.EntityDeclaration:return this.dtdEntity(t,i,n);case e.NotationDeclaration:return this.dtdNotation(t,i,n);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<?",e.state=n.InsideTag,r+=t.target,t.value&&(r+=" "+t.value),e.state=n.CloseTag,r+=e.spaceBeforeSlash+"?>",r+=this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.raw=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i),e.state=n.InsideTag,r+=t.value,e.state=n.CloseTag,r+=this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.text=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i),e.state=n.InsideTag,r+=t.value,e.state=n.CloseTag,r+=this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.dtdAttList=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<!ATTLIST",e.state=n.InsideTag,r+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(r+=" "+t.defaultValueType),t.defaultValue&&(r+=' "'+t.defaultValue+'"'),e.state=n.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.dtdElement=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<!ELEMENT",e.state=n.InsideTag,r+=" "+t.name+" "+t.value,e.state=n.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.dtdEntity=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<!ENTITY",e.state=n.InsideTag,t.pe&&(r+=" %"),r+=" "+t.name,t.value?r+=' "'+t.value+'"':(t.pubID&&t.sysID?r+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(r+=' SYSTEM "'+t.sysID+'"'),t.nData&&(r+=" NDATA "+t.nData)),e.state=n.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.dtdNotation=function(t,e,i){var r;return this.openNode(t,e,i),e.state=n.OpenTag,r=this.indent(t,e,i)+"<!NOTATION",e.state=n.InsideTag,r+=" "+t.name,t.pubID&&t.sysID?r+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?r+=' PUBLIC "'+t.pubID+'"':t.sysID&&(r+=' SYSTEM "'+t.sysID+'"'),e.state=n.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=n.None,this.closeNode(t,e,i),r},t.prototype.openNode=function(t,e,i){},t.prototype.closeNode=function(t,e,i){},t.prototype.openAttribute=function(t,e,i){},t.prototype.closeAttribute=function(t,e,i){},t}()}).call(this)},5532:function(t,e,i){(function(){var e,n,r,o,s,a,h,c,u,l;l=i(8369),c=l.assign,u=l.isFunction,r=i(1770),o=i(6934),s=i(9227),h=i(6434),a=i(1996),e=i(9335),n=i(594),t.exports.create=function(t,e,i,n){var r,s;if(null==t)throw new Error("Root element needs a name.");return n=c({},e,i,n),s=(r=new o(n)).element(t),n.headless||(r.declaration(n),null==n.pubID&&null==n.sysID||r.dtd(n)),s},t.exports.begin=function(t,e,i){var n;return u(t)&&(e=(n=[t,e])[0],i=n[1],t={}),e?new s(t,e,i):new o(t)},t.exports.stringWriter=function(t){return new h(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new r,t.exports.nodeType=e,t.exports.writerState=n}).call(this)},1758:()=>{}},e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";var t=i(3875);function e(t){var e;let i=null===(e=t.match(/[\+\-]?\d*[\d\.](?:\d+)?/g))||void 0===e?void 0:e.map(parseFloat);return void 0===i?[]:i}function n(t){if("MLT".includes(t.toLocaleUpperCase()))return 2;if("HV".includes(t.toLocaleUpperCase()))return 1;if("C".includes(t.toLocaleUpperCase()))return 6;if("SQ".includes(t.toLocaleUpperCase()))return 4;if("A".includes(t.toLocaleUpperCase()))return 7;if("Z".includes(t.toLocaleUpperCase()))return 0;throw new Error("Invalid command letter")}function r(t){return"M"===t?"L":"m"===t?"l":t}function o(t){return t===t.toLowerCase()}function s(e,i){let n;switch(e.letter){case"L":case"l":n=(0,t.Vec2)(e.parameters[0],e.parameters[1]);break;case"H":n=(0,t.Vec2)(e.parameters[0],i.y);break;case"h":n=(0,t.Vec2)(e.parameters[0],0);break;case"V":n=(0,t.Vec2)(i.x,e.parameters[0]);break;case"v":n=(0,t.Vec2)(0,e.parameters[0])}return o(e.letter)&&n.add(i),n}function a(i,n){if("transform"!==n)return i;try{return function(i){const n=`Unexpected value '${i}' for transform attribute`;let r=i.match(/([a-zA-Z]+\s*\([^\)]+\))/g);if(null===r)throw new Error(n);return r.map((t=>{let i=t.match(/([a-zA-Z]+)\s*\(([^\)]+)\)/);if(null===i)throw new Error(n);const[r,o,s]=i;return{name:o,params:e(s)}})).map((({name:e,params:i})=>{switch(e){case"matrix":return function(e){if(6!==e.length)throw new Error(n);const[i,r,o,s,a,h]=[...e];return new t.Mat33((0,t.Vec3)(i,r,0),(0,t.Vec3)(o,s,0),(0,t.Vec3)(a,h,1))}(i);case"translate":return function(e){var i;if(1!==e.length&&2!==e.length)throw new Error(n);return new t.Mat33((0,t.Vec3)(1,0,0),(0,t.Vec3)(0,1,0),(0,t.Vec3)(e[0],null!==(i=e[1])&&void 0!==i?i:0,1))}(i);case"rotate":return function(e){if(1!==e.length&&3!==e.length)throw new Error(n);const[i,r,o]=[...e],s=i*Math.PI/180;return new t.Mat33((0,t.Vec3)(Math.cos(s),Math.sin(s),0),(0,t.Vec3)(-Math.sin(s),Math.cos(s),0),void 0===r?(0,t.Vec3)(0,0,1):(0,t.Vec3)(-r*Math.cos(s)+o*Math.sin(s)+r,-r*Math.sin(s)-o*Math.cos(s)+o,1))}(i);case"scale":return function(e){var i;if(1!==e.length&&2!==e.length)throw new Error(n);return new t.Mat33((0,t.Vec3)(e[0],0,0),(0,t.Vec3)(0,null!==(i=e[1])&&void 0!==i?i:e[0],0),(0,t.Vec3)(0,0,1))}(i);case"skewX":return function(e){if(1!==e.length)throw new Error(n);const i=e[0]*Math.PI/180;return new t.Mat33((0,t.Vec3)(1,0,0),(0,t.Vec3)(Math.tan(i),1,0),(0,t.Vec3)(0,0,1))}(i);case"skewY":return function(e){if(1!==e.length)throw new Error(n);const i=e[0]*Math.PI/180;return new t.Mat33((0,t.Vec3)(1,Math.tan(i),0),(0,t.Vec3)(0,1,0),(0,t.Vec3)(0,0,1))}(i);default:throw new Error(n)}}))}(i)}catch(e){return console.warn(e.message),t.Transform.identity()}}function h(i,n){if("points"!==n)return i;const r=e(i),o=[];for(let e=1;e<r.length;e+=2)o.push((0,t.Vec2)(r[e-1],r[e]));return o}function c(e,i){const{ex:{x:n,y:r},ey:{x:o,y:s},ez:{x:a,y:h}}=e,{ex:{x:c,y:u},ey:{x:l,y:m},ez:{x:p,y:d}}=i;return new t.Mat33((0,t.Vec3)(n*c+o*u,r*c+s*u,0),(0,t.Vec3)(n*l+o*m,r*l+s*m,0),(0,t.Vec3)(n*p+o*d+a,r*p+s*d+h,1))}function u(t,e){return"transform"!==e?t:t.reduce(c)}function l(t,i){if("d"!==i)return t;try{return function(t){let i=[],o=t.match(/[MmLlHhVvCcSsQqTtAaZz][^MmLlHhVvCcSsQqTtAaZz]*/g);if(!o)return[];try{for(let t of o){let o=t[0],s=e(t.substr(1));if(0===s.length){if(0===n(o)){i.push({letter:o,parameters:[]});continue}break}for(;s.length>=n(o);)i.push({letter:o,parameters:s.slice(0,n(o))}),o=r(o),s=s.slice(n(o));if(0!==s.length)break}}catch(t){}return i}(t)}catch(t){return console.warn(t.message),[]}}function m(e,i){if("d"!==i)return e;try{return function(e){let i=[],n=e.shift();if("M"!==(null==n?void 0:n.letter)&&"m"!==(null==n?void 0:n.letter))return[];let r=(0,t.Vec2)(n.parameters[0],n.parameters[1]),a=r,h=r,c=r;for(let n of e){let e,u;switch(n.letter){case"M":case"m":e=(0,t.Vec2)(n.parameters[0],n.parameters[1]),o(n.letter)&&e.add(r),r=e,a=e,h=e,c=e;break;case"L":case"l":case"H":case"h":case"V":case"v":e=s(n,r),i.push({type:"Line",startingPoint:t.Vec2.clone(r),endPoint:e}),r=e,a=e,h=e;break;case"C":case"c":a=(0,t.Vec2)(n.parameters[0],n.parameters[1]),o(n.letter)&&a.add(r),n.parameters=n.parameters.slice(2);case"S":case"s":u=(0,t.Vec2)(n.parameters[0],n.parameters[1]),e=(0,t.Vec2)(n.parameters[2],n.parameters[3]),o(n.letter)&&(u.add(r),e.add(r)),i.push({type:"CubicBezierCurve",startingPoint:r,startControlPoint:a,endControlPoint:u,endPoint:e}),r=e,a=t.Vec2.combine(2,e,-1,a),h=e;break;case"Q":case"q":h=(0,t.Vec2)(n.parameters[0],n.parameters[1]),o(n.letter)&&h.add(r),n.parameters=n.parameters.slice(2);case"T":case"t":e=(0,t.Vec2)(n.parameters[0],n.parameters[1]),o(n.letter)&&e.add(r),i.push({type:"QuadraticBezierCurve",startingPoint:r,controlPoint:h,endPoint:e}),r=e,a=e,h=t.Vec2.combine(2,e,-1,h);break;case"A":case"a":e=(0,t.Vec2)(n.parameters[5],n.parameters[6]),o(n.letter)&&e.add(r),i.push({type:"EllipticalArcCurve",startingPoint:r,rx:n.parameters[0],ry:n.parameters[1],angle:n.parameters[2],largeArcFlag:n.parameters[3],sweepFlag:n.parameters[4],endPoint:e}),r=e,a=e,h=e;break;case"Z":case"z":i.push({type:"Line",startingPoint:t.Vec2.clone(r),endPoint:c}),r=c,a=c,h=c}}return i}(e)}catch(t){return console.warn(t.message),[]}}function p(t){return["circle","ellipse","line","path","polygon","polyline","rect"].includes(t["#name"].toLowerCase())}function d(t,e){return e>=0?t:2*Math.PI-t}function _(e,i){switch(e["#name"].toLowerCase()){case"circle":return function(e,i){var n,r,o,s,a,h;let c=(0,t.Vec2)(null!==(r=null===(n=e.$)||void 0===n?void 0:n.cx)&&void 0!==r?r:0,null!==(s=null===(o=e.$)||void 0===o?void 0:o.cy)&&void 0!==s?s:0);return c=[i,e.$.transform,c].filter((t=>t)).reduce(t.Transform.mul),[(0,t.Circle)(c,null!==(h=null===(a=e.$)||void 0===a?void 0:a.r)&&void 0!==h?h:0)]}(e,i);case"ellipse":return function(e,i){var n,r,o,s;let a=(0,t.Vec2)(null!==(r=null===(n=e.$)||void 0===n?void 0:n.cx)&&void 0!==r?r:0,null!==(s=null===(o=e.$)||void 0===o?void 0:o.cy)&&void 0!==s?s:0),h=a=[i,e.$.transform,(0,t.Transform)(a,0)].filter((t=>t)).reduce(t.Transform.mul),c=Array(12).fill(0).map(((t,e)=>e/12*2*Math.PI)).map((i=>{var n,r,o,s,a,h,c,u;return(0,t.Vec2)(Math.cos(i)*(null!==(s=null!==(r=null===(n=e.$)||void 0===n?void 0:n.rx)&&void 0!==r?r:null===(o=e.$)||void 0===o?void 0:o.ry)&&void 0!==s?s:0),Math.sin(i)*(null!==(u=null!==(h=null===(a=e.$)||void 0===a?void 0:a.ry)&&void 0!==h?h:null===(c=e.$)||void 0===c?void 0:c.rx)&&void 0!==u?u:0))})).map((e=>t.Transform.mul(h,e)));return[(0,t.Polygon)(c)]}(e,i);case"line":return function(e,i){var n,r,o,s,a,h,c,u;let l=(0,t.Vec2)(null!==(r=null===(n=e.$)||void 0===n?void 0:n.x1)&&void 0!==r?r:0,null!==(s=null===(o=e.$)||void 0===o?void 0:o.y1)&&void 0!==s?s:0),m=(0,t.Vec2)(null!==(h=null===(a=e.$)||void 0===a?void 0:a.x2)&&void 0!==h?h:0,null!==(u=null===(c=e.$)||void 0===c?void 0:c.y2)&&void 0!==u?u:0);return l=[i,e.$.transform,l].filter((t=>t)).reduce(t.Transform.mul),m=[i,e.$.transform,m].filter((t=>t)).reduce(t.Transform.mul),[(0,t.Edge)(l,m)]}(e,i);case"path":return function(e,i){var n;if(i=[i,e.$.transform,t.Transform.identity()].filter((t=>t)).reduce(t.Transform.mul),!(null===(n=e.$)||void 0===n?void 0:n.d))return[];for(let n of e.$.d)switch(n.startingPoint=t.Transform.mul(i,n.startingPoint),n.endPoint=t.Transform.mul(i,n.endPoint),n.type){case"CubicBezierCurve":n.startControlPoint=t.Transform.mul(i,n.startControlPoint),n.endControlPoint=t.Transform.mul(i,n.endControlPoint);break;case"QuadraticBezierCurve":n.controlPoint=t.Transform.mul(i,n.controlPoint);break;case"EllipticalArcCurve":console.warn("Elliptical arc curves are not supported")}return e.$.d.map((e=>{switch(e.type){case"Line":return function(e){return(0,t.Edge)(e.startingPoint,e.endPoint)}(e);case"QuadraticBezierCurve":return i=e,(0,t.Chain)(Array(7).fill(0).map(((t,e)=>e/6)).map((e=>t.Vec2.combine(1-e,t.Vec2.combine(1-e,i.startingPoint,e,i.controlPoint),e,t.Vec2.combine(1-e,i.controlPoint,e,i.endPoint)))));case"CubicBezierCurve":return function(e){return(0,t.Chain)(Array(7).fill(0).map(((t,e)=>e/6)).map((i=>t.Vec2.combine(1-i,t.Vec2.combine(1-i,t.Vec2.combine(1-i,e.startingPoint,i,e.startControlPoint),i,t.Vec2.combine(1-i,e.startControlPoint,i,e.endControlPoint)),i,t.Vec2.combine(1-i,t.Vec2.combine(1-i,e.startControlPoint,i,e.endControlPoint),i,t.Vec2.combine(1-i,e.endControlPoint,i,e.endPoint))))))}(e);case"EllipticalArcCurve":return(0,t.Chain)([])}var i}))}(e,i);case"polygon":return function(e,i){var n,r;let o=null!==(r=null===(n=e.$)||void 0===n?void 0:n.points)&&void 0!==r?r:[];return o=o.map((n=>[i,e.$.transform,n].filter((t=>t)).reduce(t.Transform.mul))),[(0,t.Polygon)(o)]}(e,i);case"polyline":return function(e,i){var n,r;let o=null!==(r=null===(n=e.$)||void 0===n?void 0:n.points)&&void 0!==r?r:[];return o=o.map((n=>[i,e.$.transform,n].filter((t=>t)).reduce(t.Transform.mul))),[(0,t.Chain)(o)]}(e,i);case"rect":return function(e,i){var n,r;let o=(0,t.Vec2)((null!==(n=e.$.x)&&void 0!==n?n:0)+e.$.width/2,(null!==(r=e.$.y)&&void 0!==r?r:0)+e.$.height/2);const s=[i,e.$.transform].filter((t=>t)).reduce(t.Transform.mul,t.Transform.identity());o=t.Transform.mul(s,o);let a=d(Math.acos(s.q.c),Math.asin(s.q.s));return[(0,t.Box)(e.$.width,e.$.height,o,a)]}(e,i);default:throw new Error(`<${e["#name"]}> tag can not be converted to a shape`)}}var f=i(5055);function y(e){const{ex:{x:i,y:n},ey:{x:r,y:o},ez:{x:s,y:a}}=e,h=i*o-n*r;if(0===Math.abs(h))throw new Error("Invalid transforma because the matrix does not have full rank");const u=Math.hypot(i,n),l=d(Math.acos(i/u),Math.asin(n/u)),m=(0,t.Transform)((0,t.Vec2)(s,a),l),p=c(new t.Mat33((0,t.Vec3)(Math.cos(l),-Math.sin(l),0),(0,t.Vec3)(Math.sin(l),Math.cos(l),0),(0,t.Vec3)(-a*Math.sin(l)-s*Math.cos(l),-a*Math.cos(l)+s*Math.sin(l),1)),e);return{transform:m,overhang:v(p)?null:p}}function v(t){const{ex:{x:e,y:i},ey:{x:n,y:r},ez:{x:o,y:s}}=t;return[e-1,i,n,r-1,o,s].every((t=>Math.abs(t)<.001))}function g(e,i){const n=t.Mat33.mulVec3(e,(0,t.Vec3)(i.x,i.y,1));return(0,t.Vec2)(n.x,n.y)}function b(e,i){var n;if(p(e))!function(e,i){if(!i)return;e.$||(e.$={}),e.$.transform&&(i=c(i,e.$.transform));const{transform:n,overhang:r}=y(i);if(e.$.transform=n,r)switch(e["#name"].toLowerCase()){case"rect":!function(e){var i,n;e["#name"]="polygon";const r=e.$.width/2,o=e.$.height/2,s=(null!==(i=e.$.x)&&void 0!==i?i:0)+r,a=(null!==(n=e.$.y)&&void 0!==n?n:0)+o;e.$.points=[(0,t.Vec2)(s+r,a-o),(0,t.Vec2)(s+r,a+o),(0,t.Vec2)(s-r,a+o),(0,t.Vec2)(s-r,a-o)]}(e);case"polygon":case"polyline":e.$.points&&(e.$.points=e.$.points.map((t=>g(r,t))));break;case"circle":!function(t){t["#name"]="ellipse",t.$.rx=t.$.r,t.$.ry=t.$.r}(e);case"ellipse":!function(e,i){var n,r,o,s,a,h;const c=t.Mat33.mulVec3(i,(0,t.Vec3)(null!==(n=e.$.cx)&&void 0!==n?n:0,null!==(r=e.$.cy)&&void 0!==r?r:0,1));i.ex.mul(null!==(s=null!==(o=e.$.rx)&&void 0!==o?o:e.$.ry)&&void 0!==s?s:0),i.ey.mul(null!==(h=null!==(a=e.$.ry)&&void 0!==a?a:e.$.rx)&&void 0!==h?h:0);const u=2*t.Vec3.dot(i.ex,i.ey)/(t.Vec3.dot(i.ex,i.ex)-t.Vec3.dot(i.ey,i.ey)),l=Number.isNaN(u)?0:Math.atan(u)/2,m=e=>t.Vec3.add(t.Vec3.mul(i.ex,Math.cos(e)),t.Vec3.mul(i.ey,Math.sin(e))),p=m(l);e.$.rx=Math.hypot(p.x,p.y);const _=m(l+Math.PI/2);e.$.ry=Math.hypot(_.x,_.y);const f=Math.hypot(p.x,p.y),y=0!==f?d(Math.acos(p.x/f),Math.asin(p.y/f)):0;e.$.transform=t.Transform.mul(e.$.transform,(0,t.Transform)((0,t.Vec2)(c.x,c.y),y)),e.$.cx=0,e.$.cy=0}(e,r),function(t){Math.abs(t.$.rx-t.$.ry)<.001&&(t["#name"]="circle",t.$.r=t.$.rx)}(e);break;case"line":!function(e,i){var n,r,o,s;const a=t.Mat33.mul(i,(0,t.Vec2)(null!==(n=e.$.x1)&&void 0!==n?n:0,null!==(r=e.$.y1)&&void 0!==r?r:0)),h=t.Mat33.mul(i,(0,t.Vec2)(null!==(o=e.$.x2)&&void 0!==o?o:0,null!==(s=e.$.y2)&&void 0!==s?s:0));e.$.x1=a.x,e.$.y1=a.y,e.$.x2=h.x,e.$.y2=h.y}(e,r);break;case"path":!function(t,e){if(t.$.d)for(let i of t.$.d)switch(i.startingPoint=g(e,i.startingPoint),i.endPoint=g(e,i.endPoint),i.type){case"CubicBezierCurve":i.startControlPoint=g(e,i.startControlPoint),i.endControlPoint=g(e,i.endControlPoint);break;case"QuadraticBezierCurve":i.controlPoint=g(e,i.controlPoint);break;case"EllipticalArcCurve":console.warn("Elliptical arc curves are not supported")}}(e,r);break;default:throw new Error(`<${e["#name"]}> tag is not supported`)}}(e,i);else if(e.$$){if(null===(n=e.$)||void 0===n?void 0:n.transform){let t=e.$.transform;i&&(t=c(i,t));const n=y(t);e.$.transform=n.transform,i=n.overhang}for(let t of e.$$)b(t,i)}}function x(e,i,n){var r;if(p(e)){let t=i.createBody({position:n.p,angle:n.q.getAngle()});for(let i of _(e))t.createFixture(i)}else if(e.$$){(null===(r=e.$)||void 0===r?void 0:r.transform)&&(n=t.Transform.mul(n,e.$.transform));for(let t of e.$$)x(t,i,n)}return i}async function A(e,i){var n,r,o;const s=await async function(e,i){var n,r,o;let s=await(0,f.parseStringPromise)(e,Object.assign(Object.assign({},i),{attrkey:"$",explicitChildren:!0,preserveChildrenOrder:!0,explicitRoot:!1,attrValueProcessors:[a,u,h,l,m,f.processors.parseNumbers,...null!==(n=i.attrNameProcessors)&&void 0!==n?n:[]]}));const c=null!==(r=i.meterPerPixelRatio)&&void 0!==r?r:1,p=null!==(o=i.scaleY)&&void 0!==o?o:1;return b(s,1!==c||1!==p?new t.Mat33((0,t.Vec3)(c,0,0),(0,t.Vec3)(0,c*p,0),(0,t.Vec3)(0,0,1)):null),s}(e,{meterPerPixelRatio:i,scaleY:1});if("svg"!==s["#name"].toLowerCase())throw new Error("Root element is no svg element");const c=x(s,(0,t.World)(),t.Transform.identity());return{viewBox:null===(o=null===(r=null===(n=s.$)||void 0===n?void 0:n.viewBox)||void 0===r?void 0:r.match(/[\+\-]?\d+(?:\.\d+)?/g))||void 0===o?void 0:o.map(parseFloat),meterPerPixelRatio:i,world:c}}const w=self;let B=null;w.addEventListener("message",(({data:e})=>{B=e,async function(){if(!T){for(T=!0;B;){const{svgContent:e,scale:i}=B;B=null;try{const n=await A(e,i);w.postMessage({world:Object.assign(Object.assign({},n),{world:t.Serializer.toJson(n.world)}),error:null})}catch(t){w.postMessage({world:null,error:t})}}T=!1}}()}));let T=!1})()})();
//# sourceMappingURL=buildWorld.worker.js.map