/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={7025:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i,n,r,s,a,h,c=o.Vec2(null!==(n=null===(i=t.$)||void 0===i?void 0:i.cx)&&void 0!==n?n:0,null!==(s=null===(r=t.$)||void 0===r?void 0:r.cy)&&void 0!==s?s:0);return c=[e,t.$.transform,c].filter((function(t){return t})).reduce(o.Transform.mul),[o.Circle(c,null!==(h=null===(a=t.$)||void 0===a?void 0:a.r)&&void 0!==h?h:0)]}},6113:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i,n,r,s,a=o.Vec2(null!==(n=null===(i=t.$)||void 0===i?void 0:i.cx)&&void 0!==n?n:0,null!==(s=null===(r=t.$)||void 0===r?void 0:r.cy)&&void 0!==s?s:0),h=a=[e,t.$.transform,o.Transform(a,0)].filter((function(t){return t})).reduce(o.Transform.mul),c=Array(12).fill(0).map((function(t,e){return e/12*2*Math.PI})).map((function(e){var i,n,r,s,a,h,c,u;return o.Vec2(Math.cos(e)*(null!==(s=null!==(n=null===(i=t.$)||void 0===i?void 0:i.rx)&&void 0!==n?n:null===(r=t.$)||void 0===r?void 0:r.ry)&&void 0!==s?s:0),Math.sin(e)*(null!==(u=null!==(h=null===(a=t.$)||void 0===a?void 0:a.ry)&&void 0!==h?h:null===(c=t.$)||void 0===c?void 0:c.rx)&&void 0!==u?u:0))})).map((function(t){return o.Transform.mul(h,t)}));return[o.Polygon(c)]}},4165:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i,n,r,s,a,h,c,u,l=o.Vec2(null!==(n=null===(i=t.$)||void 0===i?void 0:i.x1)&&void 0!==n?n:0,null!==(s=null===(r=t.$)||void 0===r?void 0:r.y1)&&void 0!==s?s:0),m=o.Vec2(null!==(h=null===(a=t.$)||void 0===a?void 0:a.x2)&&void 0!==h?h:0,null!==(u=null===(c=t.$)||void 0===c?void 0:c.y2)&&void 0!==u?u:0);return l=[e,t.$.transform,l].filter((function(t){return t})).reduce(o.Transform.mul),m=[e,t.$.transform,m].filter((function(t){return t})).reduce(o.Transform.mul),[o.Edge(l,m)]}},2824:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i;if(e=[e,t.$.transform,o.Transform.identity()].filter((function(t){return t})).reduce(o.Transform.mul),!(null===(i=t.$)||void 0===i?void 0:i.d))return[];for(var n=0,r=t.$.d;n<r.length;n++){var s=r[n];switch(s.startingPoint=o.Transform.mul(e,s.startingPoint),s.endPoint=o.Transform.mul(e,s.endPoint),s.type){case"CubicBezierCurve":s.startControlPoint=o.Transform.mul(e,s.startControlPoint),s.endControlPoint=o.Transform.mul(e,s.endControlPoint);break;case"QuadraticBezierCurve":s.controlPoint=o.Transform.mul(e,s.controlPoint);break;case"EllipticalArcCurve":console.warn("Elliptical arc curves are not supported")}}return t.$.d.map((function(t){switch(t.type){case"Line":return function(t){return o.Edge(t.startingPoint,t.endPoint)}(t);case"QuadraticBezierCurve":return e=t,7,o.Chain(Array(7).fill(0).map((function(t,e){return e/6})).map((function(t){return o.Vec2.combine(1-t,o.Vec2.combine(1-t,e.startingPoint,t,e.controlPoint),t,o.Vec2.combine(1-t,e.controlPoint,t,e.endPoint))})));case"CubicBezierCurve":return function(t){return o.Chain(Array(7).fill(0).map((function(t,e){return e/6})).map((function(e){return o.Vec2.combine(1-e,o.Vec2.combine(1-e,o.Vec2.combine(1-e,t.startingPoint,e,t.startControlPoint),e,o.Vec2.combine(1-e,t.startControlPoint,e,t.endControlPoint)),e,o.Vec2.combine(1-e,o.Vec2.combine(1-e,t.startControlPoint,e,t.endControlPoint),e,o.Vec2.combine(1-e,t.endControlPoint,e,t.endPoint)))})))}(t);case"EllipticalArcCurve":return o.Chain([])}var e}))}},9793:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i,n,r=null!==(n=null===(i=t.$)||void 0===i?void 0:i.points)&&void 0!==n?n:[];return r=r.map((function(i){return[e,t.$.transform,i].filter((function(t){return t})).reduce(o.Transform.mul)})),[o.Polygon(r)]}},5667:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i,n,r=null!==(n=null===(i=t.$)||void 0===i?void 0:i.points)&&void 0!==n?n:[];return r=r.map((function(i){return[e,t.$.transform,i].filter((function(t){return t})).reduce(o.Transform.mul)})),[o.Chain(r)]}},580:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875),n=i(2212);e.default=function(t,e){var i,r,s=o.Vec2((null!==(i=t.$.x)&&void 0!==i?i:0)+t.$.width/2,(null!==(r=t.$.y)&&void 0!==r?r:0)+t.$.height/2),a=[e,t.$.transform].filter((function(t){return t})).reduce(o.Transform.mul,o.Transform.identity());s=o.Transform.mul(a,s);var h=n.getAngle(Math.acos(a.q.c),Math.asin(a.q.s));return[o.Box(t.$.width,t.$.height,s,h)]}},6193:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(7025),n=i(6113),r=i(4165),s=i(2824),a=i(9793),h=i(5667),c=i(580);e.default=function(t,e){switch(t["#name"].toLowerCase()){case"circle":return o.default(t,e);case"ellipse":return n.default(t,e);case"line":return r.default(t,e);case"path":return s.default(t,e);case"polygon":return a.default(t,e);case"polyline":return h.default(t,e);case"rect":return c.default(t,e);default:throw new Error("<"+t["#name"]+"> tag can not be converted to a shape")}}},8995:function(t,e,i){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]});e.__esModule=!0,e.convertShape=e.convertRect=e.convertPolyline=e.convertPolygon=e.convertLine=e.convertCircle=void 0,o(e,i(7025),"default","convertCircle"),o(e,i(4165),"default","convertLine"),o(e,i(9793),"default","convertPolygon"),o(e,i(5667),"default","convertPolyline"),o(e,i(580),"default","convertRect"),o(e,i(6193),"default","convertShape")},5590:function(t,e,i){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(n,r){function s(t){try{h(o.next(t))}catch(t){r(t)}}function a(t){try{h(o.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}h((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var i,o,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,n++)o[n]=r[s];return o};e.__esModule=!0,e.svg2planck=e.converters=e.util=e.parsers=e.processors=void 0,e.processors=i(5643),e.parsers=i(9309),e.util=i(2212),e.converters=i(8995);var a=i(3875),h=i(5055),c=i(5643),u=i(8104);e.svg2planck=function(t,e){var i,l,m;return n(this,void 0,void 0,(function(){var n,p,_,d;return r(this,(function(r){switch(r.label){case 0:return[4,h.parseStringPromise(t,o(o({},e),{attrkey:"$",explicitChildren:!0,preserveChildrenOrder:!0,explicitRoot:!1,attrValueProcessors:s([c.parseTransforms,c.squashTransforms,c.parsePoints,c.parsePaths,c.interpretPaths,h.processors.parseNumbers],null!==(i=e.attrNameProcessors)&&void 0!==i?i:[])}))];case 1:return n=r.sent(),p=null!==(l=e.meterPerPixelRatio)&&void 0!==l?l:1,_=null!==(m=e.scaleY)&&void 0!==m?m:1,d=1!==p||1!==_?new a.Mat33(a.Vec3(p,0,0),a.Vec3(0,p*_,0),a.Vec3(0,0,1)):null,u.wringOutMat33(n,d),[2,n]}}))}))}},9389:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875),n=i(8104),r=i(2212);function s(t,e){var i=o.Mat33.mulVec3(t,o.Vec3(e.x,e.y,1));return o.Vec2(i.x,i.y)}e.default=function(t,e){if(e){t.$||(t.$={}),t.$.transform&&(e=n.mat33mul(e,t.$.transform));var i=n.mat33ToTransform(e),a=i.transform,h=i.overhang;if(t.$.transform=a,h)switch(t["#name"].toLowerCase()){case"rect":!function(t){var e,i;t["#name"]="polygon";var n=t.$.width/2,r=t.$.height/2,s=(null!==(e=t.$.x)&&void 0!==e?e:0)+n,a=(null!==(i=t.$.y)&&void 0!==i?i:0)+r;t.$.points=[o.Vec2(s+n,a-r),o.Vec2(s+n,a+r),o.Vec2(s-n,a+r),o.Vec2(s-n,a-r)]}(t);case"polygon":case"polyline":t.$.points&&(t.$.points=t.$.points.map((function(t){return s(h,t)})));break;case"circle":!function(t){t["#name"]="ellipse",t.$.rx=t.$.r,t.$.ry=t.$.r}(t);case"ellipse":!function(t,e){var i,n,s,a,h,c,u=o.Mat33.mulVec3(e,o.Vec3(null!==(i=t.$.cx)&&void 0!==i?i:0,null!==(n=t.$.cy)&&void 0!==n?n:0,1));e.ex.mul(null!==(a=null!==(s=t.$.rx)&&void 0!==s?s:t.$.ry)&&void 0!==a?a:0),e.ey.mul(null!==(c=null!==(h=t.$.ry)&&void 0!==h?h:t.$.rx)&&void 0!==c?c:0);var l=2*o.Vec3.dot(e.ex,e.ey)/(o.Vec3.dot(e.ex,e.ex)-o.Vec3.dot(e.ey,e.ey)),m=Number.isNaN(l)?0:Math.atan(l)/2,p=function(t){return o.Vec3.add(o.Vec3.mul(e.ex,Math.cos(t)),o.Vec3.mul(e.ey,Math.sin(t)))},_=p(m);t.$.rx=Math.hypot(_.x,_.y);var d=p(m+Math.PI/2);t.$.ry=Math.hypot(d.x,d.y);var f=Math.hypot(_.x,_.y),y=0!==f?r.getAngle(Math.acos(_.x/f),Math.asin(_.y/f)):0;t.$.transform=o.Transform.mul(t.$.transform,o.Transform(o.Vec2(u.x,u.y),y)),t.$.cx=0,t.$.cy=0}(t,h),function(t){Math.abs(t.$.rx-t.$.ry)<.001&&(t["#name"]="circle",t.$.r=t.$.rx)}(t);break;case"line":!function(t,e){var i,n,r,s,a=o.Mat33.mul(e,o.Vec2(null!==(i=t.$.x1)&&void 0!==i?i:0,null!==(n=t.$.y1)&&void 0!==n?n:0)),h=o.Mat33.mul(e,o.Vec2(null!==(r=t.$.x2)&&void 0!==r?r:0,null!==(s=t.$.y2)&&void 0!==s?s:0));t.$.x1=a.x,t.$.y1=a.y,t.$.x2=h.x,t.$.y2=h.y}(t,h);break;case"path":!function(t,e){if(t.$.d)for(var i=0,o=t.$.d;i<o.length;i++){var n=o[i];switch(n.startingPoint=s(e,n.startingPoint),n.endPoint=s(e,n.endPoint),n.type){case"CubicBezierCurve":n.startControlPoint=s(e,n.startControlPoint),n.endControlPoint=s(e,n.endControlPoint);break;case"QuadraticBezierCurve":n.controlPoint=s(e,n.controlPoint);break;case"EllipticalArcCurve":console.warn("Elliptical arc curves are not supported")}}}(t,h);break;default:throw new Error("<"+t["#name"]+"> tag is not supported")}}}},8104:function(t,e,i){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]});e.__esModule=!0,e.wringOutMat33=e.applyMat33ToShape=e.mat33ToTransform=e.mat33mul=void 0,o(e,i(8046),"default","mat33mul"),o(e,i(1249),"default","mat33ToTransform"),o(e,i(9389),"default","applyMat33ToShape"),o(e,i(9326),"default","wringOutMat33")},1249:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875),n=i(2212),r=i(8046);function s(t){var e=t.ex,i=e.x,o=e.y,n=t.ey,r=n.x,s=n.y,a=t.ez;return[i-1,o,r,s-1,a.x,a.y].every((function(t){return Math.abs(t)<.001}))}e.default=function(t){var e=t.ex,i=e.x,a=e.y,h=t.ey,c=h.x,u=h.y,l=t.ez,m=l.x,p=l.y,_=i*u-a*c;if(0==Math.abs(_))throw new Error("Invalid transforma because the matrix does not have full rank");var d=Math.hypot(i,a),f=n.getAngle(Math.acos(i/d),Math.asin(a/d)),y=o.Transform(o.Vec2(m,p),f),v=r.default(new o.Mat33(o.Vec3(Math.cos(f),-Math.sin(f),0),o.Vec3(Math.sin(f),Math.cos(f),0),o.Vec3(-p*Math.sin(f)-m*Math.cos(f),-p*Math.cos(f)+m*Math.sin(f),1)),t);return{transform:y,overhang:s(v)?null:v}}},8046:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);e.default=function(t,e){var i=t.ex,n=i.x,r=i.y,s=t.ey,a=s.x,h=s.y,c=t.ez,u=c.x,l=c.y,m=e.ex,p=m.x,_=m.y,d=e.ey,f=d.x,y=d.y,v=e.ez,g=v.x,b=v.y;return new o.Mat33(o.Vec3(n*p+a*_,r*p+h*_,0),o.Vec3(n*f+a*y,r*f+h*y,0),o.Vec3(n*g+a*b+u,r*g+h*b+l,1))}},9326:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(8104),n=i(2212);e.default=function t(e,i){var r;if(n.isShape(e))o.applyMat33ToShape(e,i);else if(e.$$){if(null===(r=e.$)||void 0===r?void 0:r.transform){var s=e.$.transform;i&&(s=o.mat33mul(i,s));var a=o.mat33ToTransform(s);e.$.transform=a.transform,i=a.overhang}for(var h=0,c=e.$$;h<c.length;h++)t(c[h],i)}}},9309:function(t,e,i){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]});e.__esModule=!0,e.interpretPath=e.parsePath=e.parseNumberList=e.parseTransform=void 0,o(e,i(7233),"default","parseTransform"),o(e,i(4822),"default","parseNumberList"),o(e,i(9912),"default","parsePath"),o(e,i(3915),"default","interpretPath")},3915:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875);function n(t){return t===t.toLowerCase()}function r(t,e){var i;switch(t.letter){case"L":case"l":i=o.Vec2(t.parameters[0],t.parameters[0]);break;case"H":i=o.Vec2(t.parameters[0],e.y);break;case"h":i=o.Vec2(t.parameters[0],0);break;case"V":i=o.Vec2(e.x,t.parameters[0]);break;case"v":i=o.Vec2(0,t.parameters[0])}return n(t.letter)&&i.add(e),i}e.default=function(t){var e=[],i=t.shift();if("M"!==(null==i?void 0:i.letter)&&"m"!==(null==i?void 0:i.letter))return[];for(var s=o.Vec2(i.parameters[0],i.parameters[1]),a=s,h=s,c=s,u=0,l=t;u<l.length;u++){var m=l[u],p=void 0,_=void 0;switch(m.letter){case"M":case"m":p=o.Vec2(m.parameters[0],m.parameters[1]),n(m.letter)&&p.add(s),s=p,a=p,h=p,c=p;break;case"L":case"l":case"H":case"h":case"V":case"v":p=r(m,s),e.push({type:"Line",startingPoint:o.Vec2.clone(s),endPoint:p}),s=p,a=p,h=p;break;case"C":case"c":a=o.Vec2(m.parameters[0],m.parameters[1]),n(m.letter)&&a.add(s),m.parameters=m.parameters.slice(2);case"S":case"s":_=o.Vec2(m.parameters[0],m.parameters[1]),p=o.Vec2(m.parameters[2],m.parameters[3]),n(m.letter)&&(_.add(s),p.add(s)),e.push({type:"CubicBezierCurve",startingPoint:s,startControlPoint:a,endControlPoint:_,endPoint:p}),s=p,a=o.Vec2.combine(2,p,-1,a),h=p;break;case"Q":case"q":h=o.Vec2(m.parameters[0],m.parameters[1]),n(m.letter)&&h.add(s),m.parameters=m.parameters.slice(2);case"T":case"t":p=o.Vec2(m.parameters[0],m.parameters[1]),n(m.letter)&&p.add(s),e.push({type:"QuadraticBezierCurve",startingPoint:s,controlPoint:h,endPoint:p}),s=p,a=p,h=o.Vec2.combine(2,p,-1,h);break;case"A":case"a":p=o.Vec2(m.parameters[5],m.parameters[6]),n(m.letter)&&p.add(s),e.push({type:"EllipticalArcCurve",startingPoint:s,rx:m.parameters[0],ry:m.parameters[1],angle:m.parameters[2],largeArcFlag:m.parameters[3],sweepFlag:m.parameters[4],endPoint:p}),s=p,a=p,h=p;break;case"Z":case"z":e.push({type:"Line",startingPoint:o.Vec2.clone(s),endPoint:c}),s=c,a=c,h=c}}return e}},4822:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t){var e,i=null===(e=t.match(/[\+\-]?\d+(?:\.\d+)?/g))||void 0===e?void 0:e.map(parseFloat);return void 0===i?[]:i}},9912:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(9309);function n(t){if("MLT".includes(t.toLocaleUpperCase()))return 2;if("HV".includes(t.toLocaleUpperCase()))return 1;if("C".includes(t.toLocaleUpperCase()))return 6;if("SQ".includes(t.toLocaleUpperCase()))return 4;if("A".includes(t.toLocaleUpperCase()))return 7;if("Z".includes(t.toLocaleUpperCase()))return 0;throw new Error("Invalid command letter")}function r(t){return"M"===t?"L":"m"===t?"l":t}e.default=function(t){var e=[],i=t.match(/[MmLlHhVvCcSsQqTtAaZz][^MmLlHhVvCcSsQqTtAaZz]*/g);if(!i)return[];try{for(var s=0,a=i;s<a.length;s++){var h=a[s],c=h[0],u=o.parseNumberList(h.substr(1));if(0===u.length){if(0===n(c)){e.push({letter:c,parameters:[]});continue}break}for(;u.length>=n(c);)e.push({letter:c,parameters:u.slice(0,n(c))}),c=r(c),u=u.slice(n(c));if(0!==u.length)break}}catch(t){}return e}},7233:function(t,e,i){"use strict";var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,n++)o[n]=r[s];return o};e.__esModule=!0;var n=i(3875),r=i(4822);e.default=function(t){var e="Unexpected value '"+t+"' for transform attribute",i=t.match(/([a-zA-Z]+\s*\([^\)]+\))/g);if(null===i)throw new Error(e);return i.map((function(t){var i=t.match(/([a-zA-Z]+)\s*\(([^\)]+)\)/);if(null===i)throw new Error(e);i[0];var o=i[1],n=i[2];return{name:o,params:r.default(n)}})).map((function(t){var i=t.name,r=t.params;switch(i){case"matrix":return function(t){if(6!==t.length)throw new Error(e);var i=o(t),r=i[0],s=i[1],a=i[2],h=i[3],c=i[4],u=i[5];return new n.Mat33(n.Vec3(r,s,0),n.Vec3(a,h,0),n.Vec3(c,u,1))}(r);case"translate":return function(t){var i;if(1!==t.length&&2!==t.length)throw new Error(e);return new n.Mat33(n.Vec3(1,0,0),n.Vec3(0,1,0),n.Vec3(t[0],null!==(i=t[1])&&void 0!==i?i:0,1))}(r);case"rotate":return function(t){if(1!==t.length&&3!==t.length)throw new Error(e);var i=o(t),r=i[0],s=i[1],a=i[2],h=r*Math.PI/180;return new n.Mat33(n.Vec3(Math.cos(h),Math.sin(h),0),n.Vec3(-Math.sin(h),Math.cos(h),0),void 0===s?n.Vec3(0,0,1):n.Vec3(-s*Math.cos(h)+a*Math.sin(h)+s,-s*Math.sin(h)-a*Math.cos(h)+a,1))}(r);case"scale":return function(t){var i;if(1!==t.length&&2!==t.length)throw new Error(e);return new n.Mat33(n.Vec3(t[0],0,0),n.Vec3(0,null!==(i=t[1])&&void 0!==i?i:t[0],0),n.Vec3(0,0,1))}(r);case"skewX":return function(t){if(1!==t.length)throw new Error(e);var i=t[0]*Math.PI/180;return new n.Mat33(n.Vec3(1,0,0),n.Vec3(Math.tan(i),1,0),n.Vec3(0,0,1))}(r);case"skewY":return function(t){if(1!==t.length)throw new Error(e);var i=t[0]*Math.PI/180;return new n.Mat33(n.Vec3(1,Math.tan(i),0),n.Vec3(0,1,0),n.Vec3(0,0,1))}(r);default:throw new Error(e)}}))}},5643:function(t,e,i){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]});e.__esModule=!0,e.interpretPaths=e.parsePaths=e.squashTransforms=e.parsePoints=e.parseTransforms=void 0,o(e,i(5171),"default","parseTransforms"),o(e,i(9642),"default","parsePoints"),o(e,i(6292),"default","squashTransforms"),o(e,i(7332),"default","parsePaths"),o(e,i(4100),"default","interpretPaths")},4100:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(9309);e.default=function(t,e){if("d"!==e)return t;try{return o.interpretPath(t)}catch(t){return console.warn(t.message),[]}}},7332:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(9309);e.default=function(t,e){if("d"!==e)return t;try{return o.parsePath(t)}catch(t){return console.warn(t.message),[]}}},9642:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(3875),n=i(9309);e.default=function(t,e){if("points"!==e)return t;for(var i=n.parseNumberList(t),r=[],s=1;s<i.length;s+=2)r.push(o.Vec2(i[s-1],i[s]));return r}},5171:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(9309),n=i(3875);e.default=function(t,e){if("transform"!==e)return t;try{return o.parseTransform(t)}catch(t){return console.warn(t.message),n.Transform.identity()}}},6292:(t,e,i)=>{"use strict";e.__esModule=!0;var o=i(8046);e.default=function(t,e){return"transform"!==e?t:t.reduce(o.default)}},200:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t,e){return e>=0?t:2*Math.PI-t}},2212:function(t,e,i){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]});e.__esModule=!0,e.isShape=e.getAngle=void 0,o(e,i(200),"default","getAngle"),o(e,i(7094),"default","isShape")},7094:(t,e)=>{"use strict";e.__esModule=!0,e.default=function(t){return["circle","ellipse","line","path","polygon","polyline","rect"].includes(t["#name"].toLowerCase())}},9742:(t,e)=>{"use strict";e.byteLength=function(t){var e=h(t),i=e[0],o=e[1];return 3*(i+o)/4-o},e.toByteArray=function(t){var e,i,r=h(t),s=r[0],a=r[1],c=new n(function(t,e,i){return 3*(e+i)/4-i}(0,s,a)),u=0,l=a>0?s-4:s;for(i=0;i<l;i+=4)e=o[t.charCodeAt(i)]<<18|o[t.charCodeAt(i+1)]<<12|o[t.charCodeAt(i+2)]<<6|o[t.charCodeAt(i+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=255&e;return 2===a&&(e=o[t.charCodeAt(i)]<<2|o[t.charCodeAt(i+1)]>>4,c[u++]=255&e),1===a&&(e=o[t.charCodeAt(i)]<<10|o[t.charCodeAt(i+1)]<<4|o[t.charCodeAt(i+2)]>>2,c[u++]=e>>8&255,c[u++]=255&e),c},e.fromByteArray=function(t){for(var e,o=t.length,n=o%3,r=[],s=16383,a=0,h=o-n;a<h;a+=s)r.push(c(t,a,a+s>h?h:a+s));return 1===n?(e=t[o-1],r.push(i[e>>2]+i[e<<4&63]+"==")):2===n&&(e=(t[o-2]<<8)+t[o-1],r.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),r.join("")};for(var i=[],o=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=r.length;s<a;++s)i[s]=r[s],o[r.charCodeAt(s)]=s;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function c(t,e,o){for(var n,r,s=[],a=e;a<o;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(i[(r=n)>>18&63]+i[r>>12&63]+i[r>>6&63]+i[63&r]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},8764:(t,e,i)=>{"use strict";const o=i(9742),n=i(645),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=h,e.SlowBuffer=function(t){return+t!=t&&(t=0),h.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,h.prototype),e}function h(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return c(t,e,i)}function c(t,e,i){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!h.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const i=0|d(t,e);let o=a(i);const n=o.write(t,e);return n!==i&&(o=o.slice(0,n)),o}(t,e);if(ArrayBuffer.isView(t))return function(t){if(H(t,Uint8Array)){const e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return m(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(H(t,ArrayBuffer)||t&&H(t.buffer,ArrayBuffer))return p(t,e,i);if("undefined"!=typeof SharedArrayBuffer&&(H(t,SharedArrayBuffer)||t&&H(t.buffer,SharedArrayBuffer)))return p(t,e,i);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const o=t.valueOf&&t.valueOf();if(null!=o&&o!==t)return h.from(o,e,i);const n=function(t){if(h.isBuffer(t)){const e=0|_(t.length),i=a(e);return 0===i.length||t.copy(i,0,0,e),i}return void 0!==t.length?"number"!=typeof t.length||X(t.length)?a(0):m(t):"Buffer"===t.type&&Array.isArray(t.data)?m(t.data):void 0}(t);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return h.from(t[Symbol.toPrimitive]("string"),e,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function l(t){return u(t),a(t<0?0:0|_(t))}function m(t){const e=t.length<0?0:0|_(t.length),i=a(e);for(let o=0;o<e;o+=1)i[o]=255&t[o];return i}function p(t,e,i){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(i||0))throw new RangeError('"length" is outside of buffer bounds');let o;return o=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i),Object.setPrototypeOf(o,h.prototype),o}function _(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function d(t,e){if(h.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||H(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const i=t.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===i)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return W(t).length;default:if(n)return o?-1:$(t).length;e=(""+e).toLowerCase(),n=!0}}function f(t,e,i){let o=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,i);case"utf8":case"utf-8":return E(this,e,i);case"ascii":return C(this,e,i);case"latin1":case"binary":return S(this,e,i);case"base64":return T(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,i);default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}function y(t,e,i){const o=t[e];t[e]=t[i],t[i]=o}function v(t,e,i,o,n){if(0===t.length)return-1;if("string"==typeof i?(o=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),X(i=+i)&&(i=n?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(n)return-1;i=t.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof e&&(e=h.from(e,o)),h.isBuffer(e))return 0===e.length?-1:g(t,e,i,o,n);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):g(t,[e],i,o,n);throw new TypeError("val must be string, number or Buffer")}function g(t,e,i,o,n){let r,s=1,a=t.length,h=e.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(t.length<2||e.length<2)return-1;s=2,a/=2,h/=2,i/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(n){let o=-1;for(r=i;r<a;r++)if(c(t,r)===c(e,-1===o?0:r-o)){if(-1===o&&(o=r),r-o+1===h)return o*s}else-1!==o&&(r-=r-o),o=-1}else for(i+h>a&&(i=a-h),r=i;r>=0;r--){let i=!0;for(let o=0;o<h;o++)if(c(t,r+o)!==c(e,o)){i=!1;break}if(i)return r}return-1}function b(t,e,i,o){i=Number(i)||0;const n=t.length-i;o?(o=Number(o))>n&&(o=n):o=n;const r=e.length;let s;for(o>r/2&&(o=r/2),s=0;s<o;++s){const o=parseInt(e.substr(2*s,2),16);if(X(o))return s;t[i+s]=o}return s}function x(t,e,i,o){return J($(e,t.length-i),t,i,o)}function A(t,e,i,o){return J(function(t){const e=[];for(let i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,o)}function w(t,e,i,o){return J(W(e),t,i,o)}function B(t,e,i,o){return J(function(t,e){let i,o,n;const r=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)i=t.charCodeAt(s),o=i>>8,n=i%256,r.push(n),r.push(o);return r}(e,t.length-i),t,i,o)}function T(t,e,i){return 0===e&&i===t.length?o.fromByteArray(t):o.fromByteArray(t.slice(e,i))}function E(t,e,i){i=Math.min(t.length,i);const o=[];let n=e;for(;n<i;){const e=t[n];let r=null,s=e>239?4:e>223?3:e>191?2:1;if(n+s<=i){let i,o,a,h;switch(s){case 1:e<128&&(r=e);break;case 2:i=t[n+1],128==(192&i)&&(h=(31&e)<<6|63&i,h>127&&(r=h));break;case 3:i=t[n+1],o=t[n+2],128==(192&i)&&128==(192&o)&&(h=(15&e)<<12|(63&i)<<6|63&o,h>2047&&(h<55296||h>57343)&&(r=h));break;case 4:i=t[n+1],o=t[n+2],a=t[n+3],128==(192&i)&&128==(192&o)&&128==(192&a)&&(h=(15&e)<<18|(63&i)<<12|(63&o)<<6|63&a,h>65535&&h<1114112&&(r=h))}}null===r?(r=65533,s=1):r>65535&&(r-=65536,o.push(r>>>10&1023|55296),r=56320|1023&r),o.push(r),n+=s}return function(t){const e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);let i="",o=0;for(;o<e;)i+=String.fromCharCode.apply(String,t.slice(o,o+=I));return i}(o)}e.kMaxLength=s,h.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),h.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(t,e,i){return c(t,e,i)},Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(t,e,i){return function(t,e,i){return u(t),t<=0?a(t):void 0!==e?"string"==typeof i?a(t).fill(e,i):a(t).fill(e):a(t)}(t,e,i)},h.allocUnsafe=function(t){return l(t)},h.allocUnsafeSlow=function(t){return l(t)},h.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==h.prototype},h.compare=function(t,e){if(H(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),H(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let i=t.length,o=e.length;for(let n=0,r=Math.min(i,o);n<r;++n)if(t[n]!==e[n]){i=t[n],o=e[n];break}return i<o?-1:o<i?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);let i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;const o=h.allocUnsafe(e);let n=0;for(i=0;i<t.length;++i){let e=t[i];if(H(e,Uint8Array))n+e.length>o.length?(h.isBuffer(e)||(e=h.from(e)),e.copy(o,n)):Uint8Array.prototype.set.call(o,e,n);else{if(!h.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(o,n)}n+=e.length}return o},h.byteLength=d,h.prototype._isBuffer=!0,h.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},h.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},h.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},h.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?E(this,0,t):f.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){let t="";const i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},r&&(h.prototype[r]=h.prototype.inspect),h.prototype.compare=function(t,e,i,o,n){if(H(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===o&&(o=0),void 0===n&&(n=this.length),e<0||i>t.length||o<0||n>this.length)throw new RangeError("out of range index");if(o>=n&&e>=i)return 0;if(o>=n)return-1;if(e>=i)return 1;if(this===t)return 0;let r=(n>>>=0)-(o>>>=0),s=(i>>>=0)-(e>>>=0);const a=Math.min(r,s),c=this.slice(o,n),u=t.slice(e,i);for(let t=0;t<a;++t)if(c[t]!==u[t]){r=c[t],s=u[t];break}return r<s?-1:s<r?1:0},h.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},h.prototype.indexOf=function(t,e,i){return v(this,t,e,i,!0)},h.prototype.lastIndexOf=function(t,e,i){return v(this,t,e,i,!1)},h.prototype.write=function(t,e,i,o){if(void 0===e)o="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)o=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===o&&(o="utf8")):(o=i,i=void 0)}const n=this.length-e;if((void 0===i||i>n)&&(i=n),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");let r=!1;for(;;)switch(o){case"hex":return b(this,t,e,i);case"utf8":case"utf-8":return x(this,t,e,i);case"ascii":case"latin1":case"binary":return A(this,t,e,i);case"base64":return w(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,i);default:if(r)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),r=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function C(t,e,i){let o="";i=Math.min(t.length,i);for(let n=e;n<i;++n)o+=String.fromCharCode(127&t[n]);return o}function S(t,e,i){let o="";i=Math.min(t.length,i);for(let n=e;n<i;++n)o+=String.fromCharCode(t[n]);return o}function M(t,e,i){const o=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>o)&&(i=o);let n="";for(let o=e;o<i;++o)n+=K[t[o]];return n}function P(t,e,i){const o=t.slice(e,i);let n="";for(let t=0;t<o.length-1;t+=2)n+=String.fromCharCode(o[t]+256*o[t+1]);return n}function D(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,i,o,n,r){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<r)throw new RangeError('"value" argument is out of bounds');if(i+o>t.length)throw new RangeError("Index out of range")}function L(t,e,i,o,n){j(e,o,n,t,i,7);let r=Number(e&BigInt(4294967295));t[i++]=r,r>>=8,t[i++]=r,r>>=8,t[i++]=r,r>>=8,t[i++]=r;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[i++]=s,s>>=8,t[i++]=s,s>>=8,t[i++]=s,s>>=8,t[i++]=s,i}function V(t,e,i,o,n){j(e,o,n,t,i,7);let r=Number(e&BigInt(4294967295));t[i+7]=r,r>>=8,t[i+6]=r,r>>=8,t[i+5]=r,r>>=8,t[i+4]=r;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[i+3]=s,s>>=8,t[i+2]=s,s>>=8,t[i+1]=s,s>>=8,t[i]=s,i+8}function N(t,e,i,o,n,r){if(i+o>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function F(t,e,i,o,r){return e=+e,i>>>=0,r||N(t,0,i,4),n.write(t,e,i,o,23,4),i+4}function z(t,e,i,o,r){return e=+e,i>>>=0,r||N(t,0,i,8),n.write(t,e,i,o,52,8),i+8}h.prototype.slice=function(t,e){const i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);const o=this.subarray(t,e);return Object.setPrototypeOf(o,h.prototype),o},h.prototype.readUintLE=h.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let o=this[t],n=1,r=0;for(;++r<e&&(n*=256);)o+=this[t+r]*n;return o},h.prototype.readUintBE=h.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let o=this[t+--e],n=1;for(;e>0&&(n*=256);)o+=this[t+--e]*n;return o},h.prototype.readUint8=h.prototype.readUInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),this[t]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readBigUInt64LE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const o=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,n=this[++t]+256*this[++t]+65536*this[++t]+i*2**24;return BigInt(o)+(BigInt(n)<<BigInt(32))})),h.prototype.readBigUInt64BE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const o=e*2**24+65536*this[++t]+256*this[++t]+this[++t],n=this[++t]*2**24+65536*this[++t]+256*this[++t]+i;return(BigInt(o)<<BigInt(32))+BigInt(n)})),h.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let o=this[t],n=1,r=0;for(;++r<e&&(n*=256);)o+=this[t+r]*n;return n*=128,o>=n&&(o-=Math.pow(2,8*e)),o},h.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);let o=e,n=1,r=this[t+--o];for(;o>0&&(n*=256);)r+=this[t+--o]*n;return n*=128,r>=n&&(r-=Math.pow(2,8*e)),r},h.prototype.readInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){t>>>=0,e||D(t,2,this.length);const i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt16BE=function(t,e){t>>>=0,e||D(t,2,this.length);const i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readBigInt64LE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const o=this[t+4]+256*this[t+5]+65536*this[t+6]+(i<<24);return(BigInt(o)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),h.prototype.readBigInt64BE=Z((function(t){U(t>>>=0,"offset");const e=this[t],i=this[t+7];void 0!==e&&void 0!==i||G(t,this.length-8);const o=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(o)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+i)})),h.prototype.readFloatLE=function(t,e){return t>>>=0,e||D(t,4,this.length),n.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return t>>>=0,e||D(t,4,this.length),n.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return t>>>=0,e||D(t,8,this.length),n.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return t>>>=0,e||D(t,8,this.length),n.read(this,t,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(t,e,i,o){t=+t,e>>>=0,i>>>=0,o||O(this,t,e,i,Math.pow(2,8*i)-1,0);let n=1,r=0;for(this[e]=255&t;++r<i&&(n*=256);)this[e+r]=t/n&255;return e+i},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(t,e,i,o){t=+t,e>>>=0,i>>>=0,o||O(this,t,e,i,Math.pow(2,8*i)-1,0);let n=i-1,r=1;for(this[e+n]=255&t;--n>=0&&(r*=256);)this[e+n]=t/r&255;return e+i},h.prototype.writeUint8=h.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,1,255,0),this[e]=255&t,e+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeBigUInt64LE=Z((function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeBigUInt64BE=Z((function(t,e=0){return V(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeIntLE=function(t,e,i,o){if(t=+t,e>>>=0,!o){const o=Math.pow(2,8*i-1);O(this,t,e,i,o-1,-o)}let n=0,r=1,s=0;for(this[e]=255&t;++n<i&&(r*=256);)t<0&&0===s&&0!==this[e+n-1]&&(s=1),this[e+n]=(t/r>>0)-s&255;return e+i},h.prototype.writeIntBE=function(t,e,i,o){if(t=+t,e>>>=0,!o){const o=Math.pow(2,8*i-1);O(this,t,e,i,o-1,-o)}let n=i-1,r=1,s=0;for(this[e+n]=255&t;--n>=0&&(r*=256);)t<0&&0===s&&0!==this[e+n+1]&&(s=1),this[e+n]=(t/r>>0)-s&255;return e+i},h.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},h.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeBigInt64LE=Z((function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeBigInt64BE=Z((function(t,e=0){return V(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeFloatLE=function(t,e,i){return F(this,t,e,!0,i)},h.prototype.writeFloatBE=function(t,e,i){return F(this,t,e,!1,i)},h.prototype.writeDoubleLE=function(t,e,i){return z(this,t,e,!0,i)},h.prototype.writeDoubleBE=function(t,e,i){return z(this,t,e,!1,i)},h.prototype.copy=function(t,e,i,o){if(!h.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<i&&(o=i),o===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-i&&(o=t.length-e+i);const n=o-i;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,i,o):Uint8Array.prototype.set.call(t,this.subarray(i,o),e),n},h.prototype.fill=function(t,e,i,o){if("string"==typeof t){if("string"==typeof e?(o=e,e=0,i=this.length):"string"==typeof i&&(o=i,i=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!h.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===t.length){const e=t.charCodeAt(0);("utf8"===o&&e<128||"latin1"===o)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;let n;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(n=e;n<i;++n)this[n]=t;else{const r=h.isBuffer(t)?t:h.from(t,o),s=r.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(n=0;n<i-e;++n)this[n+e]=r[n%s]}return this};const R={};function k(t,e,i){R[t]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function q(t){let e="",i=t.length;const o="-"===t[0]?1:0;for(;i>=o+4;i-=3)e=`_${t.slice(i-3,i)}${e}`;return`${t.slice(0,i)}${e}`}function j(t,e,i,o,n,r){if(t>i||t<e){const o="bigint"==typeof e?"n":"";let n;throw n=r>3?0===e||e===BigInt(0)?`>= 0${o} and < 2${o} ** ${8*(r+1)}${o}`:`>= -(2${o} ** ${8*(r+1)-1}${o}) and < 2 ** ${8*(r+1)-1}${o}`:`>= ${e}${o} and <= ${i}${o}`,new R.ERR_OUT_OF_RANGE("value",n,t)}!function(t,e,i){U(e,"offset"),void 0!==t[e]&&void 0!==t[e+i]||G(e,t.length-(i+1))}(o,n,r)}function U(t,e){if("number"!=typeof t)throw new R.ERR_INVALID_ARG_TYPE(e,"number",t)}function G(t,e,i){if(Math.floor(t)!==t)throw U(t,i),new R.ERR_OUT_OF_RANGE(i||"offset","an integer",t);if(e<0)throw new R.ERR_BUFFER_OUT_OF_BOUNDS;throw new R.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${e}`,t)}k("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),k("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),k("ERR_OUT_OF_RANGE",(function(t,e,i){let o=`The value of "${t}" is out of range.`,n=i;return Number.isInteger(i)&&Math.abs(i)>2**32?n=q(String(i)):"bigint"==typeof i&&(n=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(n=q(n)),n+="n"),o+=` It must be ${e}. Received ${n}`,o}),RangeError);const Y=/[^+/0-9A-Za-z-_]/g;function $(t,e){let i;e=e||1/0;const o=t.length;let n=null;const r=[];for(let s=0;s<o;++s){if(i=t.charCodeAt(s),i>55295&&i<57344){if(!n){if(i>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(s+1===o){(e-=3)>-1&&r.push(239,191,189);continue}n=i;continue}if(i<56320){(e-=3)>-1&&r.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&(e-=3)>-1&&r.push(239,191,189);if(n=null,i<128){if((e-=1)<0)break;r.push(i)}else if(i<2048){if((e-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function W(t){return o.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(Y,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function J(t,e,i,o){let n;for(n=0;n<o&&!(n+i>=e.length||n>=t.length);++n)e[n+i]=t[n];return n}function H(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function X(t){return t!=t}const K=function(){const t="0123456789abcdef",e=new Array(256);for(let i=0;i<16;++i){const o=16*i;for(let n=0;n<16;++n)e[o+n]=t[i]+t[n]}return e}();function Z(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}},7187:t=>{"use strict";var e,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};e=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var n=Number.isNaN||function(t){return t!=t};function r(){r.init.call(this)}t.exports=r,t.exports.once=function(t,e){return new Promise((function(i,o){function n(){void 0!==r&&t.removeListener("error",r),i([].slice.call(arguments))}var r;"error"!==e&&(r=function(i){t.removeListener(e,n),o(i)},t.once("error",r)),t.once(e,n)}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function c(t,e,i,o){var n,r,s,c;if(a(i),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),r=t._events),s=r[e]),void 0===s)s=r[e]=i,++t._eventsCount;else if("function"==typeof s?s=r[e]=o?[i,s]:[s,i]:o?s.unshift(i):s.push(i),(n=h(t))>0&&s.length>n&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(t,e,i){var o={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},n=u.bind(o);return n.listener=i,o.wrapFn=n,n}function m(t,e,i){var o=t._events;if(void 0===o)return[];var n=o[e];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(n):_(n,n.length)}function p(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function _(t,e){for(var i=new Array(e),o=0;o<e;++o)i[o]=t[o];return i}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||n(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||n(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return h(this)},r.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n="error"===t,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var h=r[t];if(void 0===h)return!1;if("function"==typeof h)o(h,this,e);else{var c=h.length,u=_(h,c);for(i=0;i<c;++i)o(u[i],this,e)}return!0},r.prototype.addListener=function(t,e){return c(this,t,e,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(t,e){return c(this,t,e,!0)},r.prototype.once=function(t,e){return a(e),this.on(t,l(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,l(this,t,e)),this},r.prototype.removeListener=function(t,e){var i,o,n,r,s;if(a(e),void 0===(o=this._events))return this;if(void 0===(i=o[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===e||i[r].listener===e){s=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,n),1===i.length&&(o[t]=i[0]),void 0!==o.removeListener&&this.emit("removeListener",t,s||e)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(t){var e,i,o;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var n,r=Object.keys(i);for(o=0;o<r.length;++o)"removeListener"!==(n=r[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},r.prototype.listeners=function(t){return m(this,t,!0)},r.prototype.rawListeners=function(t){return m(this,t,!1)},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},r.prototype.listenerCount=p,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},645:(t,e)=>{e.read=function(t,e,i,o,n){var r,s,a=8*n-o-1,h=(1<<a)-1,c=h>>1,u=-7,l=i?n-1:0,m=i?-1:1,p=t[e+l];for(l+=m,r=p&(1<<-u)-1,p>>=-u,u+=a;u>0;r=256*r+t[e+l],l+=m,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=o;u>0;s=256*s+t[e+l],l+=m,u-=8);if(0===r)r=1-c;else{if(r===h)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,o),r-=c}return(p?-1:1)*s*Math.pow(2,r-o)},e.write=function(t,e,i,o,n,r){var s,a,h,c=8*r-n-1,u=(1<<c)-1,l=u>>1,m=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=o?0:r-1,_=o?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),(e+=s+l>=1?m/h:m*Math.pow(2,1-l))*h>=2&&(s++,h/=2),s+l>=u?(a=0,s=u):s+l>=1?(a=(e*h-1)*Math.pow(2,n),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,n),s=0));n>=8;t[i+p]=255&a,p+=_,a/=256,n-=8);for(s=s<<n|a,c+=n;c>0;t[i+p]=255&s,p+=_,s/=256,c-=8);t[i+p-_]|=128*d}},2129:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=v;var n=i(2274),r=i(4896),s=i(6306),a=i(3766),h=i(5387),c=i(5385),u=i(8850),l=i(5235),m=i(8601),p=i(662),_=(i(2322),v.STATIC="static"),d=v.KINEMATIC="kinematic",f=v.DYNAMIC="dynamic",y={type:_,position:s.zero(),angle:0,linearVelocity:s.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null};function v(t,e){e=r(e,y),o&&n.assert(s.isValid(e.position)),o&&n.assert(s.isValid(e.linearVelocity)),o&&n.assert(h.isFinite(e.angle)),o&&n.assert(h.isFinite(e.angularVelocity)),o&&n.assert(h.isFinite(e.angularDamping)&&e.angularDamping>=0),o&&n.assert(h.isFinite(e.linearDamping)&&e.linearDamping>=0),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=e.userData,this.m_type=e.type,this.m_type==f?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=u.identity(),this.m_xf.p=s.clone(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new c,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new l,this.c_position=new m,this.m_force=s.zero(),this.m_torque=0,this.m_linearVelocity=s.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1}function g(){this.mass=0,this.center=s.zero(),this.I=0}v.prototype._serialize=function(){for(var t=[],e=this.m_fixtureList;e;e=e.m_next)t.push(e);return{type:this.m_type,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:t}},v._deserialize=function(t,e,i){var o=new v(e,t);return t.fixtures.forEach((function(t){var e=i(p,t,o);o._addFixture(e)})),o},v.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},v.prototype.getWorld=function(){return this.m_world},v.prototype.getNext=function(){return this.m_next},v.prototype.setUserData=function(t){this.m_userData=t},v.prototype.getUserData=function(){return this.m_userData},v.prototype.getFixtureList=function(){return this.m_fixtureList},v.prototype.getJointList=function(){return this.m_jointList},v.prototype.getContactList=function(){return this.m_contactList},v.prototype.isStatic=function(){return this.m_type==_},v.prototype.isDynamic=function(){return this.m_type==f},v.prototype.isKinematic=function(){return this.m_type==d},v.prototype.setStatic=function(){return this.setType(_),this},v.prototype.setDynamic=function(){return this.setType(f),this},v.prototype.setKinematic=function(){return this.setType(d),this},v.prototype.getType=function(){return this.m_type},v.prototype.setType=function(t){if(o&&n.assert(t===_||t===d||t===f),o&&n.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==_&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var i=e;e=e.next,this.m_world.destroyContact(i.contact)}this.m_contactList=null;for(var r=this.m_world.m_broadPhase,s=this.m_fixtureList;s;s=s.m_next)for(var a=s.m_proxyCount,h=0;h<a;++h)r.touchProxy(s.m_proxies[h].proxyId)}},v.prototype.isBullet=function(){return this.m_bulletFlag},v.prototype.setBullet=function(t){this.m_bulletFlag=!!t},v.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},v.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},v.prototype.isAwake=function(){return this.m_awakeFlag},v.prototype.setAwake=function(t){t?0==this.m_awakeFlag&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},v.prototype.isActive=function(){return this.m_activeFlag},v.prototype.setActive=function(t){if(o&&n.assert(0==this.isWorldLocked()),t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag)for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.createProxies(e,this.m_xf);else{for(e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.destroyProxies(e);for(var r=this.m_contactList;r;){var s=r;r=r.next,this.m_world.destroyContact(s.contact)}this.m_contactList=null}},v.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},v.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},v.prototype.getTransform=function(){return this.m_xf},v.prototype.setTransform=function(t,e){if(o&&n.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);for(var i=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.synchronize(i,this.m_xf,this.m_xf)}},v.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},v.prototype.synchronizeFixtures=function(){var t=u.identity();this.m_sweep.getTransform(t,0);for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.synchronize(e,t,this.m_xf)},v.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.set(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},v.prototype.getPosition=function(){return this.m_xf.p},v.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},v.prototype.getAngle=function(){return this.m_sweep.a},v.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},v.prototype.getWorldCenter=function(){return this.m_sweep.c},v.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},v.prototype.getLinearVelocity=function(){return this.m_linearVelocity},v.prototype.getLinearVelocityFromWorldPoint=function(t){var e=s.sub(t,this.m_sweep.c);return s.add(this.m_linearVelocity,s.cross(this.m_angularVelocity,e))},v.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},v.prototype.setLinearVelocity=function(t){this.m_type!=_&&(s.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.set(t))},v.prototype.getAngularVelocity=function(){return this.m_angularVelocity},v.prototype.setAngularVelocity=function(t){this.m_type!=_&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},v.prototype.getLinearDamping=function(){return this.m_linearDamping},v.prototype.setLinearDamping=function(t){this.m_linearDamping=t},v.prototype.getAngularDamping=function(){return this.m_angularDamping},v.prototype.setAngularDamping=function(t){this.m_angularDamping=t},v.prototype.getGravityScale=function(){return this.m_gravityScale},v.prototype.setGravityScale=function(t){this.m_gravityScale=t},v.prototype.getMass=function(){return this.m_mass},v.prototype.getInertia=function(){return this.m_I+this.m_mass*s.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},v.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.set(this.m_sweep.localCenter)},v.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic())return this.m_sweep.c0.set(this.m_xf.p),this.m_sweep.c.set(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);o&&n.assert(this.isDynamic());for(var t=s.zero(),e=this.m_fixtureList;e;e=e.m_next)if(0!=e.m_density){var i=new g;e.getMassData(i),this.m_mass+=i.mass,t.addMul(i.mass,i.center),this.m_I+=i.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,t.mul(this.m_invMass)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*s.dot(t,t),o&&n.assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var r=s.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_linearVelocity.add(s.cross(this.m_angularVelocity,s.sub(this.m_sweep.c,r)))},v.prototype.setMassData=function(t){if(o&&n.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type==f){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*s.dot(t.center,t.center),o&&n.assert(this.m_I>0),this.m_invI=1/this.m_I);var e=s.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(s.cross(this.m_angularVelocity,s.sub(this.m_sweep.c,e)))}},v.prototype.applyForce=function(t,e,i){this.m_type==f&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=s.cross(s.sub(e,this.m_sweep.c),t)))},v.prototype.applyForceToCenter=function(t,e){this.m_type==f&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},v.prototype.applyTorque=function(t,e){this.m_type==f&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},v.prototype.applyLinearImpulse=function(t,e,i){this.m_type==f&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*s.cross(s.sub(e,this.m_sweep.c),t)))},v.prototype.applyAngularImpulse=function(t,e){this.m_type==f&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},v.prototype.shouldCollide=function(t){if(this.m_type!=f&&t.m_type!=f)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},v.prototype._addFixture=function(t){if(o&&n.assert(0==this.isWorldLocked()),1==this.isWorldLocked())return null;if(this.m_activeFlag){var e=this.m_world.m_broadPhase;t.createProxies(e,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,t.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,t},v.prototype.createFixture=function(t,e){if(o&&n.assert(0==this.isWorldLocked()),1==this.isWorldLocked())return null;var i=new p(this,t,e);return this._addFixture(i),i},v.prototype.destroyFixture=function(t){if(o&&n.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){o&&n.assert(t.m_body==this);var e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else for(var i=this.m_fixtureList;null!=i;){if(i.m_next===t){i.m_next=t.m_next,e=!0;break}i=i.m_next}o&&n.assert(e);for(var r=this.m_contactList;r;){var s=r.contact;r=r.next;var a=s.getFixtureA(),h=s.getFixtureB();t!=a&&t!=h||this.m_world.destroyContact(s)}if(this.m_activeFlag){var c=this.m_world.m_broadPhase;t.destroyProxies(c)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}},v.prototype.getWorldPoint=function(t){return u.mulVec2(this.m_xf,t)},v.prototype.getWorldVector=function(t){return a.mulVec2(this.m_xf.q,t)},v.prototype.getLocalPoint=function(t){return u.mulTVec2(this.m_xf,t)},v.prototype.getLocalVector=function(t){return a.mulTVec2(this.m_xf.q,t)}},8730:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(2274),r=i(5387),s=i(6306),a=i(8850),h=i(6173),c=i(3766),u=i(1099),l=i(226),m=i(8054);function p(t){this.contact=t,this.prev,this.next,this.other}function _(t,e,i,o,n){this.m_nodeA=new p(this),this.m_nodeB=new p(this),this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=o,this.m_evaluateFcn=n,this.m_manifold=new l,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=f(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=y(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=s.zero(),this.v_normalMass=new h,this.v_K=new h,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=s.zero(),this.p_localPoint=s.zero(),this.p_localCenterA=s.zero(),this.p_localCenterB=s.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}function d(){this.rA=s.zero(),this.rB=s.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}function f(t,e){return r.sqrt(t*e)}function y(t,e){return t>e?t:e}t.exports=_,_.prototype.initConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB,r=e.getShape(),a=i.getShape(),h=e.getBody(),c=i.getBody(),u=this.getManifold(),l=u.pointCount;o&&n.assert(l>0),this.v_invMassA=h.m_invMass,this.v_invMassB=c.m_invMass,this.v_invIA=h.m_invI,this.v_invIB=c.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=l,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=h.m_invMass,this.p_invMassB=c.m_invMass,this.p_invIA=h.m_invI,this.p_invIB=c.m_invI,this.p_localCenterA=s.clone(h.m_sweep.localCenter),this.p_localCenterB=s.clone(c.m_sweep.localCenter),this.p_radiusA=r.m_radius,this.p_radiusB=a.m_radius,this.p_type=u.type,this.p_localNormal=s.clone(u.localNormal),this.p_localPoint=s.clone(u.localPoint),this.p_pointCount=l;for(var m=0;m<l;++m){var p=u.points[m],_=this.v_points[m]=new d;t.warmStarting?(_.normalImpulse=t.dtRatio*p.normalImpulse,_.tangentImpulse=t.dtRatio*p.tangentImpulse):(_.normalImpulse=0,_.tangentImpulse=0),_.rA.setZero(),_.rB.setZero(),_.normalMass=0,_.tangentMass=0,_.velocityBias=0,this.p_localPoints[m]=s.clone(p.localPoint)}},_.prototype.getManifold=function(){return this.m_manifold},_.prototype.getWorldManifold=function(t){var e=this.m_fixtureA.getBody(),i=this.m_fixtureB.getBody(),o=this.m_fixtureA.getShape(),n=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),o.m_radius,i.getTransform(),n.m_radius)},_.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},_.prototype.isEnabled=function(){return this.m_enabledFlag},_.prototype.isTouching=function(){return this.m_touchingFlag},_.prototype.getNext=function(){return this.m_next},_.prototype.getFixtureA=function(){return this.m_fixtureA},_.prototype.getFixtureB=function(){return this.m_fixtureB},_.prototype.getChildIndexA=function(){return this.m_indexA},_.prototype.getChildIndexB=function(){return this.m_indexB},_.prototype.flagForFiltering=function(){this.m_filterFlag=!0},_.prototype.setFriction=function(t){this.m_friction=t},_.prototype.getFriction=function(){return this.m_friction},_.prototype.resetFriction=function(){this.m_friction=f(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},_.prototype.setRestitution=function(t){this.m_restitution=t},_.prototype.getRestitution=function(){return this.m_restitution},_.prototype.resetRestitution=function(){this.m_restitution=y(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},_.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},_.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},_.prototype.evaluate=function(t,e,i){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,i,this.m_fixtureB,this.m_indexB)},_.prototype.update=function(t){this.m_enabledFlag=!0;var e=!1,i=this.m_touchingFlag,o=this.m_fixtureA.isSensor(),n=this.m_fixtureB.isSensor(),r=o||n,s=this.m_fixtureA.getBody(),a=this.m_fixtureB.getBody(),h=s.getTransform(),c=a.getTransform();if(r){var u=this.m_fixtureA.getShape(),p=this.m_fixtureB.getShape();e=m.testOverlap(u,this.m_indexA,p,this.m_indexB,h,c),this.m_manifold.pointCount=0}else{var _=this.m_manifold;this.m_manifold=new l,this.evaluate(this.m_manifold,h,c),e=this.m_manifold.pointCount>0;for(var d=0;d<this.m_manifold.pointCount;++d){var f=this.m_manifold.points[d];f.normalImpulse=0,f.tangentImpulse=0;for(var y=0;y<_.pointCount;++y){var v=_.points[y];if(v.id.key==f.id.key){f.normalImpulse=v.normalImpulse,f.tangentImpulse=v.tangentImpulse;break}}}e!=i&&(s.setAwake(!0),a.setAwake(!0))}this.m_touchingFlag=e,0==i&&1==e&&t&&t.beginContact(this),1==i&&0==e&&t&&t.endContact(this),0==r&&e&&t&&t.preSolve(this,_)},_.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)},_.prototype.solvePositionConstraintTOI=function(t,e,i){return this._solvePositionConstraint(t,!0,e,i)},_.prototype._solvePositionConstraint=function(t,e,i,o){var n=this.m_fixtureA,h=this.m_fixtureB,m=n.getBody(),p=h.getBody(),_=(m.c_velocity,p.c_velocity,m.c_position),d=p.c_position,f=s.clone(this.p_localCenterA),y=s.clone(this.p_localCenterB),v=0,g=0;e&&m!=i&&m!=o||(v=this.p_invMassA,g=this.p_invIA);var b=0,x=0;e&&p!=i&&p!=o||(b=this.p_invMassB,x=this.p_invIB);for(var A=s.clone(_.c),w=_.a,B=s.clone(d.c),T=d.a,E=0,I=0;I<this.p_pointCount;++I){var C,S,M,P=a.identity(),D=a.identity();switch(P.q.set(w),D.q.set(T),P.p=s.sub(A,c.mulVec2(P.q,f)),D.p=s.sub(B,c.mulVec2(D.q,y)),this.p_type){case l.e_circles:var O=a.mulVec2(P,this.p_localPoint),L=a.mulVec2(D,this.p_localPoints[0]);(C=s.sub(L,O)).normalize(),S=s.combine(.5,O,.5,L),M=s.dot(s.sub(L,O),C)-this.p_radiusA-this.p_radiusB;break;case l.e_faceA:C=c.mulVec2(P.q,this.p_localNormal);var V=a.mulVec2(P,this.p_localPoint),N=a.mulVec2(D,this.p_localPoints[I]);M=s.dot(s.sub(N,V),C)-this.p_radiusA-this.p_radiusB,S=N;break;case l.e_faceB:C=c.mulVec2(D.q,this.p_localNormal),V=a.mulVec2(D,this.p_localPoint),N=a.mulVec2(P,this.p_localPoints[I]),M=s.dot(s.sub(N,V),C)-this.p_radiusA-this.p_radiusB,S=N,C.mul(-1)}var F=s.sub(S,A),z=s.sub(S,B);E=r.min(E,M);var R=e?u.toiBaugarte:u.baumgarte,k=u.linearSlop,q=u.maxLinearCorrection,j=r.clamp(R*(M+k),-q,0),U=s.cross(F,C),G=s.cross(z,C),Y=v+b+g*U*U+x*G*G,$=Y>0?-j/Y:0,W=s.mul($,C);A.subMul(v,W),w-=g*s.cross(F,W),B.addMul(b,W),T+=x*s.cross(z,W)}return _.c.set(A),_.a=w,d.c.set(B),d.a=T,E},_.prototype.initVelocityConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB,r=e.getBody(),h=i.getBody(),l=r.c_velocity,m=h.c_velocity,p=r.c_position,_=h.c_position,d=this.p_radiusA,f=this.p_radiusB,y=this.getManifold(),v=this.v_invMassA,g=this.v_invMassB,b=this.v_invIA,x=this.v_invIB,A=s.clone(this.p_localCenterA),w=s.clone(this.p_localCenterB),B=s.clone(p.c),T=p.a,E=s.clone(l.v),I=l.w,C=s.clone(_.c),S=_.a,M=s.clone(m.v),P=m.w;o&&n.assert(y.pointCount>0);var D=a.identity(),O=a.identity();D.q.set(T),O.q.set(S),D.p.setCombine(1,B,-1,c.mulVec2(D.q,A)),O.p.setCombine(1,C,-1,c.mulVec2(O.q,w));var L=y.getWorldManifold(null,D,d,O,f);this.v_normal.set(L.normal);for(var V=0;V<this.v_pointCount;++V){var N=this.v_points[V];N.rA.set(s.sub(L.points[V],B)),N.rB.set(s.sub(L.points[V],C));var F=s.cross(N.rA,this.v_normal),z=s.cross(N.rB,this.v_normal),R=v+g+b*F*F+x*z*z;N.normalMass=R>0?1/R:0;var k=s.cross(this.v_normal,1),q=s.cross(N.rA,k),j=s.cross(N.rB,k),U=v+g+b*q*q+x*j*j;N.tangentMass=U>0?1/U:0,N.velocityBias=0;var G=s.dot(this.v_normal,M)+s.dot(this.v_normal,s.cross(P,N.rB))-s.dot(this.v_normal,E)-s.dot(this.v_normal,s.cross(I,N.rA));G<-u.velocityThreshold&&(N.velocityBias=-this.v_restitution*G)}if(2==this.v_pointCount&&t.blockSolve){var Y=this.v_points[0],$=this.v_points[1],W=s.cross(Y.rA,this.v_normal),J=s.cross(Y.rB,this.v_normal),H=s.cross($.rA,this.v_normal),X=s.cross($.rB,this.v_normal),K=v+g+b*W*W+x*J*J,Z=v+g+b*H*H+x*X*X,Q=v+g+b*W*H+x*J*X;K*K<1e3*(K*Z-Q*Q)?(this.v_K.ex.set(K,Q),this.v_K.ey.set(Q,Z),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}p.c.set(B),p.a=T,l.v.set(E),l.w=I,_.c.set(C),_.a=S,m.v.set(M),m.w=P},_.prototype.warmStartConstraint=function(t){for(var e=this.m_fixtureA,i=this.m_fixtureB,o=e.getBody(),n=i.getBody(),r=o.c_velocity,a=n.c_velocity,h=(o.c_position,n.c_position,this.v_invMassA),c=this.v_invIA,u=this.v_invMassB,l=this.v_invIB,m=s.clone(r.v),p=r.w,_=s.clone(a.v),d=a.w,f=this.v_normal,y=s.cross(f,1),v=0;v<this.v_pointCount;++v){var g=this.v_points[v],b=s.combine(g.normalImpulse,f,g.tangentImpulse,y);p-=c*s.cross(g.rA,b),m.subMul(h,b),d+=l*s.cross(g.rB,b),_.addMul(u,b)}r.v.set(m),r.w=p,a.v.set(_),a.w=d},_.prototype.storeConstraintImpulses=function(t){for(var e=this.m_manifold,i=0;i<this.v_pointCount;++i)e.points[i].normalImpulse=this.v_points[i].normalImpulse,e.points[i].tangentImpulse=this.v_points[i].tangentImpulse},_.prototype.solveVelocityConstraint=function(t){var e=this.m_fixtureA.m_body,i=this.m_fixtureB.m_body,a=e.c_velocity,c=(e.c_position,i.c_velocity),u=(i.c_position,this.v_invMassA),l=this.v_invIA,m=this.v_invMassB,p=this.v_invIB,_=s.clone(a.v),d=a.w,f=s.clone(c.v),y=c.w,v=this.v_normal,g=s.cross(v,1),b=this.v_friction;o&&n.assert(1==this.v_pointCount||2==this.v_pointCount);for(var x=0;x<this.v_pointCount;++x){var A=this.v_points[x];(C=s.zero()).addCombine(1,f,1,s.cross(y,A.rB)),C.subCombine(1,_,1,s.cross(d,A.rA));var w=s.dot(C,g)-this.v_tangentSpeed,B=A.tangentMass*-w,T=b*A.normalImpulse;B=(S=r.clamp(A.tangentImpulse+B,-T,T))-A.tangentImpulse,A.tangentImpulse=S;var E=s.mul(B,g);_.subMul(u,E),d-=l*s.cross(A.rA,E),f.addMul(m,E),y+=p*s.cross(A.rB,E)}if(1==this.v_pointCount||0==t.blockSolve)for(var I=0;I<this.v_pointCount;++I){var C;A=this.v_points[I],(C=s.zero()).addCombine(1,f,1,s.cross(y,A.rB)),C.subCombine(1,_,1,s.cross(d,A.rA));var S,M=s.dot(C,v);B=-A.normalMass*(M-A.velocityBias),B=(S=r.max(A.normalImpulse+B,0))-A.normalImpulse,A.normalImpulse=S,E=s.mul(B,v),_.subMul(u,E),d-=l*s.cross(A.rA,E),f.addMul(m,E),y+=p*s.cross(A.rB,E)}else{var P=this.v_points[0],D=this.v_points[1],O=s.neo(P.normalImpulse,D.normalImpulse);o&&n.assert(O.x>=0&&O.y>=0);var L=s.zero().add(f).add(s.cross(y,P.rB)).sub(_).sub(s.cross(d,P.rA)),V=s.zero().add(f).add(s.cross(y,D.rB)).sub(_).sub(s.cross(d,D.rA)),N=s.dot(L,v),F=s.dot(V,v),z=s.neo(N-P.velocityBias,F-D.velocityBias);for(z.sub(h.mulVec2(this.v_K,O));;){var R=h.mulVec2(this.v_normalMass,z).neg();if(R.x>=0&&R.y>=0){var k=s.sub(R,O),q=s.mul(k.x,v),j=s.mul(k.y,v);_.subCombine(u,q,u,j),d-=l*(s.cross(P.rA,q)+s.cross(D.rA,j)),f.addCombine(m,q,m,j),y+=p*(s.cross(P.rB,q)+s.cross(D.rB,j)),P.normalImpulse=R.x,D.normalImpulse=R.y;break}if(R.x=-P.normalMass*z.x,R.y=0,N=0,F=this.v_K.ex.y*R.x+z.y,R.x>=0&&F>=0){k=s.sub(R,O),q=s.mul(k.x,v),j=s.mul(k.y,v),_.subCombine(u,q,u,j),d-=l*(s.cross(P.rA,q)+s.cross(D.rA,j)),f.addCombine(m,q,m,j),y+=p*(s.cross(P.rB,q)+s.cross(D.rB,j)),P.normalImpulse=R.x,D.normalImpulse=R.y;break}if(R.x=0,R.y=-D.normalMass*z.y,N=this.v_K.ey.x*R.y+z.x,F=0,R.y>=0&&N>=0){k=s.sub(R,O),q=s.mul(k.x,v),j=s.mul(k.y,v),_.subCombine(u,q,u,j),d-=l*(s.cross(P.rA,q)+s.cross(D.rA,j)),f.addCombine(m,q,m,j),y+=p*(s.cross(P.rB,q)+s.cross(D.rB,j)),P.normalImpulse=R.x,D.normalImpulse=R.y;break}if(R.x=0,R.y=0,N=z.x,F=z.y,N>=0&&F>=0){k=s.sub(R,O),q=s.mul(k.x,v),j=s.mul(k.y,v),_.subCombine(u,q,u,j),d-=l*(s.cross(P.rA,q)+s.cross(D.rA,j)),f.addCombine(m,q,m,j),y+=p*(s.cross(P.rB,q)+s.cross(D.rB,j)),P.normalImpulse=R.x,D.normalImpulse=R.y;break}break}}a.v.set(_),a.w=d,c.v.set(f),c.w=y};var v=[];_.addType=function(t,e,i){v[t]=v[t]||{},v[t][e]=i},_.create=function(t,e,i,o){var n,r,s=t.getType(),a=i.getType();if(r=v[s]&&v[s][a])n=new _(t,e,i,o,r);else{if(!(r=v[a]&&v[a][s]))return null;n=new _(i,o,t,e,r)}t=n.getFixtureA(),i=n.getFixtureB(),e=n.getChildIndexA(),o=n.getChildIndexB();var h=t.getBody(),c=i.getBody();return n.m_nodeA.contact=n,n.m_nodeA.other=c,n.m_nodeA.prev=null,n.m_nodeA.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=n.m_nodeA),h.m_contactList=n.m_nodeA,n.m_nodeB.contact=n,n.m_nodeB.other=h,n.m_nodeB.prev=null,n.m_nodeB.next=c.m_contactList,null!=c.m_contactList&&(c.m_contactList.prev=n.m_nodeB),c.m_contactList=n.m_nodeB,0==t.isSensor()&&0==i.isSensor()&&(h.setAwake(!0),c.setAwake(!0)),n},_.destroy=function(t,e){var i=t.m_fixtureA,o=t.m_fixtureB,n=i.getBody(),r=o.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==r.m_contactList&&(r.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&0==i.isSensor()&&0==o.isSensor()&&(n.setAwake(!0),r.setAwake(!0));var s=i.getType(),a=o.getType(),h=v[s][a].destroyFcn;"function"==typeof h&&h(t)}},662:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var n=i(2274),r=i(4896),s=i(5387),a=i(6306),h=i(3406),c=i(2322),u={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function l(t,e){this.aabb=new h,this.fixture=t,this.childIndex=e,this.proxyId}function m(t,e,i){e.shape?(i=e,e=e.shape):"number"==typeof i&&(i={density:i}),i=r(i,u),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var o=this.m_shape.getChildCount(),n=0;n<o;++n)this.m_proxies[n]=new l(this,n);this.m_userData=i.userData}m.prototype._reset=function(){var t=this.getBody(),e=t.m_world.m_broadPhase;this.destroyProxies(e),this.m_shape._reset&&this.m_shape._reset();for(var i=this.m_shape.getChildCount(),o=0;o<i;++o)this.m_proxies[o]=new l(this,o);this.createProxies(e,t.m_xf),t.resetMassData()},m.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}},m._deserialize=function(t,e,i){var o=i(c,t.shape);return o&&new m(e,o,t)},m.prototype.getType=function(){return this.m_shape.getType()},m.prototype.getShape=function(){return this.m_shape},m.prototype.isSensor=function(){return this.m_isSensor},m.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},m.prototype.getUserData=function(){return this.m_userData},m.prototype.setUserData=function(t){this.m_userData=t},m.prototype.getBody=function(){return this.m_body},m.prototype.getNext=function(){return this.m_next},m.prototype.getDensity=function(){return this.m_density},m.prototype.setDensity=function(t){o&&n.assert(s.isFinite(t)&&t>=0),this.m_density=t},m.prototype.getFriction=function(){return this.m_friction},m.prototype.setFriction=function(t){this.m_friction=t},m.prototype.getRestitution=function(){return this.m_restitution},m.prototype.setRestitution=function(t){this.m_restitution=t},m.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},m.prototype.rayCast=function(t,e,i){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),i)},m.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},m.prototype.getAABB=function(t){return o&&n.assert(0<=t&&t<this.m_proxyCount),this.m_proxies[t].aabb},m.prototype.createProxies=function(t,e){o&&n.assert(0==this.m_proxyCount),this.m_proxyCount=this.m_shape.getChildCount();for(var i=0;i<this.m_proxyCount;++i){var r=this.m_proxies[i];this.m_shape.computeAABB(r.aabb,e,i),r.proxyId=t.createProxy(r.aabb,r)}},m.prototype.destroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var i=this.m_proxies[e];t.destroyProxy(i.proxyId),i.proxyId=null}this.m_proxyCount=0},m.prototype.synchronize=function(t,e,i){for(var o=0;o<this.m_proxyCount;++o){var n=this.m_proxies[o],r=new h,s=new h;this.m_shape.computeAABB(r,e,n.childIndex),this.m_shape.computeAABB(s,i,n.childIndex),n.aabb.combine(r,s);var c=a.sub(i.p,e.p);t.moveProxy(n.proxyId,n.aabb,c)}},m.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},m.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},m.prototype.setFilterGroupIndex=function(t){return this.m_filterGroupIndex=t},m.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},m.prototype.setFilterCategoryBits=function(t){this.m_filterCategoryBits=t},m.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},m.prototype.setFilterMaskBits=function(t){this.m_filterMaskBits=t},m.prototype.refilter=function(){if(null!=this.m_body){for(var t=this.m_body.getContactList();t;){var e=t.contact,i=e.getFixtureA(),o=e.getFixtureB();i!=this&&o!=this||e.flagForFiltering(),t=t.next}var n=this.m_body.getWorld();if(null!=n)for(var r=n.m_broadPhase,s=0;s<this.m_proxyCount;++s)r.touchProxy(this.m_proxies[s].proxyId)}},m.prototype.shouldCollide=function(t){return t.m_filterGroupIndex==this.m_filterGroupIndex&&0!=t.m_filterGroupIndex?t.m_filterGroupIndex>0:0!=(t.m_filterMaskBits&this.m_filterCategoryBits)&&0!=(t.m_filterCategoryBits&this.m_filterMaskBits)}},5878:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=s;var n=i(2274);function r(){this.other=null,this.joint=null,this.prev=null,this.next=null}function s(t,e,i){e=t.bodyA||e,i=t.bodyB||i,o&&n.assert(e),o&&n.assert(i),o&&n.assert(e!=i),this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=i,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new r,this.m_edgeB=new r,this.m_islandFlag=!1,this.m_userData=t.userData}s.TYPES={},s._deserialize=function(t,e,i){var o=s.TYPES[t.type];return o&&i(o,t)},s.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},s.prototype.getType=function(){return this.m_type},s.prototype.getBodyA=function(){return this.m_bodyA},s.prototype.getBodyB=function(){return this.m_bodyB},s.prototype.getNext=function(){return this.m_next},s.prototype.getUserData=function(){return this.m_userData},s.prototype.setUserData=function(t){this.m_userData=t},s.prototype.getCollideConnected=function(){return this.m_collideConnected},s.prototype.getAnchorA=function(){},s.prototype.getAnchorB=function(){},s.prototype.getReactionForce=function(t){},s.prototype.getReactionTorque=function(t){},s.prototype.shiftOrigin=function(t){},s.prototype.initVelocityConstraints=function(t){},s.prototype.solveVelocityConstraints=function(t){},s.prototype.solvePositionConstraints=function(t){}},226:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,i(2274);var o=i(6306),n=i(8850),r=i(5387),s=i(3766);function a(){this.type,this.localNormal=o.zero(),this.localPoint=o.zero(),this.points=[new h,new h],this.pointCount=0}function h(){this.localPoint=o.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new c}function c(){this.cf=new u}function u(){this.indexA,this.indexB,this.typeA,this.typeB}function l(){this.normal,this.points=[],this.separations=[]}t.exports=a,t.exports.clipSegmentToLine=function(t,e,i,n,r){var s=0,h=o.dot(i,e[0].v)-n,c=o.dot(i,e[1].v)-n;if(h<=0&&t[s++].set(e[0]),c<=0&&t[s++].set(e[1]),h*c<0){var u=h/(h-c);t[s].v.setCombine(1-u,e[0].v,u,e[1].v),t[s].id.cf.indexA=r,t[s].id.cf.indexB=e[0].id.cf.indexB,t[s].id.cf.typeA=a.e_vertex,t[s].id.cf.typeB=a.e_face,++s}return s},t.exports.clipVertex=p,t.exports.getPointStates=function(t,e,i,o){for(var n=0;n<i.pointCount;++n){var r=i.points[n].id;t[n]=m.removeState;for(var s=0;s<o.pointCount;++s)if(o.points[s].id.key==r.key){t[n]=m.persistState;break}}for(n=0;n<o.pointCount;++n)for(r=o.points[n].id,e[n]=m.addState,s=0;s<i.pointCount;++s)if(i.points[s].id.key==r.key){e[n]=m.persistState;break}},t.exports.PointState=m,a.e_circles=0,a.e_faceA=1,a.e_faceB=2,a.e_vertex=0,a.e_face=1,Object.defineProperty(c.prototype,"key",{get:function(){return this.cf.indexA+4*this.cf.indexB+16*this.cf.typeA+64*this.cf.typeB},enumerable:!0,configurable:!0}),c.prototype.set=function(t){this.cf.set(t.cf)},u.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB},a.prototype.getWorldManifold=function(t,e,i,h,c){if(0!=this.pointCount){var u=(t=t||new l).normal,m=t.points,p=t.separations;switch(this.type){case a.e_circles:u=o.neo(1,0);var _=n.mulVec2(e,this.localPoint),d=n.mulVec2(h,this.points[0].localPoint),f=o.sub(d,_);o.lengthSquared(f)>r.EPSILON*r.EPSILON&&(u.set(f),u.normalize());var y=_.clone().addMul(i,u),v=d.clone().addMul(-c,u);m[0]=o.mid(y,v),p[0]=o.dot(o.sub(v,y),u),m.length=1,p.length=1;break;case a.e_faceA:u=s.mulVec2(e.q,this.localNormal);for(var g=n.mulVec2(e,this.localPoint),b=0;b<this.pointCount;++b){var x=n.mulVec2(h,this.points[b].localPoint);y=o.clone(x).addMul(i-o.dot(o.sub(x,g),u),u),v=o.clone(x).subMul(c,u),m[b]=o.mid(y,v),p[b]=o.dot(o.sub(v,y),u)}m.length=this.pointCount,p.length=this.pointCount;break;case a.e_faceB:for(u=s.mulVec2(h.q,this.localNormal),g=n.mulVec2(h,this.localPoint),b=0;b<this.pointCount;++b)x=n.mulVec2(e,this.points[b].localPoint),v=o.combine(1,x,c-o.dot(o.sub(x,g),u),u),y=o.combine(1,x,-i,u),m[b]=o.mid(y,v),p[b]=o.dot(o.sub(y,v),u);m.length=this.pointCount,p.length=this.pointCount,u.mul(-1)}return t.normal=u,t.points=m,t.separations=p,t}};var m={nullState:0,addState:1,persistState:2,removeState:3};function p(){this.v=o.zero(),this.id=new c}p.prototype.set=function(t){this.v.set(t.v),this.id.set(t.id)}},1099:(t,e)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;var i=e;i.maxManifoldPoints=2,i.maxPolygonVertices=12,i.aabbExtension=.1,i.aabbMultiplier=2,i.linearSlop=.005,i.linearSlopSquared=i.linearSlop*i.linearSlop,i.angularSlop=2/180*Math.PI,i.polygonRadius=2*i.linearSlop,i.maxSubSteps=8,i.maxTOIContacts=32,i.maxTOIIterations=20,i.maxDistnceIterations=20,i.velocityThreshold=1,i.maxLinearCorrection=.2,i.maxAngularCorrection=8/180*Math.PI,i.maxTranslation=2,i.maxTranslationSquared=i.maxTranslation*i.maxTranslation,i.maxRotation=.5*Math.PI,i.maxRotationSquared=i.maxRotation*i.maxRotation,i.baumgarte=.2,i.toiBaugarte=.75,i.timeToSleep=.5,i.linearSleepTolerance=.01,i.linearSleepToleranceSqr=Math.pow(i.linearSleepTolerance,2),i.angularSleepTolerance=2/180*Math.PI,i.angularSleepToleranceSqr=Math.pow(i.angularSleepTolerance,2)},2322:(t,e,i)=>{function o(){this.m_type,this.m_radius}"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=o,i(5387),o.prototype._reset=function(){},o.prototype._serialize=function(){return{}},o.TYPES={},o._deserialize=function(t,e,i){var n=o.TYPES[t.type];return n&&i(n,t)},o.isValid=function(t){return!!t},o.prototype.getRadius=function(){return this.m_radius},o.prototype.getType=function(){return this.m_type},o.prototype._clone=function(){},o.prototype.getChildCount=function(){},o.prototype.testPoint=function(t,e){},o.prototype.rayCast=function(t,e,i,o){},o.prototype.computeAABB=function(t,e,i){},o.prototype.computeMass=function(t,e){},o.prototype.computeDistanceProxy=function(t){}},2260:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=y,t.exports.TimeStep=f;var r=i(1099),s=i(2274),a=i(6306),h=i(5387),c=i(2129),u=i(8730),l=i(5878),m=i(8650),p=m.Input,_=m.Output,d=i(8054);function f(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}function y(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}d.Input,d.Output,d.Proxy,d.Cache,f.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},y.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},y.prototype.addBody=function(t){n&&s.assert(t instanceof c,"Not a Body!",t),this.m_bodies.push(t)},y.prototype.addContact=function(t){n&&s.assert(t instanceof u,"Not a Contact!",t),this.m_contacts.push(t)},y.prototype.addJoint=function(t){n&&s.assert(t instanceof l,"Not a Joint!",t),this.m_joints.push(t)},y.prototype.solveWorld=function(t){for(var e=this.m_world,i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1;for(var o=e.m_contactList;o;o=o.m_next)o.m_islandFlag=!1;for(var r=e.m_jointList;r;r=r.m_next)r.m_islandFlag=!1;for(var a=this.m_stack,h=e.m_bodyList;h;h=h.m_next)if(!h.m_islandFlag&&0!=h.isAwake()&&0!=h.isActive()&&!h.isStatic()){for(this.clear(),a.push(h),h.m_islandFlag=!0;a.length>0;)if(i=a.pop(),n&&s.assert(1==i.isActive()),this.addBody(i),i.setAwake(!0),!i.isStatic()){for(var c=i.m_contactList;c;c=c.next){var u=c.contact;if(!u.m_islandFlag&&0!=u.isEnabled()&&0!=u.isTouching()){var l=u.m_fixtureA.m_isSensor,m=u.m_fixtureB.m_isSensor;l||m||(this.addContact(u),u.m_islandFlag=!0,(_=c.other).m_islandFlag||(a.push(_),_.m_islandFlag=!0))}}for(var p=i.m_jointList;p;p=p.next){var _;1!=p.joint.m_islandFlag&&0!=(_=p.other).isActive()&&(this.addJoint(p.joint),p.joint.m_islandFlag=!0,_.m_islandFlag||(a.push(_),_.m_islandFlag=!0))}}this.solveIsland(t);for(var d=0;d<this.m_bodies.length;++d)(i=this.m_bodies[d]).isStatic()&&(i.m_islandFlag=!1)}},y.prototype.solveIsland=function(t){for(var e=this.m_world,i=e.m_gravity,n=e.m_allowSleep,s=t.dt,c=0;c<this.m_bodies.length;++c){var u=this.m_bodies[c],l=a.clone(u.m_sweep.c),m=u.m_sweep.a,p=a.clone(u.m_linearVelocity),_=u.m_angularVelocity;u.m_sweep.c0.set(u.m_sweep.c),u.m_sweep.a0=u.m_sweep.a,u.isDynamic()&&(p.addMul(s*u.m_gravityScale,i),p.addMul(s*u.m_invMass,u.m_force),_+=s*u.m_invI*u.m_torque,p.mul(1/(1+s*u.m_linearDamping)),_*=1/(1+s*u.m_angularDamping)),u.c_position.c=l,u.c_position.a=m,u.c_velocity.v=p,u.c_velocity.w=_}for(c=0;c<this.m_contacts.length;++c)this.m_contacts[c].initConstraint(t);for(o&&this.printBodies("M: "),c=0;c<this.m_contacts.length;++c)this.m_contacts[c].initVelocityConstraint(t);if(o&&this.printBodies("R: "),t.warmStarting)for(c=0;c<this.m_contacts.length;++c)this.m_contacts[c].warmStartConstraint(t);for(o&&this.printBodies("Q: "),c=0;c<this.m_joints.length;++c)this.m_joints[c].initVelocityConstraints(t);for(o&&this.printBodies("E: "),c=0;c<t.velocityIterations;++c){for(var d=0;d<this.m_joints.length;++d)this.m_joints[d].solveVelocityConstraints(t);for(d=0;d<this.m_contacts.length;++d)this.m_contacts[d].solveVelocityConstraint(t)}for(o&&this.printBodies("D: "),c=0;c<this.m_contacts.length;++c)this.m_contacts[c].storeConstraintImpulses(t);for(o&&this.printBodies("C: "),c=0;c<this.m_bodies.length;++c){u=this.m_bodies[c],l=a.clone(u.c_position.c),m=u.c_position.a,p=a.clone(u.c_velocity.v),_=u.c_velocity.w;var f=a.mul(s,p);if(a.lengthSquared(f)>r.maxTranslationSquared){var y=r.maxTranslation/f.length();p.mul(y)}var v=s*_;v*v>r.maxRotationSquared&&(_*=y=r.maxRotation/h.abs(v)),l.addMul(s,p),m+=s*_,u.c_position.c.set(l),u.c_position.a=m,u.c_velocity.v.set(p),u.c_velocity.w=_}o&&this.printBodies("B: ");var g=!1;for(c=0;c<t.positionIterations;++c){var b=0;for(d=0;d<this.m_contacts.length;++d){var x=this.m_contacts[d].solvePositionConstraint(t);b=h.min(b,x)}var A=b>=-3*r.linearSlop,w=!0;for(d=0;d<this.m_joints.length;++d){var B=this.m_joints[d].solvePositionConstraints(t);w=w&&B}if(A&&w){g=!0;break}}for(o&&this.printBodies("L: "),c=0;c<this.m_bodies.length;++c)(u=this.m_bodies[c]).m_sweep.c.set(u.c_position.c),u.m_sweep.a=u.c_position.a,u.m_linearVelocity.set(u.c_velocity.v),u.m_angularVelocity=u.c_velocity.w,u.synchronizeTransform();if(this.postSolveIsland(),n){var T=1/0,E=r.linearSleepToleranceSqr,I=r.angularSleepToleranceSqr;for(c=0;c<this.m_bodies.length;++c)(u=this.m_bodies[c]).isStatic()||(0==u.m_autoSleepFlag||u.m_angularVelocity*u.m_angularVelocity>I||a.lengthSquared(u.m_linearVelocity)>E?(u.m_sleepTime=0,T=0):(u.m_sleepTime+=s,T=h.min(T,u.m_sleepTime)));if(T>=r.timeToSleep&&g)for(c=0;c<this.m_bodies.length;++c)(u=this.m_bodies[c]).setAwake(!1)}},y.prototype.printBodies=function(t){for(var e=0;e<this.m_bodies.length;++e){var i=this.m_bodies[e];s.debug(t,i.c_position.a,i.c_position.c.x,i.c_position.c.y,i.c_velocity.w,i.c_velocity.v.x,i.c_velocity.v.y)}};var v=new f;function g(){this.normalImpulses=[],this.tangentImpulses=[]}y.prototype.solveWorldTOI=function(t){var e=this.m_world;if(e.m_stepComplete){for(var i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1,i.m_sweep.alpha0=0;for(var a=e.m_contactList;a;a=a.m_next)a.m_toiFlag=!1,a.m_islandFlag=!1,a.m_toiCount=0,a.m_toi=1}for(;;){var c=null,u=1;for(a=e.m_contactList;a;a=a.m_next)if(0!=a.isEnabled()&&!(a.m_toiCount>r.maxSubSteps)){var l=1;if(a.m_toiFlag)l=a.m_toi;else{var d=a.getFixtureA(),f=a.getFixtureB();if(d.isSensor()||f.isSensor())continue;var y=d.getBody(),g=f.getBody();n&&s.assert(y.isDynamic()||g.isDynamic());var b=y.isAwake()&&!y.isStatic(),x=g.isAwake()&&!g.isStatic();if(0==b&&0==x)continue;var A=y.isBullet()||!y.isDynamic(),w=g.isBullet()||!g.isDynamic();if(0==A&&0==w)continue;var B=y.m_sweep.alpha0;y.m_sweep.alpha0<g.m_sweep.alpha0?(B=g.m_sweep.alpha0,y.m_sweep.advance(B)):g.m_sweep.alpha0<y.m_sweep.alpha0&&(B=y.m_sweep.alpha0,g.m_sweep.advance(B)),n&&s.assert(B<1);var T=a.getChildIndexA(),E=a.getChildIndexB(),I=(y.m_sweep,g.m_sweep,new p);I.proxyA.set(d.getShape(),T),I.proxyB.set(f.getShape(),E),I.sweepA.set(y.m_sweep),I.sweepB.set(g.m_sweep),I.tMax=1;var C=new _;m(C,I);var S=C.t;l=C.state==_.e_touching?h.min(B+(1-B)*S,1):1,a.m_toi=l,a.m_toiFlag=!0}l<u&&(c=a,u=l)}if(null==c||1-10*h.EPSILON<u){e.m_stepComplete=!0;break}d=c.getFixtureA(),f=c.getFixtureB(),y=d.getBody(),g=f.getBody();var M=y.m_sweep.clone(),P=g.m_sweep.clone();if(y.advance(u),g.advance(u),c.update(e),c.m_toiFlag=!1,++c.m_toiCount,0!=c.isEnabled()&&0!=c.isTouching()){y.setAwake(!0),g.setAwake(!0),this.clear(),this.addBody(y),this.addBody(g),this.addContact(c),y.m_islandFlag=!0,g.m_islandFlag=!0,c.m_islandFlag=!0;for(var D=[y,g],O=0;O<D.length;++O)if((k=D[O]).isDynamic())for(var L=k.m_contactList;L;L=L.next){var V=L.contact;if(!V.m_islandFlag){var N=L.other;if(!N.isDynamic()||k.isBullet()||N.isBullet()){var F=V.m_fixtureA.m_isSensor,z=V.m_fixtureB.m_isSensor;if(!F&&!z){var R=N.m_sweep.clone();0==N.m_islandFlag&&N.advance(u),V.update(e),0!=V.isEnabled()&&0!=V.isTouching()?(V.m_islandFlag=!0,this.addContact(V),N.m_islandFlag||(N.m_islandFlag=!0,N.isStatic()||N.setAwake(!0),this.addBody(N))):(N.m_sweep.set(R),N.synchronizeTransform())}}}}for(v.reset((1-u)*t.dt),v.dtRatio=1,v.positionIterations=20,v.velocityIterations=t.velocityIterations,v.warmStarting=!1,this.solveIslandTOI(v,y,g),O=0;O<this.m_bodies.length;++O){var k;if((k=this.m_bodies[O]).m_islandFlag=!1,k.isDynamic())for(k.synchronizeFixtures(),L=k.m_contactList;L;L=L.next)L.contact.m_toiFlag=!1,L.contact.m_islandFlag=!1}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}else c.setEnabled(!1),y.m_sweep.set(M),g.m_sweep.set(P),y.synchronizeTransform(),g.synchronizeTransform()}if(o)for(i=e.m_bodyList;i;i=i.m_next)a=i.m_sweep.c,i.m_sweep.a,i.m_linearVelocity,i.m_angularVelocity},y.prototype.solveIslandTOI=function(t,e,i){this.m_world;for(var o=0;o<this.m_bodies.length;++o)(l=this.m_bodies[o]).c_position.c.set(l.m_sweep.c),l.c_position.a=l.m_sweep.a,l.c_velocity.v.set(l.m_linearVelocity),l.c_velocity.w=l.m_angularVelocity;for(o=0;o<this.m_contacts.length;++o)this.m_contacts[o].initConstraint(t);for(o=0;o<t.positionIterations;++o){for(var n=0,s=0;s<this.m_contacts.length;++s){var c=this.m_contacts[s].solvePositionConstraintTOI(t,e,i);n=h.min(n,c)}if(n>=-1.5*r.linearSlop)break}for(e.m_sweep.c0.set(e.c_position.c),e.m_sweep.a0=e.c_position.a,i.m_sweep.c0.set(i.c_position.c),i.m_sweep.a0=i.c_position.a,o=0;o<this.m_contacts.length;++o)this.m_contacts[o].initVelocityConstraint(t);for(o=0;o<t.velocityIterations;++o)for(s=0;s<this.m_contacts.length;++s)this.m_contacts[s].solveVelocityConstraint(t);var u=t.dt;for(o=0;o<this.m_bodies.length;++o){var l=this.m_bodies[o],m=a.clone(l.c_position.c),p=l.c_position.a,_=a.clone(l.c_velocity.v),d=l.c_velocity.w,f=a.mul(u,_);if(a.dot(f,f)>r.maxTranslationSquared){var y=r.maxTranslation/f.length();_.mul(y)}var v=u*d;v*v>r.maxRotationSquared&&(d*=y=r.maxRotation/h.abs(v)),m.addMul(u,_),p+=u*d,l.c_position.c=m,l.c_position.a=p,l.c_velocity.v=_,l.c_velocity.w=d,l.m_sweep.c=m,l.m_sweep.a=p,l.m_linearVelocity=_,l.m_angularVelocity=d,l.synchronizeTransform()}this.postSolveIsland()},y.prototype.postSolveIsland=function(){for(var t=new g,e=0;e<this.m_contacts.length;++e){for(var i=this.m_contacts[e],o=0;o<i.v_points.length;++o)t.normalImpulses.push(i.v_points[o].normalImpulse),t.tangentImpulses.push(i.v_points[o].tangentImpulse);this.m_world.postSolve(i,t)}}},6972:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=p;var n=i(4896),r=i(2274),s=i(6306),a=i(7929),h=i(2260),c=i(2129),u=i(5878),l=i(8730),m={gravity:s.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function p(t){if(!(this instanceof p))return new p(t);t&&s.isValid(t)&&(t={gravity:t}),t=n(t,m),this.m_solver=new h(this),this.m_broadPhase=new a,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=s.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_stepCount=0,this.addPair=this.createContact.bind(this)}p.prototype._serialize=function(){for(var t=[],e=[],i=this.getBodyList();i;i=i.getNext())t.push(i);for(var o=this.getJointList();o;o=o.getNext())"function"==typeof o._serialize&&e.push(o);return{gravity:this.m_gravity,bodies:t,joints:e}},p._deserialize=function(t,e,i){if(!t)return new p;var o=new p(t.gravity);return t.bodies&&t.bodies.reverse().forEach((function(t){o._addBody(i(c,t,o))})),t.joints&&t.joints.reverse().forEach((function(t){o.createJoint(i(u,t,o))})),o},p.prototype.getBodyList=function(){return this.m_bodyList},p.prototype.getJointList=function(){return this.m_jointList},p.prototype.getContactList=function(){return this.m_contactList},p.prototype.getBodyCount=function(){return this.m_bodyCount},p.prototype.getJointCount=function(){return this.m_jointCount},p.prototype.getContactCount=function(){return this.m_contactCount},p.prototype.setGravity=function(t){this.m_gravity=t},p.prototype.getGravity=function(){return this.m_gravity},p.prototype.isLocked=function(){return this.m_locked},p.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(var e=this.m_bodyList;e;e=e.m_next)e.setAwake(!0)},p.prototype.getAllowSleeping=function(){return this.m_allowSleep},p.prototype.setWarmStarting=function(t){this.m_warmStarting=t},p.prototype.getWarmStarting=function(){return this.m_warmStarting},p.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},p.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},p.prototype.setSubStepping=function(t){this.m_subStepping=t},p.prototype.getSubStepping=function(){return this.m_subStepping},p.prototype.setAutoClearForces=function(t){this.m_clearForces=t},p.prototype.getAutoClearForces=function(){return this.m_clearForces},p.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},p.prototype.queryAABB=function(t,e){o&&r.assert("function"==typeof e);var i=this.m_broadPhase;this.m_broadPhase.query(t,(function(t){var o=i.getUserData(t);return e(o.fixture)}))},p.prototype.rayCast=function(t,e,i){o&&r.assert("function"==typeof i);var n=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:t,p2:e},(function(t,e){var o=n.getUserData(e),r=o.fixture,a=o.childIndex,h={};if(r.rayCast(h,t,a)){var c=h.fraction,u=s.add(s.mul(1-c,t.p1),s.mul(c,t.p2));return i(r,u,h.normal,c)}return t.maxFraction}))},p.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},p.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},p.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},p.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},p.prototype.shiftOrigin=function(t){if(o&&r.assert(0==this.m_locked),!this.m_locked){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(var i=this.m_jointList;i;i=i.m_next)i.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},p.prototype._addBody=function(t){o&&r.assert(!1===this.isLocked()),this.isLocked()||(t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount)},p.prototype.createBody=function(t,e){if(o&&r.assert(0==this.isLocked()),this.isLocked())return null;t&&s.isValid(t)&&(t={position:t,angle:e});var i=new c(this,t);return this._addBody(i),i},p.prototype.createDynamicBody=function(t,e){return t?s.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)},p.prototype.createKinematicBody=function(t,e){return t?s.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)},p.prototype.destroyBody=function(t){if(o&&r.assert(this.m_bodyCount>0),o&&r.assert(0==this.isLocked()),!this.isLocked()){if(t.m_destroyed)return!1;for(var e=t.m_jointList;e;){var i=e;e=e.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;for(var n=t.m_contactList;n;){var s=n;n=n.next,this.destroyContact(s.contact),t.m_contactList=n}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var h=a;a=a.m_next,this.publish("remove-fixture",h),h.destroyProxies(this.m_broadPhase),t.m_fixtureList=a}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0}},p.prototype.createJoint=function(t){if(o&&r.assert(!!t.m_bodyA),o&&r.assert(!!t.m_bodyB),o&&r.assert(0==this.isLocked()),this.isLocked())return null;if(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB,0==t.m_collideConnected)for(var e=t.m_bodyB.getContactList();e;e=e.next)e.other==t.m_bodyA&&e.contact.flagForFiltering();return t},p.prototype.destroyJoint=function(t){if(o&&r.assert(0==this.isLocked()),!this.isLocked()){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var e=t.m_bodyA,i=t.m_bodyB;if(e.setAwake(!0),i.setAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==e.m_jointList&&(e.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==i.m_jointList&&(i.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,o&&r.assert(this.m_jointCount>0),--this.m_jointCount,0==t.m_collideConnected)for(var n=i.getContactList();n;)n.other==e&&n.contact.flagForFiltering(),n=n.next;this.publish("remove-joint",t)}};var _=new h.TimeStep;p.prototype.step=function(t,e,i){if((0|e)!==e&&(e=0),e=e||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_stepCount++,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,_.reset(t),_.velocityIterations=e,_.positionIterations=i,_.warmStarting=this.m_warmStarting,_.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(_);for(var o=this.m_bodyList;o;o=o.getNext())0!=o.m_islandFlag&&(o.isStatic()||o.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(_),this.m_clearForces&&this.clearForces(),this.m_locked=!1},p.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)},p.prototype.createContact=function(t,e){var i=t.fixture,o=e.fixture,n=t.childIndex,r=e.childIndex,s=i.getBody(),a=o.getBody();if(s!=a){for(var h=a.getContactList();h;){if(h.other==s){var c=h.contact.getFixtureA(),u=h.contact.getFixtureB(),m=h.contact.getChildIndexA(),p=h.contact.getChildIndexB();if(c==i&&u==o&&m==n&&p==r)return;if(c==o&&u==i&&m==r&&p==n)return}h=h.next}if(0!=a.shouldCollide(s)&&0!=o.shouldCollide(i)){var _=l.create(i,n,o,r);null!=_&&(_.m_prev=null,null!=this.m_contactList&&(_.m_next=this.m_contactList,this.m_contactList.m_prev=_),this.m_contactList=_,++this.m_contactCount)}}},p.prototype.updateContacts=function(){for(var t,e=this.m_contactList;t=e;){e=t.getNext();var i=t.getFixtureA(),o=t.getFixtureB(),n=t.getChildIndexA(),r=t.getChildIndexB(),s=i.getBody(),a=o.getBody();if(t.m_filterFlag){if(0==a.shouldCollide(s)){this.destroyContact(t);continue}if(0==o.shouldCollide(i)){this.destroyContact(t);continue}t.m_filterFlag=!1}var h=s.isAwake()&&!s.isStatic(),c=a.isAwake()&&!a.isStatic();if(0!=h||0!=c){var u=i.m_proxies[n].proxyId,l=o.m_proxies[r].proxyId;0!=this.m_broadPhase.testOverlap(u,l)?t.update(this):this.destroyContact(t)}}},p.prototype.destroyContact=function(t){l.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount},p.prototype._listeners=null,p.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e||(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)),this},p.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;var i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;var o=i.indexOf(e);return o>=0&&i.splice(o,1),this},p.prototype.publish=function(t,e,i,o){var n=this._listeners&&this._listeners[t];if(!n||!n.length)return 0;for(var r=0;r<n.length;r++)n[r].call(this,e,i,o);return n.length},p.prototype.beginContact=function(t){this.publish("begin-contact",t)},p.prototype.endContact=function(t){this.publish("end-contact",t)},p.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)},p.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)}},3406:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT,r=(i(1099),i(2274)),s=i(5387),a=i(6306);function h(t,e){if(!(this instanceof h))return new h(t,e);this.lowerBound=a.zero(),this.upperBound=a.zero(),"object"==typeof t&&this.lowerBound.set(t),"object"==typeof e?this.upperBound.set(e):"object"==typeof t&&this.upperBound.set(t)}t.exports=h,h.prototype.isValid=function(){return h.isValid(this)},h.isValid=function(t){var e=a.sub(t.upperBound,t.lowerBound);return e.x>=0&&e.y>=0&&a.isValid(t.lowerBound)&&a.isValid(t.upperBound)},h.assert=function(t){if(n&&!h.isValid(t))throw o&&r.debug(t),new Error("Invalid AABB!")},h.prototype.getCenter=function(){return a.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},h.prototype.getExtents=function(){return a.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},h.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},h.prototype.combine=function(t,e){e=e||this;var i=t.lowerBound,o=t.upperBound,n=e.lowerBound,r=e.upperBound,a=s.min(i.x,n.x),h=s.min(i.y,n.y),c=s.max(r.x,o.x),u=s.max(r.y,o.y);this.lowerBound.set(a,h),this.upperBound.set(c,u)},h.prototype.combinePoints=function(t,e){this.lowerBound.set(s.min(t.x,e.x),s.min(t.y,e.y)),this.upperBound.set(s.max(t.x,e.x),s.max(t.y,e.y))},h.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)},h.prototype.contains=function(t){var e=!0;return(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},h.prototype.extend=function(t){return h.extend(this,t),this},h.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e},h.testOverlap=function(t,e){var i=e.lowerBound.x-t.upperBound.x,o=t.lowerBound.x-e.upperBound.x,n=e.lowerBound.y-t.upperBound.y,r=t.lowerBound.y-e.upperBound.y;return!(i>0||n>0||o>0||r>0)},h.areEqual=function(t,e){return a.areEqual(t.lowerBound,e.lowerBound)&&a.areEqual(t.upperBound,e.upperBound)},h.diff=function(t,e){var i=s.max(0,s.min(t.upperBound.x,e.upperBound.x)-s.max(e.lowerBound.x,t.lowerBound.x)),o=s.max(0,s.min(t.upperBound.y,e.upperBound.y)-s.max(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-i*o},h.prototype.rayCast=function(t,e){for(var i=-1/0,o=1/0,n=e.p1,r=a.sub(e.p2,e.p1),h=a.abs(r),c=a.zero(),u="x";null!==u;u="x"===u?"y":null)if(h.x<s.EPSILON){if(n[u]<this.lowerBound[u]||this.upperBound[u]<n[u])return!1}else{var l=1/r[u],m=(this.lowerBound[u]-n[u])*l,p=(this.upperBound[u]-n[u])*l,_=-1;if(m>p){var d=m;m=p,p=d,_=1}if(m>i&&(c.setZero(),c[u]=_,i=m),i>(o=s.min(o,p)))return!1}return!(i<0||e.maxFraction<i||(t.fraction=i,t.normal=c,0))},h.prototype.toString=function(){return JSON.stringify(this)}},7929:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=(i(1099),i(2274)),r=i(5387),s=i(3406),a=i(2454);function h(){this.m_tree=new a,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}t.exports=h,h.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},h.prototype.testOverlap=function(t,e){var i=this.m_tree.getFatAABB(t),o=this.m_tree.getFatAABB(e);return s.testOverlap(i,o)},h.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},h.prototype.getProxyCount=function(){return this.m_proxyCount},h.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},h.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},h.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},h.prototype.query=function(t,e){this.m_tree.query(t,e)},h.prototype.rayCast=function(t,e){this.m_tree.rayCast(t,e)},h.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},h.prototype.createProxy=function(t,e){o&&n.assert(s.isValid(t));var i=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(i),i},h.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)},h.prototype.moveProxy=function(t,e,i){o&&n.assert(s.isValid(e)),this.m_tree.moveProxy(t,e,i)&&this.bufferMove(t)},h.prototype.touchProxy=function(t){this.bufferMove(t)},h.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},h.prototype.unbufferMove=function(t){for(var e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)},h.prototype.updatePairs=function(t){for(o&&n.assert("function"==typeof t),this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),null!==this.m_queryProxyId){var e=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(e,this.queryCallback)}},h.prototype.queryCallback=function(t){if(t==this.m_queryProxyId)return!0;var e=r.min(t,this.m_queryProxyId),i=r.max(t,this.m_queryProxyId),o=this.m_tree.getUserData(e),n=this.m_tree.getUserData(i);return this.m_callback(o,n),!0}},8054:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=_,t.exports.Input=l,t.exports.Output=m,t.exports.Proxy=d,t.exports.Cache=p;var n=i(1099),r=i(2274),s=i(5489),a=i(5387),h=i(6306),c=(i(4470),i(6173),i(7515),i(3766)),u=(i(5385),i(8850));function l(){this.proxyA=new d,this.proxyB=new d,this.transformA=null,this.transformB=null,this.useRadii=!1}function m(){this.pointA=h.zero(),this.pointB=h.zero(),this.distance,this.iterations}function p(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}function _(t,e,i){++s.gjkCalls;var o=i.proxyA,r=i.proxyB,l=i.transformA,m=i.transformB,p=new y;p.readCache(e,o,l,r,m);for(var _=p.m_v,d=n.maxDistnceIterations,f=[],v=[],g=0,b=0;b<d;){g=p.m_count;for(var x=0;x<g;++x)f[x]=_[x].indexA,v[x]=_[x].indexB;if(p.solve(),3==p.m_count)break;(C=p.getClosestPoint()).lengthSquared();var A=p.getSearchDirection();if(A.lengthSquared()<a.EPSILON*a.EPSILON)break;var w=_[p.m_count];w.indexA=o.getSupport(c.mulTVec2(l.q,h.neg(A))),w.wA=u.mulVec2(l,o.getVertex(w.indexA)),w.indexB=r.getSupport(c.mulTVec2(m.q,A)),w.wB=u.mulVec2(m,r.getVertex(w.indexB)),w.w=h.sub(w.wB,w.wA),++b,++s.gjkIters;var B=!1;for(x=0;x<g;++x)if(w.indexA==f[x]&&w.indexB==v[x]){B=!0;break}if(B)break;++p.m_count}if(s.gjkMaxIters=a.max(s.gjkMaxIters,b),p.getWitnessPoints(t.pointA,t.pointB),t.distance=h.distance(t.pointA,t.pointB),t.iterations=b,p.writeCache(e),i.useRadii){var T=o.m_radius,E=r.m_radius;if(t.distance>T+E&&t.distance>a.EPSILON){t.distance-=T+E;var I=h.sub(t.pointB,t.pointA);I.normalize(),t.pointA.addMul(T,I),t.pointB.subMul(E,I)}else{var C=h.mid(t.pointA,t.pointB);t.pointA.set(C),t.pointB.set(C),t.distance=0}}}function d(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}function f(){this.indexA,this.indexB,this.wA=h.zero(),this.wB=h.zero(),this.w=h.zero(),this.a}function y(){this.m_v1=new f,this.m_v2=new f,this.m_v3=new f,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}i(5235),i(8601),s.gjkCalls=0,s.gjkIters=0,s.gjkMaxIters=0,d.prototype.getVertexCount=function(){return this.m_count},d.prototype.getVertex=function(t){return o&&r.assert(0<=t&&t<this.m_count),this.m_vertices[t]},d.prototype.getSupport=function(t){for(var e=0,i=h.dot(this.m_vertices[0],t),o=0;o<this.m_count;++o){var n=h.dot(this.m_vertices[o],t);n>i&&(e=o,i=n)}return e},d.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},d.prototype.set=function(t,e){o&&r.assert("function"==typeof t.computeDistanceProxy),t.computeDistanceProxy(this,e)},f.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA=h.clone(t.wA),this.wB=h.clone(t.wB),this.w=h.clone(t.w),this.a=t.a},y.prototype.print=function(){return 3==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},y.prototype.readCache=function(t,e,i,n,s){o&&r.assert(t.count<=3),this.m_count=t.count;for(var c=0;c<this.m_count;++c){(d=this.m_v[c]).indexA=t.indexA[c],d.indexB=t.indexB[c];var l=e.getVertex(d.indexA),m=n.getVertex(d.indexB);d.wA=u.mulVec2(i,l),d.wB=u.mulVec2(s,m),d.w=h.sub(d.wB,d.wA),d.a=0}if(this.m_count>1){var p=t.metric,_=this.getMetric();(_<.5*p||2*p<_||_<a.EPSILON)&&(this.m_count=0)}var d;0==this.m_count&&((d=this.m_v[0]).indexA=0,d.indexB=0,l=e.getVertex(0),m=n.getVertex(0),d.wA=u.mulVec2(i,l),d.wB=u.mulVec2(s,m),d.w=h.sub(d.wB,d.wA),d.a=1,this.m_count=1)},y.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB},y.prototype.getSearchDirection=function(){switch(this.m_count){case 1:return h.neg(this.m_v1.w);case 2:var t=h.sub(this.m_v2.w,this.m_v1.w);return h.cross(t,h.neg(this.m_v1.w))>0?h.cross(1,t):h.cross(t,1);default:return o&&r.assert(!1),h.zero()}},y.prototype.getClosestPoint=function(){switch(this.m_count){case 0:return o&&r.assert(!1),h.zero();case 1:return h.clone(this.m_v1.w);case 2:return h.combine(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w);case 3:return h.zero();default:return o&&r.assert(!1),h.zero()}},y.prototype.getWitnessPoints=function(t,e){switch(this.m_count){case 0:o&&r.assert(!1);break;case 1:t.set(this.m_v1.wA),e.set(this.m_v1.wB);break;case 2:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.setCombine(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.addMul(this.m_v3.a,this.m_v3.wA),e.set(t);break;default:o&&r.assert(!1)}},y.prototype.getMetric=function(){switch(this.m_count){case 0:return o&&r.assert(!1),0;case 1:return 0;case 2:return h.distance(this.m_v1.w,this.m_v2.w);case 3:return h.cross(h.sub(this.m_v2.w,this.m_v1.w),h.sub(this.m_v3.w,this.m_v1.w));default:return o&&r.assert(!1),0}},y.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break;default:o&&r.assert(!1)}},y.prototype.solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=h.sub(e,t),o=-h.dot(t,i);if(o<=0)return this.m_v1.a=1,void(this.m_count=1);var n=h.dot(e,i);if(n<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);var r=1/(n+o);this.m_v1.a=n*r,this.m_v2.a=o*r,this.m_count=2},y.prototype.solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,o=h.sub(e,t),n=h.dot(t,o),r=h.dot(e,o),s=-n,a=h.sub(i,t),c=h.dot(t,a),u=h.dot(i,a),l=-c,m=h.sub(i,e),p=h.dot(e,m),_=h.dot(i,m),d=-p,f=h.cross(o,a),y=f*h.cross(e,i),v=f*h.cross(i,t),g=f*h.cross(t,e);if(s<=0&&l<=0)return this.m_v1.a=1,void(this.m_count=1);if(r>0&&s>0&&g<=0){var b=1/(r+s);return this.m_v1.a=r*b,this.m_v2.a=s*b,void(this.m_count=2)}if(u>0&&l>0&&v<=0){var x=1/(u+l);return this.m_v1.a=u*x,this.m_v3.a=l*x,this.m_count=2,void this.m_v2.set(this.m_v3)}if(r<=0&&d<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(u<=0&&_<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(_>0&&d>0&&y<=0){var A=1/(_+d);return this.m_v2.a=_*A,this.m_v3.a=d*A,this.m_count=2,void this.m_v1.set(this.m_v3)}var w=1/(y+v+g);this.m_v1.a=y*w,this.m_v2.a=v*w,this.m_v3.a=g*w,this.m_count=3},_.testOverlap=function(t,e,i,o,n,r){var s=new l;s.proxyA.set(t,e),s.proxyB.set(i,o),s.transformA=n,s.transformB=r,s.useRadii=!0;var h=new p,c=new m;return _(c,h,s),c.distance<10*a.EPSILON}},2454:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(1099),r=i(2274),s=i(5706),a=i(6306),h=i(5387),c=i(3406);function u(t){this.id=t,this.aabb=new c,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}function l(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new s({create:function(){return new u}})}t.exports=l,u.prototype.isLeaf=function(){return null==this.child1},l.prototype.getUserData=function(t){var e=this.m_nodes[t];return o&&r.assert(!!e),e.userData},l.prototype.getFatAABB=function(t){var e=this.m_nodes[t];return o&&r.assert(!!e),e.aabb},l.prototype.allocateNode=function(){var t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t},l.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]},l.prototype.createProxy=function(t,e){o&&r.assert(c.isValid(t));var i=this.allocateNode();return i.aabb.set(t),c.extend(i.aabb,n.aabbExtension),i.userData=e,i.height=0,this.insertLeaf(i),i.id},l.prototype.destroyProxy=function(t){var e=this.m_nodes[t];o&&r.assert(!!e),o&&r.assert(e.isLeaf()),this.removeLeaf(e),this.freeNode(e)},l.prototype.moveProxy=function(t,e,i){o&&r.assert(c.isValid(e)),o&&r.assert(!i||a.isValid(i));var s=this.m_nodes[t];return o&&r.assert(!!s),o&&r.assert(s.isLeaf()),!s.aabb.contains(e)&&(this.removeLeaf(s),s.aabb.set(e),e=s.aabb,c.extend(e,n.aabbExtension),i.x<0?e.lowerBound.x+=i.x*n.aabbMultiplier:e.upperBound.x+=i.x*n.aabbMultiplier,i.y<0?e.lowerBound.y+=i.y*n.aabbMultiplier:e.upperBound.y+=i.y*n.aabbMultiplier,this.insertLeaf(s),!0)},l.prototype.insertLeaf=function(t){if(o&&r.assert(c.isValid(t.aabb)),null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);for(var e=t.aabb,i=this.m_root;0==i.isLeaf();){var n=i.child1,s=i.child2,a=i.aabb.getPerimeter(),u=new c;u.combine(i.aabb,e);var l,m,p,_=u.getPerimeter(),d=2*_,f=2*(_-a);if(n.isLeaf())(p=new c).combine(e,n.aabb),l=p.getPerimeter()+f;else{(p=new c).combine(e,n.aabb);var y=n.aabb.getPerimeter();l=p.getPerimeter()-y+f}if(s.isLeaf())(p=new c).combine(e,s.aabb),m=p.getPerimeter()+f;else(p=new c).combine(e,s.aabb),y=s.aabb.getPerimeter(),m=p.getPerimeter()-y+f;if(d<l&&d<m)break;i=l<m?n:s}var v=i,g=v.parent,b=this.allocateNode();for(b.parent=g,b.userData=null,b.aabb.combine(e,v.aabb),b.height=v.height+1,null!=g?(g.child1==v?g.child1=b:g.child2=b,b.child1=v,b.child2=t,v.parent=b,t.parent=b):(b.child1=v,b.child2=t,v.parent=b,t.parent=b,this.m_root=b),i=t.parent;null!=i;)n=(i=this.balance(i)).child1,s=i.child2,o&&r.assert(null!=n),o&&r.assert(null!=s),i.height=1+h.max(n.height,s.height),i.aabb.combine(n.aabb,s.aabb),i=i.parent},l.prototype.removeLeaf=function(t){if(t!=this.m_root){var e,i=t.parent,o=i.parent;if(e=i.child1==t?i.child2:i.child1,null!=o){o.child1==i?o.child1=e:o.child2=e,e.parent=o,this.freeNode(i);for(var n=o;null!=n;){var r=(n=this.balance(n)).child1,s=n.child2;n.aabb.combine(r.aabb,s.aabb),n.height=1+h.max(r.height,s.height),n=n.parent}}else this.m_root=e,e.parent=null,this.freeNode(i)}else this.m_root=null},l.prototype.balance=function(t){o&&r.assert(null!=t);var e=t;if(e.isLeaf()||e.height<2)return t;var i=e.child1,n=e.child2,s=n.height-i.height;if(s>1){var a=n.child1,c=n.child2;return n.child1=e,n.parent=e.parent,e.parent=n,null!=n.parent?n.parent.child1==t?n.parent.child1=n:n.parent.child2=n:this.m_root=n,a.height>c.height?(n.child2=a,e.child2=c,c.parent=e,e.aabb.combine(i.aabb,c.aabb),n.aabb.combine(e.aabb,a.aabb),e.height=1+h.max(i.height,c.height),n.height=1+h.max(e.height,a.height)):(n.child2=c,e.child2=a,a.parent=e,e.aabb.combine(i.aabb,a.aabb),n.aabb.combine(e.aabb,c.aabb),e.height=1+h.max(i.height,a.height),n.height=1+h.max(e.height,c.height)),n}if(s<-1){var u=i.child1,l=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1==e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,u.height>l.height?(i.child2=u,e.child1=l,l.parent=e,e.aabb.combine(n.aabb,l.aabb),i.aabb.combine(e.aabb,u.aabb),e.height=1+h.max(n.height,l.height),i.height=1+h.max(e.height,u.height)):(i.child2=l,e.child1=u,u.parent=e,e.aabb.combine(n.aabb,u.aabb),i.aabb.combine(e.aabb,l.aabb),e.height=1+h.max(n.height,u.height),i.height=1+h.max(e.height,l.height)),i}return e},l.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},l.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;for(var t,e=this.m_root.aabb.getPerimeter(),i=0,o=_.allocate().preorder(this.m_root);t=o.next();)t.height<0||(i+=t.aabb.getPerimeter());return _.release(o),i/e},l.prototype.computeHeight=function(t){var e;if((e=void 0!==t?this.m_nodes[t]:this.m_root).isLeaf())return 0;var i=this.computeHeight(e.child1.id),o=this.computeHeight(e.child2.id);return 1+h.max(i,o)},l.prototype.validateStructure=function(t){if(null!=t){t==this.m_root&&o&&r.assert(null==t.parent);var e=t.child1,i=t.child2;if(t.isLeaf())return o&&r.assert(null==e),o&&r.assert(null==i),void(o&&r.assert(0==t.height));o&&r.assert(e.parent==t),o&&r.assert(i.parent==t),this.validateStructure(e),this.validateStructure(i)}},l.prototype.validateMetrics=function(t){if(null!=t){var e=t.child1,i=t.child2;if(t.isLeaf())return o&&r.assert(null==e),o&&r.assert(null==i),void(o&&r.assert(0==t.height));var n=e.height,s=i.height,a=1+h.max(n,s);o&&r.assert(t.height==a);var u=new c;u.combine(e.aabb,i.aabb),o&&r.assert(c.areEqual(u,t.aabb)),this.validateMetrics(e),this.validateMetrics(i)}},l.prototype.validate=function(){this.validateStructure(this.m_root),this.validateMetrics(this.m_root),o&&r.assert(this.getHeight()==this.computeHeight())},l.prototype.getMaxBalance=function(){for(var t,e=0,i=_.allocate().preorder(this.m_root);t=i.next();)if(!(t.height<=1)){o&&r.assert(0==t.isLeaf());var n=h.abs(t.child2.height-t.child1.height);e=h.max(e,n)}return _.release(i),e},l.prototype.rebuildBottomUp=function(){for(var t,e=[],i=0,o=_.allocate().preorder(this.m_root);t=o.next();)t.height<0||(t.isLeaf()?(t.parent=null,e[i]=t,++i):this.freeNode(t));for(_.release(o);i>1;){for(var n=1/0,r=-1,s=-1,a=0;a<i;++a)for(var u=e[a].aabb,l=a+1;l<i;++l){var m=e[l].aabb,p=new c;p.combine(u,m);var d=p.getPerimeter();d<n&&(r=a,s=l,n=d)}var f=e[r],y=e[s],v=this.allocateNode();v.child1=f,v.child2=y,v.height=1+h.max(f.height,y.height),v.aabb.combine(f.aabb,y.aabb),v.parent=null,f.parent=v,y.parent=v,e[s]=e[i-1],e[r]=v,--i}this.m_root=e[0],this.validate()},l.prototype.shiftOrigin=function(t){for(var e,i=_.allocate().preorder(this.m_root);e=i.next();){var o=e.aabb;o.lowerBound.x-=t.x,o.lowerBound.y-=t.y,o.upperBound.x-=t.x,o.upperBound.y-=t.y}_.release(i)},l.prototype.query=function(t,e){o&&r.assert("function"==typeof e);var i=p.allocate();for(i.push(this.m_root);i.length>0;){var n=i.pop();if(null!=n&&c.testOverlap(n.aabb,t))if(n.isLeaf()){if(0==e(n.id))return}else i.push(n.child1),i.push(n.child2)}p.release(i)},l.prototype.rayCast=function(t,e){o&&r.assert("function"==typeof e);var i=t.p1,n=t.p2,s=a.sub(n,i);o&&r.assert(s.lengthSquared()>0),s.normalize();var u=a.cross(1,s),l=a.abs(u),_=t.maxFraction,d=new c,f=a.combine(1-_,i,_,n);d.combinePoints(i,f);var y=p.allocate(),v=m.allocate();for(y.push(this.m_root);y.length>0;){var g=y.pop();if(null!=g&&0!=c.testOverlap(g.aabb,d)){var b=g.aabb.getCenter(),x=g.aabb.getExtents();if(!(h.abs(a.dot(u,a.sub(i,b)))-a.dot(l,x)>0))if(g.isLeaf()){v.p1=a.clone(t.p1),v.p2=a.clone(t.p2),v.maxFraction=_;var A=e(v,g.id);if(0==A)return;A>0&&(_=A,f=a.combine(1-_,i,_,n),d.combinePoints(i,f))}else y.push(g.child1),y.push(g.child2)}}p.release(y),m.release(v)};var m=new s({create:function(){return{}},release:function(t){}}),p=new s({create:function(){return[]},release:function(t){t.length=0}}),_=new s({create:function(){return new d},release:function(t){t.close()}});function d(){var t=[],e=[];return{preorder:function(i){return t.length=0,t.push(i),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){var i=t.length-1,o=t[i];if(0===e[i])return e[i]=1,o;if(1===e[i]&&(e[i]=2,o.child1))return t.push(o.child1),e.push(1),o.child1;if(2===e[i]&&(e[i]=3,o.child2))return t.push(o.child2),e.push(1),o.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}},8650:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=function(t,e){var i=s.now();++a.toiCalls,t.state=v.e_unknown,t.t=e.tMax;var c=e.proxyA,u=e.proxyB,l=e.sweepA,f=e.sweepB;l.normalize(),f.normalize();var b=e.tMax,x=c.m_radius+u.m_radius,A=h.max(n.linearSlop,x-3*n.linearSlop),w=.25*n.linearSlop;o&&r.assert(A>w);var B=0,T=n.maxTOIIterations,E=0,I=new y,C=new _;for(C.proxyA=e.proxyA,C.proxyB=e.proxyB,C.useRadii=!1;;){var S=m.identity(),M=m.identity();l.getTransform(S,B),f.getTransform(M,B),C.transformA=S,C.transformB=M;var P=new d;if(p(P,I,C),P.distance<=0){t.state=v.e_overlapped,t.t=0;break}if(P.distance<A+w){t.state=v.e_touching,t.t=B;break}var D=new g;D.initialize(I,c,l,u,f,B);for(var O=!1,L=b,V=0;;){var N=D.findMinSeparation(L);if(D.indexA,D.indexB,N>A+w){t.state=v.e_separated,t.t=b,O=!0;break}if(N>A-w){B=L;break}var F=D.evaluate(B);if(D.indexA,D.indexB,F<A-w){t.state=v.e_failed,t.t=B,O=!0;break}if(F<=A+w){t.state=v.e_touching,t.t=B,O=!0;break}for(var z=0,R=B,k=L;;){var q;q=1&z?R+(A-F)*(k-R)/(N-F):.5*(R+k),++z,++a.toiRootIters;var j=D.evaluate(q);if(D.indexA,D.indexB,h.abs(j-A)<w){L=q;break}if(j>A?(R=q,F=j):(k=q,N=j),50==z)break}if(a.toiMaxRootIters=h.max(a.toiMaxRootIters,z),++V==n.maxPolygonVertices)break}if(++E,++a.toiIters,O)break;if(E==T){t.state=v.e_failed,t.t=B;break}}a.toiMaxIters=h.max(a.toiMaxIters,E);var U=s.diff(i);a.toiMaxTime=h.max(a.toiMaxTime,U),a.toiTime+=U},t.exports.Input=function(){this.proxyA=new f,this.proxyB=new f,this.sweepA=new l,this.sweepB=new l,this.tMax},t.exports.Output=v;var n=i(1099),r=i(2274),s=i(9205),a=i(5489),h=i(5387),c=i(6306),u=(i(4470),i(6173),i(7515),i(3766)),l=i(5385),m=i(8850),p=(i(5235),i(8601),i(8054)),_=p.Input,d=p.Output,f=p.Proxy,y=p.Cache;function v(){this.state,this.t}function g(){this.m_proxyA=new f,this.m_proxyB=new f,this.m_sweepA,this.m_sweepB,this.indexA,this.indexB,this.m_type,this.m_localPoint=c.zero(),this.m_axis=c.zero()}v.e_unknown=0,v.e_failed=1,v.e_overlapped=2,v.e_touching=3,v.e_separated=4,a.toiTime=0,a.toiMaxTime=0,a.toiCalls=0,a.toiIters=0,a.toiMaxIters=0,a.toiRootIters=0,a.toiMaxRootIters=0,g.prototype.initialize=function(t,e,i,n,s,a){this.m_proxyA=e,this.m_proxyB=n;var h=t.count;o&&r.assert(0<h&&h<3),this.m_sweepA=i,this.m_sweepB=s;var l=m.identity(),p=m.identity();if(this.m_sweepA.getTransform(l,a),this.m_sweepB.getTransform(p,a),1==h){this.m_type=1;var _=this.m_proxyA.getVertex(t.indexA[0]),d=this.m_proxyB.getVertex(t.indexB[0]),f=m.mulVec2(l,_),y=m.mulVec2(p,d);return this.m_axis.setCombine(1,y,-1,f),this.m_axis.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=3;var v=n.getVertex(t.indexB[0]),g=n.getVertex(t.indexB[1]);this.m_axis=c.cross(c.sub(g,v),1),this.m_axis.normalize();var b=u.mulVec2(p.q,this.m_axis);return this.m_localPoint=c.mid(v,g),y=m.mulVec2(p,this.m_localPoint),_=e.getVertex(t.indexA[0]),f=m.mulVec2(l,_),(x=c.dot(f,b)-c.dot(y,b))<0&&(this.m_axis=c.neg(this.m_axis),x=-x),x}this.m_type=2;var x,A=this.m_proxyA.getVertex(t.indexA[0]),w=this.m_proxyA.getVertex(t.indexA[1]);return this.m_axis=c.cross(c.sub(w,A),1),this.m_axis.normalize(),b=u.mulVec2(l.q,this.m_axis),this.m_localPoint=c.mid(A,w),f=m.mulVec2(l,this.m_localPoint),d=this.m_proxyB.getVertex(t.indexB[0]),y=m.mulVec2(p,d),(x=c.dot(y,b)-c.dot(f,b))<0&&(this.m_axis=c.neg(this.m_axis),x=-x),x},g.prototype.compute=function(t,e){var i=m.identity(),n=m.identity();switch(this.m_sweepA.getTransform(i,e),this.m_sweepB.getTransform(n,e),this.m_type){case 1:if(t){var s=u.mulTVec2(i.q,this.m_axis),a=u.mulTVec2(n.q,c.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(s),this.indexB=this.m_proxyB.getSupport(a)}var h=this.m_proxyA.getVertex(this.indexA),l=this.m_proxyB.getVertex(this.indexB),p=m.mulVec2(i,h),_=m.mulVec2(n,l);return c.dot(_,this.m_axis)-c.dot(p,this.m_axis);case 2:var d=u.mulVec2(i.q,this.m_axis);return p=m.mulVec2(i,this.m_localPoint),t&&(a=u.mulTVec2(n.q,c.neg(d)),this.indexA=-1,this.indexB=this.m_proxyB.getSupport(a)),l=this.m_proxyB.getVertex(this.indexB),_=m.mulVec2(n,l),c.dot(_,d)-c.dot(p,d);case 3:return d=u.mulVec2(n.q,this.m_axis),_=m.mulVec2(n,this.m_localPoint),t&&(s=u.mulTVec2(i.q,c.neg(d)),this.indexB=-1,this.indexA=this.m_proxyA.getSupport(s)),h=this.m_proxyA.getVertex(this.indexA),p=m.mulVec2(i,h),c.dot(p,d)-c.dot(_,d);default:return o&&r.assert(!1),t&&(this.indexA=-1,this.indexB=-1),0}},g.prototype.findMinSeparation=function(t){return this.compute(!0,t)},g.prototype.evaluate=function(t){return this.compute(!1,t)}},6173:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var r=i(2274),s=(i(5387),i(6306));function a(t,e,i,o){"object"==typeof t&&null!==t?(this.ex=s.clone(t),this.ey=s.clone(e)):"number"==typeof t?(this.ex=s.neo(t,i),this.ey=s.neo(e,o)):(this.ex=s.zero(),this.ey=s.zero())}a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isValid(t.ex)&&s.isValid(t.ey)},a.assert=function(t){if(n&&!a.isValid(t))throw o&&r.debug(t),new Error("Invalid Mat22!")},a.prototype.set=function(t,e,i,o){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof o?(this.ex.set(t,i),this.ey.set(e,o)):"object"==typeof t&&"object"==typeof e?(this.ex.set(t),this.ey.set(e)):"object"==typeof t?(n&&a.assert(t),this.ex.set(t.ex),this.ey.set(t.ey)):n&&r.assert(!1)},a.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},a.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},a.prototype.getInverse=function(){var t=this.ex.x,e=this.ey.x,i=this.ex.y,o=this.ey.y,n=t*o-e*i;0!=n&&(n=1/n);var r=new a;return r.ex.x=n*o,r.ey.x=-n*e,r.ex.y=-n*i,r.ey.y=n*t,r},a.prototype.solve=function(t){n&&s.assert(t);var e=this.ex.x,i=this.ey.x,o=this.ex.y,r=this.ey.y,a=e*r-i*o;0!=a&&(a=1/a);var h=s.zero();return h.x=a*(r*t.x-i*t.y),h.y=a*(e*t.y-o*t.x),h},a.mul=function(t,e){if(e&&"x"in e&&"y"in e){n&&s.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}if(e&&"ex"in e&&"ey"in e)return n&&a.assert(e),new a(t.ex.x*e.ex.x+t.ey.x*e.ex.y,t.ex.x*e.ey.x+t.ey.x*e.ey.y,t.ex.y*e.ex.x+t.ey.y*e.ex.y,t.ex.y*e.ey.x+t.ey.y*e.ey.y);n&&r.assert(!1)},a.mulVec2=function(t,e){n&&s.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)},a.mulMat22=function(t,e){return n&&a.assert(e),new a(t.ex.x*e.ex.x+t.ey.x*e.ex.y,t.ex.x*e.ey.x+t.ey.x*e.ey.y,t.ex.y*e.ex.x+t.ey.y*e.ex.y,t.ex.y*e.ey.x+t.ey.y*e.ey.y)},a.mulT=function(t,e){return e&&"x"in e&&"y"in e?(n&&s.assert(e),s.neo(s.dot(e,t.ex),s.dot(e,t.ey))):e&&"ex"in e&&"ey"in e?(n&&a.assert(e),new a(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))):void(n&&r.assert(!1))},a.mulTVec2=function(t,e){return n&&a.assert(t),n&&s.assert(e),s.neo(s.dot(e,t.ex),s.dot(e,t.ey))},a.mulTMat22=function(t,e){return n&&a.assert(t),n&&a.assert(e),new a(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))},a.abs=function(t){return n&&a.assert(t),new a(s.abs(t.ex),s.abs(t.ey))},a.add=function(t,e){return n&&a.assert(t),n&&a.assert(e),new a(s.add(t.ex,e.ex),s.add(t.ey,e.ey))}},7515:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var r=i(2274),s=(i(5387),i(6306)),a=i(4470);function h(t,e,i){"object"==typeof t&&null!==t?(this.ex=a.clone(t),this.ey=a.clone(e),this.ez=a.clone(i)):(this.ex=a(),this.ey=a(),this.ez=a())}h.prototype.toString=function(){return JSON.stringify(this)},h.isValid=function(t){return t&&a.isValid(t.ex)&&a.isValid(t.ey)&&a.isValid(t.ez)},h.assert=function(t){if(n&&!h.isValid(t))throw o&&r.debug(t),new Error("Invalid Mat33!")},h.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},h.prototype.solve33=function(t){var e=a.dot(this.ex,a.cross(this.ey,this.ez));0!=e&&(e=1/e);var i=new a;return i.x=e*a.dot(t,a.cross(this.ey,this.ez)),i.y=e*a.dot(this.ex,a.cross(t,this.ez)),i.z=e*a.dot(this.ex,a.cross(this.ey,t)),i},h.prototype.solve22=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y,r=e*n-i*o;0!=r&&(r=1/r);var a=s.zero();return a.x=r*(n*t.x-i*t.y),a.y=r*(e*t.y-o*t.x),a},h.prototype.getInverse22=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y,r=e*n-i*o;0!=r&&(r=1/r),t.ex.x=r*n,t.ey.x=-r*i,t.ex.z=0,t.ex.y=-r*o,t.ey.y=r*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},h.prototype.getSymInverse33=function(t){var e=a.dot(this.ex,a.cross(this.ey,this.ez));0!=e&&(e=1/e);var i=this.ex.x,o=this.ey.x,n=this.ez.x,r=this.ey.y,s=this.ez.y,h=this.ez.z;t.ex.x=e*(r*h-s*s),t.ex.y=e*(n*s-o*h),t.ex.z=e*(o*s-n*r),t.ey.x=t.ex.y,t.ey.y=e*(i*h-n*n),t.ey.z=e*(n*o-i*s),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*r-o*o)},h.mul=function(t,e){if(n&&h.assert(t),e&&"z"in e&&"y"in e&&"x"in e){n&&a.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,o=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,c=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new a(i,o,c)}if(e&&"y"in e&&"x"in e)return n&&s.assert(e),i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y,s.neo(i,o);n&&r.assert(!1)},h.mulVec3=function(t,e){n&&h.assert(t),n&&a.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,o=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,r=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new a(i,o,r)},h.mulVec2=function(t,e){n&&h.assert(t),n&&s.assert(e);var i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)},h.add=function(t,e){return n&&h.assert(t),n&&h.assert(e),new h(a.add(t.ex,e.ex),a.add(t.ey,e.ey),a.add(t.ez,e.ez))}},5387:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT,r=i(2274),s=i(4175),a=Math,h=t.exports=s(a);h.EPSILON=1e-9,h.isFinite=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},h.assert=function(t){if(n&&!h.isFinite(t))throw o&&r.debug(t),new Error("Invalid Number!")},h.invSqrt=function(t){return 1/a.sqrt(t)},h.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16)},h.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},h.mod=function(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)},h.clamp=function(t,e,i){return t<e?e:t>i?i:t},h.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:a.random()*(e-t)+t}},8601:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=r;var o=i(6306),n=i(3766);function r(){this.c=o.zero(),this.a=0}r.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.set(o.sub(this.c,n.mulVec2(t.q,e))),t}},3766:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var r=i(2274),s=i(6306),a=i(5387);function h(t){if(!(this instanceof h))return new h(t);"number"==typeof t?this.setAngle(t):"object"==typeof t?this.set(t):this.setIdentity()}h.neo=function(t){var e=Object.create(h.prototype);return e.setAngle(t),e},h.clone=function(t){n&&h.assert(t);var e=Object.create(h.prototype);return e.s=t.s,e.c=t.c,e},h.identity=function(){var t=Object.create(h.prototype);return t.s=0,t.c=1,t},h.isValid=function(t){return t&&a.isFinite(t.s)&&a.isFinite(t.c)},h.assert=function(t){if(n&&!h.isValid(t))throw o&&r.debug(t),new Error("Invalid Rot!")},h.prototype.setIdentity=function(){this.s=0,this.c=1},h.prototype.set=function(t){"object"==typeof t?(n&&h.assert(t),this.s=t.s,this.c=t.c):(n&&a.assert(t),this.s=a.sin(t),this.c=a.cos(t))},h.prototype.setAngle=function(t){n&&a.assert(t),this.s=a.sin(t),this.c=a.cos(t)},h.prototype.getAngle=function(){return a.atan2(this.s,this.c)},h.prototype.getXAxis=function(){return s.neo(this.c,this.s)},h.prototype.getYAxis=function(){return s.neo(-this.s,this.c)},h.mul=function(t,e){if(n&&h.assert(t),"c"in e&&"s"in e){n&&h.assert(e);var i=h.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i}if("x"in e&&"y"in e)return n&&s.assert(e),s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},h.mulRot=function(t,e){n&&h.assert(t),n&&h.assert(e);var i=h.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i},h.mulVec2=function(t,e){return n&&h.assert(t),n&&s.assert(e),s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},h.mulSub=function(t,e,i){var o=t.c*(e.x-i.x)-t.s*(e.y-i.y),n=t.s*(e.x-i.x)+t.c*(e.y-i.y);return s.neo(o,n)},h.mulT=function(t,e){if("c"in e&&"s"in e){n&&h.assert(e);var i=h.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i}if("x"in e&&"y"in e)return n&&s.assert(e),s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},h.mulTRot=function(t,e){n&&h.assert(e);var i=h.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i},h.mulTVec2=function(t,e){return n&&s.assert(e),s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}},5385:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=c;var n=i(2274),r=i(5387),s=i(6306),a=i(3766),h=i(8850);function c(t,e){o&&n.assert(void 0===t),o&&n.assert(void 0===e),this.localCenter=s.zero(),this.c=s.zero(),this.a=0,this.alpha0=0,this.c0=s.zero(),this.a0=0}c.prototype.setTransform=function(t){var e=h.mulVec2(t,this.localCenter);this.c.set(e),this.c0.set(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()},c.prototype.setLocalCenter=function(t,e){this.localCenter.set(t);var i=h.mulVec2(e,this.localCenter);this.c.set(i),this.c0.set(i)},c.prototype.getTransform=function(t,e){e=void 0===e?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.setCombine(1-e,this.c0,e,this.c),t.p.sub(a.mulVec2(t.q,this.localCenter))},c.prototype.advance=function(t){o&&n.assert(this.alpha0<1);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.setCombine(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},c.prototype.forward=function(){this.a0=this.a,this.c0.set(this.c)},c.prototype.normalize=function(){var t=r.mod(this.a0,-r.PI,+r.PI);this.a-=this.a0-t,this.a0=t},c.prototype.clone=function(){var t=new c;return t.localCenter.set(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.set(this.c0),t.c.set(this.c),t},c.prototype.set=function(t){this.localCenter.set(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.set(t.c0),this.c.set(t.c)}},8850:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var r=i(2274),s=i(6306),a=i(3766);function h(t,e){if(!(this instanceof h))return new h(t,e);this.p=s.zero(),this.q=a.identity(),void 0!==t&&this.p.set(t),void 0!==e&&this.q.set(e)}h.clone=function(t){var e=Object.create(h.prototype);return e.p=s.clone(t.p),e.q=a.clone(t.q),e},h.neo=function(t,e){var i=Object.create(h.prototype);return i.p=s.clone(t),i.q=a.clone(e),i},h.identity=function(){var t=Object.create(h.prototype);return t.p=s.zero(),t.q=a.identity(),t},h.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},h.prototype.set=function(t,e){void 0===e?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))},h.isValid=function(t){return t&&s.isValid(t.p)&&a.isValid(t.q)},h.assert=function(t){if(n&&!h.isValid(t))throw o&&r.debug(t),new Error("Invalid Transform!")},h.mul=function(t,e){if(n&&h.assert(t),Array.isArray(e)){for(var i=[],o=0;o<e.length;o++)i[o]=h.mul(t,e[o]);return i}if("x"in e&&"y"in e){n&&s.assert(e);var r=t.q.c*e.x-t.q.s*e.y+t.p.x,c=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(r,c)}if("p"in e&&"q"in e){n&&h.assert(e);var u=h.identity();return u.q=a.mulRot(t.q,e.q),u.p=s.add(a.mulVec2(t.q,e.p),t.p),u}},h.mulAll=function(t,e){n&&h.assert(t);for(var i=[],o=0;o<e.length;o++)i[o]=h.mul(t,e[o]);return i},h.mulFn=function(t){return n&&h.assert(t),function(e){return h.mul(t,e)}},h.mulVec2=function(t,e){n&&h.assert(t),n&&s.assert(e);var i=t.q.c*e.x-t.q.s*e.y+t.p.x,o=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(i,o)},h.mulXf=function(t,e){n&&h.assert(t),n&&h.assert(e);var i=h.identity();return i.q=a.mulRot(t.q,e.q),i.p=s.add(a.mulVec2(t.q,e.p),t.p),i},h.mulT=function(t,e){if(n&&h.assert(t),"x"in e&&"y"in e){n&&s.assert(e);var i=e.x-t.p.x,o=e.y-t.p.y,r=t.q.c*i+t.q.s*o,c=-t.q.s*i+t.q.c*o;return s.neo(r,c)}if("p"in e&&"q"in e){n&&h.assert(e);var u=h.identity();return u.q.set(a.mulTRot(t.q,e.q)),u.p.set(a.mulTVec2(t.q,s.sub(e.p,t.p))),u}},h.mulTVec2=function(t,e){n&&h.assert(t),n&&s.assert(e);var i=e.x-t.p.x,o=e.y-t.p.y,r=t.q.c*i+t.q.s*o,a=-t.q.s*i+t.q.c*o;return s.neo(r,a)},h.mulTXf=function(t,e){n&&h.assert(t),n&&h.assert(e);var i=h.identity();return i.q.set(a.mulTRot(t.q,e.q)),i.p.set(a.mulTVec2(t.q,s.sub(e.p,t.p))),i}},6306:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var r=i(2274),s=i(5387);function a(t,e){if(!(this instanceof a))return new a(t,e);void 0===t?(this.x=0,this.y=0):"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),n&&a.assert(this)}a.prototype._serialize=function(){return{x:this.x,y:this.y}},a._deserialize=function(t){var e=Object.create(a.prototype);return e.x=t.x,e.y=t.y,e},a.zero=function(){var t=Object.create(a.prototype);return t.x=0,t.y=0,t},a.neo=function(t,e){var i=Object.create(a.prototype);return i.x=t,i.y=e,i},a.clone=function(t){return n&&a.assert(t),a.neo(t.x,t.y)},a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)},a.assert=function(t){if(n&&!a.isValid(t))throw o&&r.debug(t),new Error("Invalid Vec2!")},a.prototype.clone=function(){return a.clone(this)},a.prototype.setZero=function(){return this.x=0,this.y=0,this},a.prototype.set=function(t,e){return"object"==typeof t?(n&&a.assert(t),this.x=t.x,this.y=t.y):(n&&s.assert(t),n&&s.assert(e),this.x=t,this.y=e),this},a.prototype.wSet=function(t,e,i,o){return void 0!==i||void 0!==o?this.setCombine(t,e,i,o):this.setMul(t,e)},a.prototype.setCombine=function(t,e,i,o){n&&s.assert(t),n&&a.assert(e),n&&s.assert(i),n&&a.assert(o);var r=t*e.x+i*o.x,h=t*e.y+i*o.y;return this.x=r,this.y=h,this},a.prototype.setMul=function(t,e){n&&s.assert(t),n&&a.assert(e);var i=t*e.x,o=t*e.y;return this.x=i,this.y=o,this},a.prototype.add=function(t){return n&&a.assert(t),this.x+=t.x,this.y+=t.y,this},a.prototype.wAdd=function(t,e,i,o){return void 0!==i||void 0!==o?this.addCombine(t,e,i,o):this.addMul(t,e)},a.prototype.addCombine=function(t,e,i,o){n&&s.assert(t),n&&a.assert(e),n&&s.assert(i),n&&a.assert(o);var r=t*e.x+i*o.x,h=t*e.y+i*o.y;return this.x+=r,this.y+=h,this},a.prototype.addMul=function(t,e){n&&s.assert(t),n&&a.assert(e);var i=t*e.x,o=t*e.y;return this.x+=i,this.y+=o,this},a.prototype.wSub=function(t,e,i,o){return void 0!==i||void 0!==o?this.subCombine(t,e,i,o):this.subMul(t,e)},a.prototype.subCombine=function(t,e,i,o){n&&s.assert(t),n&&a.assert(e),n&&s.assert(i),n&&a.assert(o);var r=t*e.x+i*o.x,h=t*e.y+i*o.y;return this.x-=r,this.y-=h,this},a.prototype.subMul=function(t,e){n&&s.assert(t),n&&a.assert(e);var i=t*e.x,o=t*e.y;return this.x-=i,this.y-=o,this},a.prototype.sub=function(t){return n&&a.assert(t),this.x-=t.x,this.y-=t.y,this},a.prototype.mul=function(t){return n&&s.assert(t),this.x*=t,this.y*=t,this},a.prototype.length=function(){return a.lengthOf(this)},a.prototype.lengthSquared=function(){return a.lengthSquared(this)},a.prototype.normalize=function(){var t=this.length();if(t<s.EPSILON)return 0;var e=1/t;return this.x*=e,this.y*=e,t},a.lengthOf=function(t){return n&&a.assert(t),s.sqrt(t.x*t.x+t.y*t.y)},a.lengthSquared=function(t){return n&&a.assert(t),t.x*t.x+t.y*t.y},a.distance=function(t,e){n&&a.assert(t),n&&a.assert(e);var i=t.x-e.x,o=t.y-e.y;return s.sqrt(i*i+o*o)},a.distanceSquared=function(t,e){n&&a.assert(t),n&&a.assert(e);var i=t.x-e.x,o=t.y-e.y;return i*i+o*o},a.areEqual=function(t,e){return n&&a.assert(t),n&&a.assert(e),t==e||"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y},a.skew=function(t){return n&&a.assert(t),a.neo(-t.y,t.x)},a.dot=function(t,e){return n&&a.assert(t),n&&a.assert(e),t.x*e.x+t.y*e.y},a.cross=function(t,e){return"number"==typeof e?(n&&a.assert(t),n&&s.assert(e),a.neo(e*t.y,-e*t.x)):"number"==typeof t?(n&&s.assert(t),n&&a.assert(e),a.neo(-t*e.y,t*e.x)):(n&&a.assert(t),n&&a.assert(e),t.x*e.y-t.y*e.x)},a.addCross=function(t,e,i){return"number"==typeof i?(n&&a.assert(e),n&&s.assert(i),a.neo(i*e.y+t.x,-i*e.x+t.y)):"number"==typeof e?(n&&s.assert(e),n&&a.assert(i),a.neo(-e*i.y+t.x,e*i.x+t.y)):void(n&&r.assert(!1))},a.add=function(t,e){return n&&a.assert(t),n&&a.assert(e),a.neo(t.x+e.x,t.y+e.y)},a.wAdd=function(t,e,i,o){return void 0!==i||void 0!==o?a.combine(t,e,i,o):a.mul(t,e)},a.combine=function(t,e,i,o){return a.zero().setCombine(t,e,i,o)},a.sub=function(t,e){return n&&a.assert(t),n&&a.assert(e),a.neo(t.x-e.x,t.y-e.y)},a.mul=function(t,e){return"object"==typeof t?(n&&a.assert(t),n&&s.assert(e),a.neo(t.x*e,t.y*e)):"object"==typeof e?(n&&s.assert(t),n&&a.assert(e),a.neo(t*e.x,t*e.y)):void 0},a.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},a.neg=function(t){return n&&a.assert(t),a.neo(-t.x,-t.y)},a.abs=function(t){return n&&a.assert(t),a.neo(s.abs(t.x),s.abs(t.y))},a.mid=function(t,e){return n&&a.assert(t),n&&a.assert(e),a.neo(.5*(t.x+e.x),.5*(t.y+e.y))},a.upper=function(t,e){return n&&a.assert(t),n&&a.assert(e),a.neo(s.max(t.x,e.x),s.max(t.y,e.y))},a.lower=function(t,e){return n&&a.assert(t),n&&a.assert(e),a.neo(s.min(t.x,e.x),s.min(t.y,e.y))},a.prototype.clamp=function(t){var e=this.x*this.x+this.y*this.y;if(e>t*t){var i=s.invSqrt(e);this.x*=i*t,this.y*=i*t}return this},a.clamp=function(t,e){return(t=a.neo(t.x,t.y)).clamp(e),t},a.scaleFn=function(t,e){return function(i){return a.neo(i.x*t,i.y*e)}},a.translateFn=function(t,e){return function(i){return a.neo(i.x+t,i.y+e)}}},4470:(t,e,i)=>{var o="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var r=i(2274),s=i(5387);function a(t,e,i){if(!(this instanceof a))return new a(t,e,i);void 0===t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),n&&a.assert(this)}a.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}},a._deserialize=function(t){var e=Object.create(a.prototype);return e.x=t.x,e.y=t.y,e.z=t.z,e},a.neo=function(t,e,i){var o=Object.create(a.prototype);return o.x=t,o.y=e,o.z=i,o},a.clone=function(t){return n&&a.assert(t),a.neo(t.x,t.y,t.z)},a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)&&s.isFinite(t.z)},a.assert=function(t){if(n&&!a.isValid(t))throw o&&r.debug(t),new Error("Invalid Vec3!")},a.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},a.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},a.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},a.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},a.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},a.areEqual=function(t,e){return n&&a.assert(t),n&&a.assert(e),t==e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y&&t.z===e.z},a.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},a.cross=function(t,e){return new a(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},a.add=function(t,e){return new a(t.x+e.x,t.y+e.y,t.z+e.z)},a.sub=function(t,e){return new a(t.x-e.x,t.y-e.y,t.z-e.z)},a.mul=function(t,e){return new a(e*t.x,e*t.y,e*t.z)},a.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},a.neg=function(t){return new a(-t.x,-t.y,-t.z)}},5235:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=function(){this.v=o.zero(),this.w=0};var o=i(6306)},5489:(t,e)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,e.toString=function(t){t="string"==typeof t?t:"\n";var e="";for(var i in this)"function"!=typeof this[i]&&"object"!=typeof this[i]&&(e+=i+": "+this[i]+t);return e}},3875:(t,e,i)=>{e.internal={},e.Serializer=i(2134),e.Math=i(5387),e.Vec2=i(6306),e.Vec3=i(4470),e.Mat22=i(6173),e.Mat33=i(7515),e.Transform=i(8850),e.Rot=i(3766),e.AABB=i(3406),e.Shape=i(2322),e.Fixture=i(662),e.Body=i(2129),e.Contact=i(8730),e.Joint=i(5878),e.World=i(6972),e.Circle=i(3335),e.Edge=i(3581),e.Polygon=i(8901),e.Chain=i(2642),e.Box=i(7639),i(8871),i(1867),e.internal.CollidePolygons=i(6891),i(9415),i(9221),e.DistanceJoint=i(3343),e.FrictionJoint=i(342),e.GearJoint=i(155),e.MotorJoint=i(2371),e.MouseJoint=i(1952),e.PrismaticJoint=i(7200),e.PulleyJoint=i(9087),e.RevoluteJoint=i(8087),e.RopeJoint=i(1347),e.WeldJoint=i(1415),e.WheelJoint=i(2707),e.internal.Sweep=i(5385),e.internal.stats=i(5489),e.internal.Manifold=i(226),e.internal.Distance=i(8054),e.internal.TimeOfImpact=i(8650),e.internal.DynamicTree=i(2454),e.internal.Settings=i(1099)},3343:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=m;var o=i(4896),n=i(4175),r=i(1099),s=i(5387),a=i(6306),h=(i(4470),i(6173),i(7515),i(3766)),c=(i(5385),i(8850),i(5235),i(8601),i(5878)),u=i(2129);m.TYPE="distance-joint",c.TYPES[m.TYPE]=m,m._super=c,m.prototype=n(m._super.prototype);var l={frequencyHz:0,dampingRatio:0};function m(t,e,i,n,r){if(!(this instanceof m))return new m(t,e,i,n,r);if(i&&n&&"m_type"in n&&"x"in i&&"y"in i){var h=i;i=n,n=h}t=o(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=m.TYPE,this.m_localAnchorA=a.clone(n?e.getLocalPoint(n):t.localAnchorA||a.zero()),this.m_localAnchorB=a.clone(r?i.getLocalPoint(r):t.localAnchorB||a.zero()),this.m_length=s.isFinite(t.length)?t.length:a.distance(e.getWorldPoint(this.m_localAnchorA),i.getWorldPoint(this.m_localAnchorB)),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}m.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}},m._deserialize=function(t,e,i){return t.bodyA=i(u,t.bodyA,e),t.bodyB=i(u,t.bodyB,e),new m(t)},m.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.length>0?this.m_length=+t.length:t.length<0||(t.anchorA||t.anchorA||t.anchorA||t.anchorA)&&(this.m_length=a.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.setLength=function(t){this.m_length=t},m.prototype.getLength=function(){return this.m_length},m.prototype.setFrequency=function(t){this.m_frequencyHz=t},m.prototype.getFrequency=function(){return this.m_frequencyHz},m.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},m.prototype.getDampingRatio=function(){return this.m_dampingRatio},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.mul(this.m_impulse,this.m_u).mul(t)},m.prototype.getReactionTorque=function(t){return 0},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_position.c,u=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,p=h.neo(i),_=h.neo(u);this.m_rA=h.mulVec2(p,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(_,a.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=a.sub(a.add(c,this.m_rB),a.add(e,this.m_rA));var d=this.m_u.length();d>r.linearSlop?this.m_u.mul(1/d):this.m_u.set(0,0);var f=a.cross(this.m_rA,this.m_u),y=a.cross(this.m_rB,this.m_u),v=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!=v?1/v:0,this.m_frequencyHz>0){var g=d-this.m_length,b=2*s.PI*this.m_frequencyHz,x=2*this.m_mass*this.m_dampingRatio*b,A=this.m_mass*b*b,w=t.dt;this.m_gamma=w*(x+w*A),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=g*w*A*this.m_gamma,v+=this.m_gamma,this.m_mass=0!=v?1/v:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;var B=a.mul(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,B),n-=this.m_invIA*a.cross(this.m_rA,B),l.addMul(this.m_invMassB,B),m+=this.m_invIB*a.cross(this.m_rB,B)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(o),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=m},m.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=a.add(e,a.cross(i,this.m_rA)),s=a.add(o,a.cross(n,this.m_rB)),h=a.dot(this.m_u,s)-a.dot(this.m_u,r),c=-this.m_mass*(h+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c;var u=a.mul(c,this.m_u);e.subMul(this.m_invMassA,u),i-=this.m_invIA*a.cross(this.m_rA,u),o.addMul(this.m_invMassB,u),n+=this.m_invIB*a.cross(this.m_rB,u),this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(o),this.m_bodyB.c_velocity.w=n},m.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,c=h.neo(i),u=h.neo(n),l=h.mulSub(c,this.m_localAnchorA,this.m_localCenterA),m=h.mulSub(u,this.m_localAnchorB,this.m_localCenterB),p=a.sub(a.add(o,m),a.add(e,l)),_=p.normalize()-this.m_length;_=s.clamp(_,-r.maxLinearCorrection,r.maxLinearCorrection);var d=-this.m_mass*_,f=a.mul(d,p);return e.subMul(this.m_invMassA,f),i-=this.m_invIA*a.cross(l,f),o.addMul(this.m_invMassB,f),n+=this.m_invIB*a.cross(m,f),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(o),this.m_bodyB.c_position.a=n,s.abs(_)<r.linearSlop}},342:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=_;var n=i(2274),r=i(4896),s=i(4175),a=(i(1099),i(5387)),h=i(6306),c=(i(4470),i(6173)),u=(i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);_.TYPE="friction-joint",l.TYPES[_.TYPE]=_,_._super=l,_.prototype=s(_._super.prototype);var p={maxForce:0,maxTorque:0};function _(t,e,i,o){if(!(this instanceof _))return new _(t,e,i,o);t=r(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||h.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||h.zero(),this.m_linearImpulse=h.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}_.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}},_._deserialize=function(t,e,i){return t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),new _(t)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.setMaxForce=function(t){o&&n.assert(a.isFinite(t)&&t>=0),this.m_maxForce=t},_.prototype.getMaxForce=function(){return this.m_maxForce},_.prototype.setMaxTorque=function(t){o&&n.assert(a.isFinite(t)&&t>=0),this.m_maxTorque=t},_.prototype.getMaxTorque=function(){return this.m_maxTorque},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return h.mul(t,this.m_linearImpulse)},_.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,r=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=u.neo(e),l=u.neo(n);this.m_rA=u.mulVec2(a,h.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mulVec2(l,h.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,p=this.m_invMassB,_=this.m_invIA,d=this.m_invIB,f=new c;if(f.ex.x=m+p+_*this.m_rA.y*this.m_rA.y+d*this.m_rB.y*this.m_rB.y,f.ex.y=-_*this.m_rA.x*this.m_rA.y-d*this.m_rB.x*this.m_rB.y,f.ey.x=f.ex.y,f.ey.y=m+p+_*this.m_rA.x*this.m_rA.x+d*this.m_rB.x*this.m_rB.x,this.m_linearMass=f.getInverse(),this.m_angularMass=_+d,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var y=h.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(m,y),o-=_*(h.cross(this.m_rA,y)+this.m_angularImpulse),r.addMul(p,y),s+=d*(h.cross(this.m_rB,y)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=r,this.m_bodyB.c_velocity.w=s},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=this.m_invMassA,s=this.m_invMassB,u=this.m_invIA,l=this.m_invIB,m=t.dt,p=n-i,_=-this.m_angularMass*p,d=this.m_angularImpulse,f=m*this.m_maxTorque;this.m_angularImpulse=a.clamp(this.m_angularImpulse+_,-f,f),i-=u*(_=this.m_angularImpulse-d),n+=l*_,p=h.sub(h.add(o,h.cross(n,this.m_rB)),h.add(e,h.cross(i,this.m_rA))),_=h.neg(c.mulVec2(this.m_linearMass,p)),d=this.m_linearImpulse,this.m_linearImpulse.add(_),f=m*this.m_maxForce,this.m_linearImpulse.lengthSquared()>f*f&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(f)),_=h.sub(this.m_linearImpulse,d),e.subMul(r,_),i-=u*h.cross(this.m_rA,_),o.addMul(s,_),n+=l*h.cross(this.m_rB,_),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},_.prototype.solvePositionConstraints=function(t){return!0}},155:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=f;var n=i(2274),r=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=(i(4470),i(6173),i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129),p=i(8087),_=i(7200);f.TYPE="gear-joint",l.TYPES[f.TYPE]=f,f._super=l,f.prototype=s(f._super.prototype);var d={ratio:1};function f(t,e,i,s,a,m){if(!(this instanceof f))return new f(t,e,i,s,a,m);var y,v;t=r(t,d),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=f.TYPE,o&&n.assert(s.m_type===p.TYPE||s.m_type===_.TYPE),o&&n.assert(a.m_type===p.TYPE||a.m_type===_.TYPE),this.m_joint1=s||t.joint1,this.m_joint2=a||t.joint2,this.m_ratio=h.isFinite(m)?m:t.ratio,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType(),this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();var g=this.m_bodyA.m_xf,b=this.m_bodyA.m_sweep.a,x=this.m_bodyC.m_xf,A=this.m_bodyC.m_sweep.a;if(this.m_type1===p.TYPE){var w=this.m_joint1;this.m_localAnchorC=w.m_localAnchorA,this.m_localAnchorA=w.m_localAnchorB,this.m_referenceAngleA=w.m_referenceAngle,this.m_localAxisC=c.zero(),y=b-A-this.m_referenceAngleA}else{var B=this.m_joint1;this.m_localAnchorC=B.m_localAnchorA,this.m_localAnchorA=B.m_localAnchorB,this.m_referenceAngleA=B.m_referenceAngle,this.m_localAxisC=B.m_localXAxisA;var T=this.m_localAnchorC,E=u.mulTVec2(x.q,c.add(u.mul(g.q,this.m_localAnchorA),c.sub(g.p,x.p)));y=c.dot(E,this.m_localAxisC)-c.dot(T,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();var I=this.m_bodyB.m_xf,C=this.m_bodyB.m_sweep.a,S=this.m_bodyD.m_xf,M=this.m_bodyD.m_sweep.a;if(this.m_type2===p.TYPE)w=this.m_joint2,this.m_localAnchorD=w.m_localAnchorA,this.m_localAnchorB=w.m_localAnchorB,this.m_referenceAngleB=w.m_referenceAngle,this.m_localAxisD=c.zero(),v=C-M-this.m_referenceAngleB;else{B=this.m_joint2,this.m_localAnchorD=B.m_localAnchorA,this.m_localAnchorB=B.m_localAnchorB,this.m_referenceAngleB=B.m_referenceAngle,this.m_localAxisD=B.m_localXAxisA;var P=this.m_localAnchorD,D=u.mulTVec2(S.q,c.add(u.mul(I.q,this.m_localAnchorB),c.sub(I.p,S.p)));v=c.dot(D,this.m_localAxisD)-c.dot(P,this.m_localAxisD)}this.m_constant=y+this.m_ratio*v,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}f.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio,_constant:this.m_constant}},f._deserialize=function(t,e,i){t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),t.joint1=i(l,t.joint1,e),t.joint2=i(l,t.joint2,e);var o=new f(t);return t._constant&&(o.m_constant=t._constant),o},f.prototype.getJoint1=function(){return this.m_joint1},f.prototype.getJoint2=function(){return this.m_joint2},f.prototype.setRatio=function(t){o&&n.assert(h.isFinite(t)),this.m_ratio=t},f.prototype.getRatio=function(){return this.m_ratio},f.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},f.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},f.prototype.getReactionForce=function(t){return c.mul(this.m_impulse,this.m_JvAC).mul(t)},f.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},f.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,r=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_position.a,h=this.m_bodyC.c_velocity.v,l=this.m_bodyC.c_velocity.w,m=this.m_bodyD.c_position.a,_=this.m_bodyD.c_velocity.v,d=this.m_bodyD.c_velocity.w,f=u.neo(e),y=u.neo(n),v=u.neo(a),g=u.neo(m);if(this.m_mass=0,this.m_type1==p.TYPE)this.m_JvAC=c.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var b=u.mulVec2(v,this.m_localAxisC),x=u.mulSub(v,this.m_localAnchorC,this.m_lcC),A=u.mulSub(f,this.m_localAnchorA,this.m_lcA);this.m_JvAC=b,this.m_JwC=c.cross(x,b),this.m_JwA=c.cross(A,b),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==p.TYPE)this.m_JvBD=c.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{b=u.mulVec2(g,this.m_localAxisD);var w=u.mulSub(g,this.m_localAnchorD,this.m_lcD),B=u.mulSub(y,this.m_localAnchorB,this.m_lcB);this.m_JvBD=c.mul(this.m_ratio,b),this.m_JwD=this.m_ratio*c.cross(w,b),this.m_JwB=this.m_ratio*c.cross(B,b),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(i.addMul(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,r.addMul(this.m_mB*this.m_impulse,this.m_JvBD),s+=this.m_iB*this.m_impulse*this.m_JwB,h.subMul(this.m_mC*this.m_impulse,this.m_JvAC),l-=this.m_iC*this.m_impulse*this.m_JwC,_.subMul(this.m_mD*this.m_impulse,this.m_JvBD),d-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(r),this.m_bodyB.c_velocity.w=s,this.m_bodyC.c_velocity.v.set(h),this.m_bodyC.c_velocity.w=l,this.m_bodyD.c_velocity.v.set(_),this.m_bodyD.c_velocity.w=d},f.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=this.m_bodyC.c_velocity.v,s=this.m_bodyC.c_velocity.w,a=this.m_bodyD.c_velocity.v,h=this.m_bodyD.c_velocity.w,u=c.dot(this.m_JvAC,e)-c.dot(this.m_JvAC,r)+c.dot(this.m_JvBD,o)-c.dot(this.m_JvBD,a);u+=this.m_JwA*i-this.m_JwC*s+(this.m_JwB*n-this.m_JwD*h);var l=-this.m_mass*u;this.m_impulse+=l,e.addMul(this.m_mA*l,this.m_JvAC),i+=this.m_iA*l*this.m_JwA,o.addMul(this.m_mB*l,this.m_JvBD),n+=this.m_iB*l*this.m_JwB,r.subMul(this.m_mC*l,this.m_JvAC),s-=this.m_iC*l*this.m_JwC,a.subMul(this.m_mD*l,this.m_JvBD),h-=this.m_iD*l*this.m_JwD,this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(o),this.m_bodyB.c_velocity.w=n,this.m_bodyC.c_velocity.v.set(r),this.m_bodyC.c_velocity.w=s,this.m_bodyD.c_velocity.v.set(a),this.m_bodyD.c_velocity.w=h},f.prototype.solvePositionConstraints=function(t){var e,i,o,n,r,s,h,l,m=this.m_bodyA.c_position.c,_=this.m_bodyA.c_position.a,d=this.m_bodyB.c_position.c,f=this.m_bodyB.c_position.a,y=this.m_bodyC.c_position.c,v=this.m_bodyC.c_position.a,g=this.m_bodyD.c_position.c,b=this.m_bodyD.c_position.a,x=u.neo(_),A=u.neo(f),w=u.neo(v),B=u.neo(b),T=0;if(this.m_type1==p.TYPE)o=c.zero(),r=1,h=1,T+=this.m_iA+this.m_iC,e=_-v-this.m_referenceAngleA;else{var E=u.mulVec2(w,this.m_localAxisC),I=u.mulSub(w,this.m_localAnchorC,this.m_lcC),C=u.mulSub(x,this.m_localAnchorA,this.m_lcA);o=E,h=c.cross(I,E),r=c.cross(C,E),T+=this.m_mC+this.m_mA+this.m_iC*h*h+this.m_iA*r*r;var S=c.sub(this.m_localAnchorC,this.m_lcC),M=u.mulTVec2(w,c.add(C,c.sub(m,y)));e=c.dot(c.sub(M,S),this.m_localAxisC)}if(this.m_type2==p.TYPE)n=c.zero(),s=this.m_ratio,l=this.m_ratio,T+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),i=f-b-this.m_referenceAngleB;else{E=u.mulVec2(B,this.m_localAxisD);var P=u.mulSub(B,this.m_localAnchorD,this.m_lcD),D=u.mulSub(A,this.m_localAnchorB,this.m_lcB);n=c.mul(this.m_ratio,E),l=this.m_ratio*c.cross(P,E),s=this.m_ratio*c.cross(D,E),T+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*l*l+this.m_iB*s*s;var O=c.sub(this.m_localAnchorD,this.m_lcD),L=u.mulTVec2(B,c.add(D,c.sub(d,g)));i=c.dot(L,this.m_localAxisD)-c.dot(O,this.m_localAxisD)}var V=e+this.m_ratio*i-this.m_constant,N=0;return T>0&&(N=-V/T),m.addMul(this.m_mA*N,o),_+=this.m_iA*N*r,d.addMul(this.m_mB*N,n),f+=this.m_iB*N*s,y.subMul(this.m_mC*N,o),v-=this.m_iC*N*h,g.subMul(this.m_mD*N,n),b-=this.m_iD*N*l,this.m_bodyA.c_position.c.set(m),this.m_bodyA.c_position.a=_,this.m_bodyB.c_position.c.set(d),this.m_bodyB.c_position.a=f,this.m_bodyC.c_position.c.set(y),this.m_bodyC.c_position.a=v,this.m_bodyD.c_position.c.set(g),this.m_bodyD.c_position.a=b,0<a.linearSlop}},2371:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=_;var n=i(2274),r=i(4896),s=i(4175),a=(i(1099),i(5387)),h=i(6306),c=(i(4470),i(6173)),u=(i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);_.TYPE="motor-joint",l.TYPES[_.TYPE]=_,_._super=l,_.prototype=s(_._super.prototype);var p={maxForce:1,maxTorque:1,correctionFactor:.3};function _(t,e,i){if(!(this instanceof _))return new _(t,e,i);t=r(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_linearOffset=t.linearOffset?t.linearOffset:e.getLocalPoint(i.getPosition());var o=e.getAngle(),n=i.getAngle();this.m_angularOffset=n-o,this.m_linearImpulse=h.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}_.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,linearOffset:this.m_linearOffset,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,_angularOffset:this.m_angularOffset}},_._deserialize=function(t,e,i){t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e);var o=new _(t);return t._angularOffset&&(o.m_angularOffset=t._angularOffset),o},_.prototype.setMaxForce=function(t){o&&n.assert(a.isFinite(t)&&t>=0),this.m_maxForce=t},_.prototype.getMaxForce=function(){return this.m_maxForce},_.prototype.setMaxTorque=function(t){o&&n.assert(a.isFinite(t)&&t>=0),this.m_maxTorque=t},_.prototype.getMaxTorque=function(){return this.m_maxTorque},_.prototype.setCorrectionFactor=function(t){o&&n.assert(a.isFinite(t)&&0<=t&&t<=1),this.m_correctionFactor=t},_.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},_.prototype.setLinearOffset=function(t){t.x==this.m_linearOffset.x&&t.y==this.m_linearOffset.y||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t)},_.prototype.getLinearOffset=function(){return this.m_linearOffset},_.prototype.setAngularOffset=function(t){t!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t)},_.prototype.getAngularOffset=function(){return this.m_angularOffset},_.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},_.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},_.prototype.getReactionForce=function(t){return h.mul(t,this.m_linearImpulse)},_.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=u.neo(i),p=u.neo(s);this.m_rA=u.mulVec2(m,h.neg(this.m_localCenterA)),this.m_rB=u.mulVec2(p,h.neg(this.m_localCenterB));var _=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=new c;if(v.ex.x=_+d+f*this.m_rA.y*this.m_rA.y+y*this.m_rB.y*this.m_rB.y,v.ex.y=-f*this.m_rA.x*this.m_rA.y-y*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=_+d+f*this.m_rA.x*this.m_rA.x+y*this.m_rB.x*this.m_rB.x,this.m_linearMass=v.getInverse(),this.m_angularMass=f+y,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=h.zero(),this.m_linearError.addCombine(1,r,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_linearError.sub(u.mulVec2(m,this.m_linearOffset)),this.m_angularError=s-i-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var g=h.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);o.subMul(_,g),n-=f*(h.cross(this.m_rA,g)+this.m_angularImpulse),a.addMul(d,g),l+=y*(h.cross(this.m_rB,g)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=l},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=this.m_invMassA,s=this.m_invMassB,u=this.m_invIA,l=this.m_invIB,m=t.dt,p=t.inv_dt,_=n-i+p*this.m_correctionFactor*this.m_angularError,d=-this.m_angularMass*_,f=this.m_angularImpulse,y=m*this.m_maxTorque;this.m_angularImpulse=a.clamp(this.m_angularImpulse+d,-y,y),i-=u*(d=this.m_angularImpulse-f),n+=l*d,(_=h.zero()).addCombine(1,o,1,h.cross(n,this.m_rB)),_.subCombine(1,e,1,h.cross(i,this.m_rA)),_.addMul(p*this.m_correctionFactor,this.m_linearError),d=h.neg(c.mulVec2(this.m_linearMass,_)),f=h.clone(this.m_linearImpulse),this.m_linearImpulse.add(d),y=m*this.m_maxForce,this.m_linearImpulse.clamp(y),d=h.sub(this.m_linearImpulse,f),e.subMul(r,d),i-=u*h.cross(this.m_rA,d),o.addMul(s,d),n+=l*h.cross(this.m_rB,d),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},_.prototype.solvePositionConstraints=function(t){return!0}},1952:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=d;var n=i(2274),r=i(4896),s=i(4175),a=i(5387),h=i(6306),c=(i(4470),i(6173)),u=(i(7515),i(3766)),l=(i(5385),i(8850)),m=(i(5235),i(8601),i(5878)),p=i(2129);d.TYPE="mouse-joint",m.TYPES[d.TYPE]=d,d._super=m,d.prototype=s(d._super.prototype);var _={maxForce:0,frequencyHz:5,dampingRatio:.7};function d(t,e,i,s){if(!(this instanceof d))return new d(t,e,i,s);t=r(t,_),m.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=d.TYPE,o&&n.assert(a.isFinite(t.maxForce)&&t.maxForce>=0),o&&n.assert(a.isFinite(t.frequencyHz)&&t.frequencyHz>=0),o&&n.assert(a.isFinite(t.dampingRatio)&&t.dampingRatio>=0),this.m_targetA=s?h.clone(s):t.target||h.zero(),this.m_localAnchorB=l.mulTVec2(i.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=h.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=h.zero(),this.m_localCenterB=h.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new c,this.m_C=h.zero()}d.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}},d._deserialize=function(t,e,i){t.bodyA=i(p,t.bodyA,e),t.bodyB=i(p,t.bodyB,e),t.target=h(t.target);var o=new d(t);return t._localAnchorB&&(o.m_localAnchorB=t._localAnchorB),o},d.prototype.setTarget=function(t){0==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0),this.m_targetA=h.clone(t)},d.prototype.getTarget=function(){return this.m_targetA},d.prototype.setMaxForce=function(t){this.m_maxForce=t},d.getMaxForce=function(){return this.m_maxForce},d.prototype.setFrequency=function(t){this.m_frequencyHz=t},d.prototype.getFrequency=function(){return this.m_frequencyHz},d.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},d.prototype.getDampingRatio=function(){return this.m_dampingRatio},d.prototype.getAnchorA=function(){return h.clone(this.m_targetA)},d.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},d.prototype.getReactionForce=function(t){return h.mul(t,this.m_impulse)},d.prototype.getReactionTorque=function(t){return 0*t},d.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},d.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyB.c_position,i=this.m_bodyB.c_velocity,r=e.c,s=e.a,l=i.v,m=i.w,p=u.neo(s),_=this.m_bodyB.getMass(),d=2*a.PI*this.m_frequencyHz,f=2*_*this.m_dampingRatio*d,y=_*(d*d),v=t.dt;o&&n.assert(f+v*y>a.EPSILON),this.m_gamma=v*(f+v*y),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=v*y*this.m_gamma,this.m_rB=u.mulVec2(p,h.sub(this.m_localAnchorB,this.m_localCenterB));var g=new c;g.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,g.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,g.ey.x=g.ex.y,g.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=g.getInverse(),this.m_C.set(r),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),m*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),l.addMul(this.m_invMassB,this.m_impulse),m+=this.m_invIB*h.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),i.v.set(l),i.w=m},d.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyB.c_velocity,i=h.clone(e.v),o=e.w,n=h.cross(o,this.m_rB);n.add(i),n.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),n.neg();var r=c.mulVec2(this.m_mass,n),s=h.clone(this.m_impulse);this.m_impulse.add(r);var a=t.dt*this.m_maxForce;this.m_impulse.clamp(a),r=h.sub(this.m_impulse,s),i.addMul(this.m_invMassB,r),o+=this.m_invIB*h.cross(this.m_rB,r),e.v.set(i),e.w=o},d.prototype.solvePositionConstraints=function(t){return!0}},7200:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=y;var n=i(2274),r=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=i(4470),l=i(6173),m=i(7515),p=i(3766),_=(i(5385),i(8850),i(5235),i(8601),i(5878)),d=i(2129);y.TYPE="prismatic-joint",_.TYPES[y.TYPE]=y,y._super=_,y.prototype=s(y._super.prototype);var f={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0};function y(t,e,i,o,n){if(!(this instanceof y))return new y(t,e,i,o,n);t=r(t,f),_.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=y.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||c.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||c.zero(),this.m_localXAxisA=n?e.getLocalVector(n):t.localAxisA||c.neo(1,0),this.m_localXAxisA.normalize(),this.m_localYAxisA=c.cross(1,this.m_localXAxisA),this.m_referenceAngle=h.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=u(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=0,this.m_axis=c.zero(),this.m_perp=c.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new m,this.m_motorMass}y.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}},y._deserialize=function(t,e,i){return t.bodyA=i(d,t.bodyA,e),t.bodyB=i(d,t.bodyB,e),t.localAxisA=c(t.localAxisA),new y(t)},y.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},y.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},y.prototype.getLocalAxisA=function(){return this.m_localXAxisA},y.prototype.getReferenceAngle=function(){return this.m_referenceAngle},y.prototype.getJointTranslation=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=c.sub(e,t),o=this.m_bodyA.getWorldVector(this.m_localXAxisA);return c.dot(i,o)},y.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,i=p.mulVec2(t.m_xf.q,c.sub(this.m_localAnchorA,t.m_sweep.localCenter)),o=p.mulVec2(e.m_xf.q,c.sub(this.m_localAnchorB,e.m_sweep.localCenter)),n=c.add(t.m_sweep.c,i),r=c.add(e.m_sweep.c,o),s=c.sub(r,n),a=p.mulVec2(t.m_xf.q,this.m_localXAxisA),h=t.m_linearVelocity,u=e.m_linearVelocity,l=t.m_angularVelocity,m=e.m_angularVelocity;return c.dot(s,c.cross(l,a))+c.dot(a,c.sub(c.addCross(u,m,o),c.addCross(h,l,i)))},y.prototype.isLimitEnabled=function(){return this.m_enableLimit},y.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},y.prototype.getLowerLimit=function(){return this.m_lowerTranslation},y.prototype.getUpperLimit=function(){return this.m_upperTranslation},y.prototype.setLimits=function(t,e){o&&n.assert(t<=e),t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},y.prototype.isMotorEnabled=function(){return this.m_enableMotor},y.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},y.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},y.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t},y.prototype.getMotorSpeed=function(){return this.m_motorSpeed},y.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},y.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},y.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},y.prototype.getReactionForce=function(t){return c.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)},y.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},y.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,u=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=p.neo(i),_=p.neo(s),d=p.mulVec2(m,c.sub(this.m_localAnchorA,this.m_localCenterA)),f=p.mulVec2(_,c.sub(this.m_localAnchorB,this.m_localCenterB)),y=c.zero();y.addCombine(1,r,1,f),y.subCombine(1,e,1,d);var v=this.m_invMassA,g=this.m_invMassB,b=this.m_invIA,x=this.m_invIB;this.m_axis=p.mulVec2(m,this.m_localXAxisA),this.m_a1=c.cross(c.add(y,d),this.m_axis),this.m_a2=c.cross(f,this.m_axis),this.m_motorMass=v+g+b*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_perp=p.mulVec2(m,this.m_localYAxisA),this.m_s1=c.cross(c.add(y,d),this.m_perp),this.m_s2=c.cross(f,this.m_perp),c.cross(d,this.m_perp);var A=v+g+b*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,w=b*this.m_s1+x*this.m_s2,B=b*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,T=b+x;0==T&&(T=1);var E=b*this.m_a1+x*this.m_a2,I=v+g+b*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2;if(this.m_K.ex.set(A,w,B),this.m_K.ey.set(w,T,E),this.m_K.ez.set(B,E,I),this.m_enableLimit){var C=c.dot(this.m_axis,y);h.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.linearSlop?this.m_limitState=3:C<=this.m_lowerTranslation?1!=this.m_limitState&&(this.m_limitState=1,this.m_impulse.z=0):C>=this.m_upperTranslation?2!=this.m_limitState&&(this.m_limitState=2,this.m_impulse.z=0):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var S=c.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),M=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,P=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;o.subMul(v,S),n-=b*M,u.addMul(g,S),l+=x*P}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(o),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(u),this.m_bodyB.c_velocity.w=l},y.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=this.m_invMassA,s=this.m_invMassB,a=this.m_invIA,l=this.m_invIB;if(this.m_enableMotor&&3!=this.m_limitState){var m=c.dot(this.m_axis,c.sub(o,e))+this.m_a2*n-this.m_a1*i,p=this.m_motorMass*(this.m_motorSpeed-m),_=this.m_motorImpulse,d=t.dt*this.m_maxMotorForce;this.m_motorImpulse=h.clamp(this.m_motorImpulse+p,-d,d),p=this.m_motorImpulse-_;var f=c.mul(p,this.m_axis),y=p*this.m_a1,v=p*this.m_a2;e.subMul(r,f),i-=a*y,o.addMul(s,f),n+=l*v}var g=c.zero();if(g.x+=c.dot(this.m_perp,o)+this.m_s2*n,g.x-=c.dot(this.m_perp,e)+this.m_s1*i,g.y=n-i,this.m_enableLimit&&0!=this.m_limitState){var b=0;b+=c.dot(this.m_axis,o)+this.m_a2*n,b-=c.dot(this.m_axis,e)+this.m_a1*i,m=u(g.x,g.y,b);var x=u(this.m_impulse),A=this.m_K.solve33(u.neg(m));this.m_impulse.add(A),1==this.m_limitState?this.m_impulse.z=h.max(this.m_impulse.z,0):2==this.m_limitState&&(this.m_impulse.z=h.min(this.m_impulse.z,0));var w=c.combine(-1,g,-(this.m_impulse.z-x.z),c.neo(this.m_K.ez.x,this.m_K.ez.y)),B=c.add(this.m_K.solve22(w),c.neo(x.x,x.y));this.m_impulse.x=B.x,this.m_impulse.y=B.y,A=u.sub(this.m_impulse,x),f=c.combine(A.x,this.m_perp,A.z,this.m_axis),y=A.x*this.m_s1+A.y+A.z*this.m_a1,v=A.x*this.m_s2+A.y+A.z*this.m_a2,e.subMul(r,f),i-=a*y,o.addMul(s,f),n+=l*v}else A=this.m_K.solve22(c.neg(g)),this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,f=c.mul(A.x,this.m_perp),y=A.x*this.m_s1+A.y,v=A.x*this.m_s2+A.y,e.subMul(r,f),i-=a*y,o.addMul(s,f),n+=l*v;this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},y.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,r=p.neo(i),s=p.neo(n),_=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,y=this.m_invIB,v=p.mulVec2(r,c.sub(this.m_localAnchorA,this.m_localCenterA)),g=p.mulVec2(s,c.sub(this.m_localAnchorB,this.m_localCenterB)),b=c.sub(c.add(o,g),c.add(e,v)),x=p.mulVec2(r,this.m_localXAxisA),A=c.cross(c.add(b,v),x),w=c.cross(g,x),B=p.mulVec2(r,this.m_localYAxisA),T=c.cross(c.add(b,v),B),E=c.cross(g,B),I=u(),C=c.zero();C.x=c.dot(B,b),C.y=n-i-this.m_referenceAngle;var S=h.abs(C.x),M=h.abs(C.y),P=a.linearSlop,D=a.maxLinearCorrection,O=!1,L=0;if(this.m_enableLimit){var V=c.dot(x,b);h.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P?(L=h.clamp(V,-D,D),S=h.max(S,h.abs(V)),O=!0):V<=this.m_lowerTranslation?(L=h.clamp(V-this.m_lowerTranslation+P,-D,0),S=h.max(S,this.m_lowerTranslation-V),O=!0):V>=this.m_upperTranslation&&(L=h.clamp(V-this.m_upperTranslation-P,0,D),S=h.max(S,V-this.m_upperTranslation),O=!0)}if(O){var N=_+d+f*T*T+y*E*E,F=f*T+y*E,z=f*T*A+y*E*w;0==(j=f+y)&&(j=1);var R=f*A+y*w,k=_+d+f*A*A+y*w*w;(U=new m).ex.set(N,F,z),U.ey.set(F,j,R),U.ez.set(z,R,k);var q=u();q.x=C.x,q.y=C.y,q.z=L,I=U.solve33(u.neg(q))}else{var j,U;N=_+d+f*T*T+y*E*E,F=f*T+y*E,0==(j=f+y)&&(j=1),(U=new l).ex.set(N,F),U.ey.set(F,j);var G=U.solve(c.neg(C));I.x=G.x,I.y=G.y,I.z=0}var Y=c.combine(I.x,B,I.z,x),$=I.x*T+I.y+I.z*A,W=I.x*E+I.y+I.z*w;return e.subMul(_,Y),i-=f*$,o.addMul(d,Y),n+=y*W,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=n,S<=a.linearSlop&&M<=a.angularSlop}},9087:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=_;var n=i(2274),r=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=(i(4470),i(6173),i(7515),i(3766)),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);_.TYPE="pulley-joint",_.MIN_PULLEY_LENGTH=2,l.TYPES[_.TYPE]=_,_._super=l,_.prototype=s(_._super.prototype);var p={collideConnected:!0};function _(t,e,i,s,a,u,m,d){if(!(this instanceof _))return new _(t,e,i,s,a,u,m,d);t=r(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_groundAnchorA=s||t.groundAnchorA||c.neo(-1,1),this.m_groundAnchorB=a||t.groundAnchorB||c.neo(1,1),this.m_localAnchorA=u?e.getLocalPoint(u):t.localAnchorA||c.neo(-1,0),this.m_localAnchorB=m?i.getLocalPoint(m):t.localAnchorB||c.neo(1,0),this.m_lengthA=h.isFinite(t.lengthA)?t.lengthA:c.distance(u,s),this.m_lengthB=h.isFinite(t.lengthB)?t.lengthB:c.distance(m,a),this.m_ratio=h.isFinite(d)?d:t.ratio,o&&n.assert(d>h.EPSILON),this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}_.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}},_._deserialize=function(t,e,i){return t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),new _(t)},_.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},_.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},_.prototype.getLengthA=function(){return this.m_lengthA},_.prototype.getLengthB=function(){return this.m_lengthB},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getCurrentLengthA=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return c.distance(t,e)},_.prototype.getCurrentLengthB=function(){var t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return c.distance(t,e)},_.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return c.mul(this.m_impulse,this.m_uB).mul(t)},_.prototype.getReactionTorque=function(t){return 0},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,r=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,h=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=u.neo(i),p=u.neo(s);this.m_rA=u.mulVec2(m,c.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mulVec2(p,c.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=c.sub(c.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=c.sub(c.add(r,this.m_rB),this.m_groundAnchorB);var _=this.m_uA.length(),d=this.m_uB.length();_>10*a.linearSlop?this.m_uA.mul(1/_):this.m_uA.setZero(),d>10*a.linearSlop?this.m_uB.mul(1/d):this.m_uB.setZero();var f=c.cross(this.m_rA,this.m_uA),y=c.cross(this.m_rB,this.m_uB),v=this.m_invMassA+this.m_invIA*f*f,g=this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=v+this.m_ratio*this.m_ratio*g,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;var b=c.mul(-this.m_impulse,this.m_uA),x=c.mul(-this.m_ratio*this.m_impulse,this.m_uB);o.addMul(this.m_invMassA,b),n+=this.m_invIA*c.cross(this.m_rA,b),h.addMul(this.m_invMassB,x),l+=this.m_invIB*c.cross(this.m_rB,x)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=h,this.m_bodyB.c_velocity.w=l},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=c.add(e,c.cross(i,this.m_rA)),s=c.add(o,c.cross(n,this.m_rB)),a=-c.dot(this.m_uA,r)-this.m_ratio*c.dot(this.m_uB,s),h=-this.m_mass*a;this.m_impulse+=h;var u=c.mul(-h,this.m_uA),l=c.mul(-this.m_ratio*h,this.m_uB);e.addMul(this.m_invMassA,u),i+=this.m_invIA*c.cross(this.m_rA,u),o.addMul(this.m_invMassB,l),n+=this.m_invIB*c.cross(this.m_rB,l),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},_.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,r=u.neo(i),s=u.neo(n),l=u.mulVec2(r,c.sub(this.m_localAnchorA,this.m_localCenterA)),m=u.mulVec2(s,c.sub(this.m_localAnchorB,this.m_localCenterB)),p=c.sub(c.add(e,this.m_rA),this.m_groundAnchorA),_=c.sub(c.add(o,this.m_rB),this.m_groundAnchorB),d=p.length(),f=_.length();d>10*a.linearSlop?p.mul(1/d):p.setZero(),f>10*a.linearSlop?_.mul(1/f):_.setZero();var y=c.cross(l,p),v=c.cross(m,_),g=this.m_invMassA+this.m_invIA*y*y,b=this.m_invMassB+this.m_invIB*v*v,x=g+this.m_ratio*this.m_ratio*b;x>0&&(x=1/x);var A=this.m_constant-d-this.m_ratio*f,w=h.abs(A),B=-x*A,T=c.mul(-B,p),E=c.mul(-this.m_ratio*B,_);return e.addMul(this.m_invMassA,T),i+=this.m_invIA*c.cross(l,T),o.addMul(this.m_invMassB,E),n+=this.m_invIB*c.cross(m,E),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=n,w<a.linearSlop}},8087:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=y;var n=i(2274),r=i(4896),s=i(4175),a=i(1099),h=i(5387),c=i(6306),u=i(4470),l=i(6173),m=i(7515),p=i(3766),_=(i(5385),i(8850),i(5235),i(8601),i(5878)),d=i(2129);y.TYPE="revolute-joint",_.TYPES[y.TYPE]=y,y._super=_,y.prototype=s(y._super.prototype);var f={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1};function y(t,e,i,o){if(!(this instanceof y))return new y(t,e,i,o);t=r(t,f),_.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=y.TYPE,this.m_localAnchorA=c.clone(o?e.getLocalPoint(o):t.localAnchorA||c.zero()),this.m_localAnchorB=c.clone(o?i.getLocalPoint(o):t.localAnchorB||c.zero()),this.m_referenceAngle=h.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=u(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new m,this.m_motorMass,this.m_limitState=0}y.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},y._deserialize=function(t,e,i){return t.bodyA=i(d,t.bodyA,e),t.bodyB=i(d,t.bodyB,e),new y(t)},y.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB)},y.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},y.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},y.prototype.getReferenceAngle=function(){return this.m_referenceAngle},y.prototype.getJointAngle=function(){var t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},y.prototype.getJointSpeed=function(){var t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},y.prototype.isMotorEnabled=function(){return this.m_enableMotor},y.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},y.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},y.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},y.prototype.getMotorSpeed=function(){return this.m_motorSpeed},y.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},y.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},y.prototype.isLimitEnabled=function(){return this.m_enableLimit},y.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},y.prototype.getLowerLimit=function(){return this.m_lowerAngle},y.prototype.getUpperLimit=function(){return this.m_upperAngle},y.prototype.setLimits=function(t,e){o&&n.assert(t<=e),t==this.m_lowerAngle&&e==this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},y.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},y.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},y.prototype.getReactionForce=function(t){return c.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},y.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},y.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,r=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,u=p.neo(e),l=p.neo(n);this.m_rA=p.mulVec2(u,c.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=p.mulVec2(l,c.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,_=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,y=d+f===0;if(this.m_mass.ex.x=m+_+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*f,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*f,this.m_mass.ez.x=-this.m_rA.y*d-this.m_rB.y*f,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=m+_+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*f,this.m_mass.ez.y=this.m_rA.x*d+this.m_rB.x*f,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=d+f,this.m_motorMass=d+f,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(0==this.m_enableMotor||y)&&(this.m_motorImpulse=0),this.m_enableLimit&&0==y){var v=n-e-this.m_referenceAngle;h.abs(this.m_upperAngle-this.m_lowerAngle)<2*a.angularSlop?this.m_limitState=3:v<=this.m_lowerAngle?(1!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=1):v>=this.m_upperAngle?(2!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=2):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var g=c.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(m,g),o-=d*(c.cross(this.m_rA,g)+this.m_motorImpulse+this.m_impulse.z),r.addMul(_,g),s+=f*(c.cross(this.m_rB,g)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=r,this.m_bodyB.c_velocity.w=s},y.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=this.m_invMassA,s=this.m_invMassB,a=this.m_invIA,l=this.m_invIB,m=a+l===0;if(this.m_enableMotor&&3!=this.m_limitState&&0==m){var p=n-i-this.m_motorSpeed,_=-this.m_motorMass*p,d=this.m_motorImpulse,f=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=h.clamp(this.m_motorImpulse+_,-f,f),i-=a*(_=this.m_motorImpulse-d),n+=l*_}if(this.m_enableLimit&&0!=this.m_limitState&&0==m){var y=c.zero();y.addCombine(1,o,1,c.cross(n,this.m_rB)),y.subCombine(1,e,1,c.cross(i,this.m_rA));var v=n-i;if(p=u(y.x,y.y,v),_=u.neg(this.m_mass.solve33(p)),3==this.m_limitState)this.m_impulse.add(_);else if(1==this.m_limitState)if(this.m_impulse.z+_.z<0){var g=c.combine(-1,y,this.m_impulse.z,c.neo(this.m_mass.ez.x,this.m_mass.ez.y)),b=this.m_mass.solve22(g);_.x=b.x,_.y=b.y,_.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else this.m_impulse.add(_);else 2==this.m_limitState&&(this.m_impulse.z+_.z>0?(g=c.combine(-1,y,this.m_impulse.z,c.neo(this.m_mass.ez.x,this.m_mass.ez.y)),b=this.m_mass.solve22(g),_.x=b.x,_.y=b.y,_.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0):this.m_impulse.add(_));var x=c.neo(_.x,_.y);e.subMul(r,x),i-=a*(c.cross(this.m_rA,x)+_.z),o.addMul(s,x),n+=l*(c.cross(this.m_rB,x)+_.z)}else(p=c.zero()).addCombine(1,o,1,c.cross(n,this.m_rB)),p.subCombine(1,e,1,c.cross(i,this.m_rA)),_=this.m_mass.solve22(c.neg(p)),this.m_impulse.x+=_.x,this.m_impulse.y+=_.y,e.subMul(r,_),i-=a*c.cross(this.m_rA,_),o.addMul(s,_),n+=l*c.cross(this.m_rB,_);this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},y.prototype.solvePositionConstraints=function(t){var e,i=this.m_bodyA.c_position.c,o=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,s=p.neo(o),u=p.neo(r),m=0,_=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&0!=this.m_limitState&&0==_){var d=r-o-this.m_referenceAngle,f=0;if(3==this.m_limitState){var y=h.clamp(d-this.m_lowerAngle,-a.maxAngularCorrection,a.maxAngularCorrection);f=-this.m_motorMass*y,m=h.abs(y)}else 1==this.m_limitState?(m=-(y=d-this.m_lowerAngle),y=h.clamp(y+a.angularSlop,-a.maxAngularCorrection,0),f=-this.m_motorMass*y):2==this.m_limitState&&(m=y=d-this.m_upperAngle,y=h.clamp(y-a.angularSlop,0,a.maxAngularCorrection),f=-this.m_motorMass*y);o-=this.m_invIA*f,r+=this.m_invIB*f}s.set(o),u.set(r);var v=p.mulVec2(s,c.sub(this.m_localAnchorA,this.m_localCenterA)),g=p.mulVec2(u,c.sub(this.m_localAnchorB,this.m_localCenterB));(y=c.zero()).addCombine(1,n,1,g),y.subCombine(1,i,1,v),e=y.length();var b=this.m_invMassA,x=this.m_invMassB,A=this.m_invIA,w=this.m_invIB,B=new l;B.ex.x=b+x+A*v.y*v.y+w*g.y*g.y,B.ex.y=-A*v.x*v.y-w*g.x*g.y,B.ey.x=B.ex.y,B.ey.y=b+x+A*v.x*v.x+w*g.x*g.x;var T=c.neg(B.solve(y));return i.subMul(b,T),o-=A*c.cross(v,T),n.addMul(x,T),r+=w*c.cross(g,T),this.m_bodyA.c_position.c.set(i),this.m_bodyA.c_position.a=o,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=r,e<=a.linearSlop&&m<=a.angularSlop}},1347:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=m;var o=i(4896),n=i(4175),r=i(1099),s=i(5387),a=i(6306),h=(i(4470),i(6173),i(7515),i(3766)),c=(i(5385),i(8850),i(5235),i(8601),i(5878)),u=i(2129);m.TYPE="rope-joint",c.TYPES[m.TYPE]=m,m._super=c,m.prototype=n(m._super.prototype);var l={maxLength:0};function m(t,e,i,n){if(!(this instanceof m))return new m(t,e,i,n);t=o(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=m.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.neo(-1,0),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.neo(1,0),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=0,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}m.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}},m._deserialize=function(t,e,i){return t.bodyA=i(u,t.bodyA,e),t.bodyB=i(u,t.bodyB,e),new m(t)},m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.setMaxLength=function(t){this.m_maxLength=t},m.prototype.getMaxLength=function(){return this.m_maxLength},m.prototype.getLimitState=function(){return this.m_state},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.mul(this.m_impulse,this.m_u).mul(t)},m.prototype.getReactionTorque=function(t){return 0},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,u=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=h.neo(i),p=h.neo(c);this.m_rA=h.mulSub(m,this.m_localAnchorA,this.m_localCenterA),this.m_rB=h.mulSub(p,this.m_localAnchorB,this.m_localCenterB),this.m_u=a.zero(),this.m_u.addCombine(1,s,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();var _=this.m_length-this.m_maxLength;if(this.m_state=_>0?2:0,!(this.m_length>r.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);var d=a.cross(this.m_rA,this.m_u),f=a.cross(this.m_rB,this.m_u),y=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*f*f;if(this.m_mass=0!=y?1/y:0,t.warmStarting){this.m_impulse*=t.dtRatio;var v=a.mul(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,v),n-=this.m_invIA*a.cross(this.m_rA,v),u.addMul(this.m_invMassB,v),l+=this.m_invIB*a.cross(this.m_rB,v)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(o),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(u),this.m_bodyB.c_velocity.w=l},m.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=a.addCross(e,i,this.m_rA),h=a.addCross(o,n,this.m_rB),c=this.m_length-this.m_maxLength,u=a.dot(this.m_u,a.sub(h,r));c<0&&(u+=t.inv_dt*c);var l=-this.m_mass*u,m=this.m_impulse;this.m_impulse=s.min(0,this.m_impulse+l),l=this.m_impulse-m;var p=a.mul(l,this.m_u);e.subMul(this.m_invMassA,p),i-=this.m_invIA*a.cross(this.m_rA,p),o.addMul(this.m_invMassB,p),n+=this.m_invIB*a.cross(this.m_rB,p),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},m.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,c=h.neo(i),u=h.neo(n),l=h.mulSub(c,this.m_localAnchorA,this.m_localCenterA),m=h.mulSub(u,this.m_localAnchorB,this.m_localCenterB),p=a.zero();p.addCombine(1,o,1,m),p.subCombine(1,e,1,l);var _=p.normalize(),d=_-this.m_maxLength;d=s.clamp(d,0,r.maxLinearCorrection);var f=-this.m_mass*d,y=a.mul(f,p);return e.subMul(this.m_invMassA,y),i-=this.m_invIA*a.cross(l,y),o.addMul(this.m_invMassB,y),n+=this.m_invIB*a.cross(m,y),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(o),this.m_bodyB.c_position.a=n,_-this.m_maxLength<r.linearSlop}},1415:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=_;var o=i(4896),n=i(4175),r=i(1099),s=i(5387),a=i(6306),h=i(4470),c=(i(6173),i(7515)),u=i(3766),l=(i(5385),i(8850),i(5235),i(8601),i(5878)),m=i(2129);_.TYPE="weld-joint",l.TYPES[_.TYPE]=_,_._super=l,_.prototype=n(_._super.prototype);var p={frequencyHz:0,dampingRatio:0};function _(t,e,i,n){if(!(this instanceof _))return new _(t,e,i,n);t=o(t,p),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_localAnchorA=n?e.getLocalPoint(n):t.localAnchorA||a.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||a.zero(),this.m_referenceAngle=s.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=h(),this.m_bias=0,this.m_gamma=0,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new c}_.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},_._deserialize=function(t,e,i){return t.bodyA=i(m,t.bodyA,e),t.bodyB=i(m,t.bodyB,e),new _(t)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.getReferenceAngle=function(){return this.m_referenceAngle},_.prototype.setFrequency=function(t){this.m_frequencyHz=t},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return a.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},_.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.a,r=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,l=u.neo(e),m=u.neo(n);this.m_rA=u.mulVec2(l,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mulVec2(m,a.sub(this.m_localAnchorB,this.m_localCenterB));var p=this.m_invMassA,_=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,y=new c;if(y.ex.x=p+_+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*f,y.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*f,y.ez.x=-this.m_rA.y*d-this.m_rB.y*f,y.ex.y=y.ey.x,y.ey.y=p+_+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*f,y.ez.y=this.m_rA.x*d+this.m_rB.x*f,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=d+f,this.m_frequencyHz>0){y.getInverse22(this.m_mass);var v=d+f,g=v>0?1/v:0,b=n-e-this.m_referenceAngle,x=2*s.PI*this.m_frequencyHz,A=2*g*this.m_dampingRatio*x,w=g*x*x,B=t.dt;this.m_gamma=B*(A+B*w),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=b*B*w*this.m_gamma,v+=this.m_gamma,this.m_mass.ez.z=0!=v?1/v:0}else 0==y.ez.z?(y.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(y.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);var T=a.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(p,T),o-=d*(a.cross(this.m_rA,T)+this.m_impulse.z),r.addMul(_,T),h+=f*(a.cross(this.m_rB,T)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=r,this.m_bodyB.c_velocity.w=h},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,n=this.m_bodyB.c_velocity.w,r=this.m_invMassA,s=this.m_invMassB,u=this.m_invIA,l=this.m_invIB;if(this.m_frequencyHz>0){var m=n-i,p=-this.m_mass.ez.z*(m+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=p,i-=u*p,n+=l*p,(f=a.zero()).addCombine(1,o,1,a.cross(n,this.m_rB)),f.subCombine(1,e,1,a.cross(i,this.m_rA));var _=a.neg(c.mulVec2(this.m_mass,f));this.m_impulse.x+=_.x,this.m_impulse.y+=_.y;var d=a.clone(_);e.subMul(r,d),i-=u*a.cross(this.m_rA,d),o.addMul(s,d),n+=l*a.cross(this.m_rB,d)}else{var f;(f=a.zero()).addCombine(1,o,1,a.cross(n,this.m_rB)),f.subCombine(1,e,1,a.cross(i,this.m_rA)),m=n-i;var y=h(f.x,f.y,m),v=h.neg(c.mulVec3(this.m_mass,y));this.m_impulse.add(v),d=a.neo(v.x,v.y),e.subMul(r,d),i-=u*(a.cross(this.m_rA,d)+v.z),o.addMul(s,d),n+=l*(a.cross(this.m_rB,d)+v.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=n},_.prototype.solvePositionConstraints=function(t){var e,i,o=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,l=this.m_bodyB.c_position.c,m=this.m_bodyB.c_position.a,p=u.neo(n),_=u.neo(m),d=this.m_invMassA,f=this.m_invMassB,y=this.m_invIA,v=this.m_invIB,g=u.mulVec2(p,a.sub(this.m_localAnchorA,this.m_localCenterA)),b=u.mulVec2(_,a.sub(this.m_localAnchorB,this.m_localCenterB)),x=new c;if(x.ex.x=d+f+g.y*g.y*y+b.y*b.y*v,x.ey.x=-g.y*g.x*y-b.y*b.x*v,x.ez.x=-g.y*y-b.y*v,x.ex.y=x.ey.x,x.ey.y=d+f+g.x*g.x*y+b.x*b.x*v,x.ez.y=g.x*y+b.x*v,x.ex.z=x.ez.x,x.ey.z=x.ez.y,x.ez.z=y+v,this.m_frequencyHz>0){(w=a.zero()).addCombine(1,l,1,b),w.subCombine(1,o,1,g),e=w.length(),i=0;var A=a.neg(x.solve22(w));o.subMul(d,A),n-=y*a.cross(g,A),l.addMul(f,A),m+=v*a.cross(b,A)}else{var w;(w=a.zero()).addCombine(1,l,1,b),w.subCombine(1,o,1,g);var B=m-n-this.m_referenceAngle;e=w.length(),i=s.abs(B);var T=h(w.x,w.y,B),E=h();if(x.ez.z>0)E=h.neg(x.solve33(T));else{var I=a.neg(x.solve22(w));E.set(I.x,I.y,0)}A=a.neo(E.x,E.y),o.subMul(d,A),n-=y*(a.cross(g,A)+E.z),l.addMul(f,A),m+=v*(a.cross(b,A)+E.z)}return this.m_bodyA.c_position.c=o,this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c=l,this.m_bodyB.c_position.a=m,e<=r.linearSlop&&i<=r.angularSlop}},2707:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=m;var o=i(4896),n=i(4175),r=i(1099),s=i(5387),a=i(6306),h=(i(4470),i(6173),i(7515),i(3766)),c=(i(5385),i(8850),i(5235),i(8601),i(5878)),u=i(2129);m.TYPE="wheel-joint",c.TYPES[m.TYPE]=m,m._super=c,m.prototype=n(m._super.prototype);var l={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7};function m(t,e,i,n,r){if(!(this instanceof m))return new m(t,e,i,n,r);t=o(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=m.TYPE,this.m_localAnchorA=a.clone(n?e.getLocalPoint(n):t.localAnchorA||a.zero()),this.m_localAnchorB=a.clone(n?i.getLocalPoint(n):t.localAnchorB||a.zero()),this.m_localXAxisA=a.clone(r?e.getLocalVector(r):t.localAxisA||t.localAxis||a.neo(1,0)),this.m_localYAxisA=a.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_ax=a.zero(),this.m_ay=a.zero(),this.m_sAx,this.m_sBx,this.m_sAy,this.m_sBy}m.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}},m._deserialize=function(t,e,i){return t.bodyA=i(u,t.bodyA,e),t.bodyB=i(u,t.bodyB,e),new m(t)},m.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.localAxisA&&(this.m_localXAxisA.set(t.localAxisA),this.m_localYAxisA.set(a.cross(1,t.localAxisA)))},m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.getLocalAxisA=function(){return this.m_localXAxisA},m.prototype.getJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.getWorldPoint(this.m_localAnchorA),o=e.getWorldPoint(this.m_localAnchorB),n=a.sub(o,i),r=t.getWorldVector(this.m_localXAxisA);return a.dot(n,r)},m.prototype.getJointSpeed=function(){var t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},m.prototype.isMotorEnabled=function(){return this.m_enableMotor},m.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},m.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},m.prototype.getMotorSpeed=function(){return this.m_motorSpeed},m.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},m.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},m.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},m.prototype.setSpringFrequencyHz=function(t){this.m_frequencyHz=t},m.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},m.prototype.setSpringDampingRatio=function(t){this.m_dampingRatio=t},m.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)},m.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,i=this.m_invMassB,o=this.m_invIA,n=this.m_invIB,r=this.m_bodyA.c_position.c,c=this.m_bodyA.c_position.a,u=this.m_bodyA.c_velocity.v,l=this.m_bodyA.c_velocity.w,m=this.m_bodyB.c_position.c,p=this.m_bodyB.c_position.a,_=this.m_bodyB.c_velocity.v,d=this.m_bodyB.c_velocity.w,f=h.neo(c),y=h.neo(p),v=h.mulVec2(f,a.sub(this.m_localAnchorA,this.m_localCenterA)),g=h.mulVec2(y,a.sub(this.m_localAnchorB,this.m_localCenterB));if((w=a.zero()).addCombine(1,m,1,g),w.subCombine(1,r,1,v),this.m_ay=h.mulVec2(f,this.m_localYAxisA),this.m_sAy=a.cross(a.add(w,v),this.m_ay),this.m_sBy=a.cross(g,this.m_ay),this.m_mass=e+i+o*this.m_sAy*this.m_sAy+n*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=h.mulVec2(f,this.m_localXAxisA),this.m_sAx=a.cross(a.add(w,v),this.m_ax),this.m_sBx=a.cross(g,this.m_ax);var b=e+i+o*this.m_sAx*this.m_sAx+n*this.m_sBx*this.m_sBx;if(b>0){this.m_springMass=1/b;var x=a.dot(w,this.m_ax),A=2*s.PI*this.m_frequencyHz,w=2*this.m_springMass*this.m_dampingRatio*A,B=this.m_springMass*A*A,T=t.dt;this.m_gamma=T*(w+T*B),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=x*T*B*this.m_gamma,this.m_springMass=b+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=o+n,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var E=a.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),I=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,C=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;u.subMul(this.m_invMassA,E),l-=this.m_invIA*I,_.addMul(this.m_invMassB,E),d+=this.m_invIB*C}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(u),this.m_bodyA.c_velocity.w=l,this.m_bodyB.c_velocity.v.set(_),this.m_bodyB.c_velocity.w=d},m.prototype.solveVelocityConstraints=function(t){var e=this.m_invMassA,i=this.m_invMassB,o=this.m_invIA,n=this.m_invIB,r=this.m_bodyA.c_velocity.v,h=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,l=a.dot(this.m_ax,c)-a.dot(this.m_ax,r)+this.m_sBx*u-this.m_sAx*h,m=-this.m_springMass*(l+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=m;var p=a.mul(m,this.m_ax),_=m*this.m_sAx,d=m*this.m_sBx;r.subMul(e,p),h-=o*_,c.addMul(i,p),l=(u+=n*d)-h-this.m_motorSpeed,m=-this.m_motorMass*l;var f=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.clamp(this.m_motorImpulse+m,-y,y),h-=o*(m=this.m_motorImpulse-f),u+=n*m,l=a.dot(this.m_ay,c)-a.dot(this.m_ay,r)+this.m_sBy*u-this.m_sAy*h,m=-this.m_mass*l,this.m_impulse+=m,p=a.mul(m,this.m_ay),_=m*this.m_sAy,d=m*this.m_sBy,r.subMul(e,p),h-=o*_,c.addMul(i,p),u+=n*d,this.m_bodyA.c_velocity.v.set(r),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u},m.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,c=h.neo(i),u=h.neo(n),l=h.mulVec2(c,a.sub(this.m_localAnchorA,this.m_localCenterA)),m=h.mulVec2(u,a.sub(this.m_localAnchorB,this.m_localCenterB)),p=a.zero();p.addCombine(1,o,1,m),p.subCombine(1,e,1,l);var _,d=h.mulVec2(c,this.m_localYAxisA),f=a.cross(a.add(p,l),d),y=a.cross(m,d),v=a.dot(p,d),g=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;_=0!=g?-v/g:0;var b=a.mul(_,d),x=_*f,A=_*y;return e.subMul(this.m_invMassA,b),i-=this.m_invIA*x,o.addMul(this.m_invMassB,b),n+=this.m_invIB*A,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(o),this.m_bodyB.c_position.a=n,s.abs(v)<=r.linearSlop}},2134:(t,e,i)=>{var o=i(6972),n=i(2129),r=i(5878),s=(i(2322),0);function a(t){var e=(t=t||{}).stringify||JSON.stringify,i=t.parse||JSON.parse,a=t.rootClass||o,h=t.preSerialize||function(t){return t},c=t.postSerialize||function(t,e){return t},u=t.preDeserialize||function(t){return t},l=t.postDeserialize||function(t,e){return t},m={World:o,Body:n,Joint:r};this.toJson=function(t){var i=[],o=[t],n={};function r(t,e){if(t.__sid=t.__sid||++s,!n[t.__sid]){o.push(t);var r={refIndex:i.length+o.length,refType:e};n[t.__sid]=r}return n[t.__sid]}function a(t){var e=(t=h(t))._serialize();return c(e,t)}for(;o.length;){var u=o.shift(),l=e(u,(function(t,e){if("object"!=typeof e||null===e)return e;if("function"!=typeof e._serialize)return e;if(e===u)return a(e);for(var i in m)if(e instanceof m[i])return r(e,i);return a(e)}),"  ");i.push(l)}return"["+i.join(",")+"]"},this.fromJson=function(t){var e=i(t),o={};function n(t,e,i){e=u(e);var o=t._deserialize(e,i,r);return l(o,e)}function r(t,i,r){if(!i.refIndex)return t&&t._deserialize&&n(t,i,r);t=m[i.refType]||t;var s=i.refIndex;if(!o[s]){var a=n(t,e[s],r);o[s]=a}return o[s]}return a._deserialize(e[0],null,r)}}t.exports=a;var h=new a;t.exports.toJson=h.toJson,t.exports.fromJson=h.fromJson},7639:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=r,i(2274);var o=i(4175),n=i(8901);function r(t,e,i,o){if(!(this instanceof r))return new r(t,e,i,o);r._super.call(this),this._setAsBox(t,e,i,o)}r._super=n,r.prototype=o(r._super.prototype),r.TYPE="polygon"},2642:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=l;var n=i(2274),r=i(4175),s=(i(4896),i(5387),i(8850)),a=(i(3766),i(6306)),h=(i(3406),i(1099)),c=i(2322),u=i(3581);function l(t,e){if(!(this instanceof l))return new l(t,e);l._super.call(this),this.m_type=l.TYPE,this.m_radius=h.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_isLoop=e,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}l._super=c,l.prototype=r(l._super.prototype),l.TYPE="chain",c.TYPES[l.TYPE]=l,l.prototype._serialize=function(){const t={type:this.m_type,vertices:this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex};return this.m_prevVertex&&(t.prevVertex=this.m_prevVertex),this.m_nextVertex&&(t.nextVertex=this.m_nextVertex),t},l._deserialize=function(t){var e=new l(t.vertices.map(a._deserialize),t.isLoop);return t.prevVertex&&e._setPrevVertex(t.prevVertex),t.nextVertex&&e._setNextVertex(t.nextVertex),e},l.prototype._createLoop=function(t){o&&n.assert(0==this.m_vertices.length&&0==this.m_count),o&&n.assert(t.length>=3);for(var e=1;e<t.length;++e){var i=t[e-1],r=t[e];o&&n.assert(a.distanceSquared(i,r)>h.linearSlopSquared)}for(this.m_vertices.length=0,this.m_count=t.length+1,e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_vertices[t.length]=t[0].clone(),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},l.prototype._createChain=function(t){o&&n.assert(0==this.m_vertices.length&&0==this.m_count),o&&n.assert(t.length>=2);for(var e=1;e<t.length;++e){var i=t[e-1],r=t[e];o&&n.assert(a.distanceSquared(i,r)>h.linearSlopSquared)}for(this.m_count=t.length,e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},l.prototype._setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},l.prototype._setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},l.prototype._clone=function(){var t=new l;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},l.prototype.getChildCount=function(){return this.m_count-1},l.prototype.getChildEdge=function(t,e){o&&n.assert(0<=e&&e<this.m_count-1),t.m_type=u.TYPE,t.m_radius=this.m_radius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},l.prototype.getVertex=function(t){return o&&n.assert(0<=t&&t<=this.m_count),t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},l.prototype.testPoint=function(t,e){return!1},l.prototype.rayCast=function(t,e,i,r){return o&&n.assert(0<=r&&r<this.m_count),new u(this.getVertex(r),this.getVertex(r+1)).rayCast(t,e,i,0)},l.prototype.computeAABB=function(t,e,i){o&&n.assert(0<=i&&i<this.m_count);var r=s.mulVec2(e,this.getVertex(i)),a=s.mulVec2(e,this.getVertex(i+1));t.combinePoints(r,a)},l.prototype.computeMass=function(t,e){t.mass=0,t.center=a.neo(),t.I=0},l.prototype.computeDistanceProxy=function(t,e){o&&n.assert(0<=e&&e<this.m_count),t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius}},3335:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=u;var n=i(2274),r=i(4175),s=(i(4896),i(5387)),a=(i(8850),i(3766)),h=i(6306),c=(i(3406),i(1099),i(2322));function u(t,e){if(!(this instanceof u))return new u(t,e);u._super.call(this),this.m_type=u.TYPE,this.m_p=h.zero(),this.m_radius=1,"object"==typeof t&&h.isValid(t)?(this.m_p.set(t),"number"==typeof e&&(this.m_radius=e)):"number"==typeof t&&(this.m_radius=t)}u._super=c,u.prototype=r(u._super.prototype),u.TYPE="circle",c.TYPES[u.TYPE]=u,u.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}},u._deserialize=function(t){return new u(t.p,t.radius)},u.prototype.getRadius=function(){return this.m_radius},u.prototype.getCenter=function(){return this.m_p},u.prototype.getVertex=function(t){return o&&n.assert(0==t),this.m_p},u.prototype.getVertexCount=function(t){return 1},u.prototype._clone=function(){var t=new u;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},u.prototype.getChildCount=function(){return 1},u.prototype.testPoint=function(t,e){var i=h.add(t.p,a.mulVec2(t.q,this.m_p)),o=h.sub(e,i);return h.dot(o,o)<=this.m_radius*this.m_radius},u.prototype.rayCast=function(t,e,i,o){var n=h.add(i.p,a.mulVec2(i.q,this.m_p)),r=h.sub(e.p1,n),c=h.dot(r,r)-this.m_radius*this.m_radius,u=h.sub(e.p2,e.p1),l=h.dot(r,u),m=h.dot(u,u),p=l*l-m*c;if(p<0||m<s.EPSILON)return!1;var _=-(l+s.sqrt(p));return 0<=_&&_<=e.maxFraction*m&&(_/=m,t.fraction=_,t.normal=h.add(r,h.mul(_,u)),t.normal.normalize(),!0)},u.prototype.computeAABB=function(t,e,i){var o=h.add(e.p,a.mulVec2(e.q,this.m_p));t.lowerBound.set(o.x-this.m_radius,o.y-this.m_radius),t.upperBound.set(o.x+this.m_radius,o.y+this.m_radius)},u.prototype.computeMass=function(t,e){t.mass=e*s.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+h.dot(this.m_p,this.m_p))},u.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius}},8871:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(2274),r=(i(4175),i(5387),i(8850)),s=i(6306),a=(i(1099),i(2322),i(8730)),h=i(226),c=i(3335);function u(t,e,i,o,n){t.pointCount=0;var a=r.mulVec2(i,e.m_p),c=r.mulVec2(n,o.m_p),u=s.distanceSquared(c,a),l=e.m_radius+o.m_radius;u>l*l||(t.type=h.e_circles,t.localPoint.set(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(o.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex)}a.addType(c.TYPE,c.TYPE,(function(t,e,i,r,s,a,h){o&&n.assert(i.getType()==c.TYPE),o&&n.assert(a.getType()==c.TYPE),u(t,i.getShape(),e,a.getShape(),s)})),e.CollideCircles=u},9415:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(2274),r=i(5387),s=i(8850),a=(i(3766),i(6306)),h=(i(3406),i(1099),i(226)),c=i(8730),u=(i(2322),i(3335)),l=i(8901);c.addType(l.TYPE,u.TYPE,(function(t,e,i,c,m,p,_){o&&n.assert(i.getType()==l.TYPE),o&&n.assert(p.getType()==u.TYPE),function(t,e,i,o,n){t.pointCount=0;for(var c=s.mulVec2(n,o.m_p),u=s.mulTVec2(i,c),l=0,m=-1/0,p=e.m_radius+o.m_radius,_=e.m_count,d=e.m_vertices,f=e.m_normals,y=0;y<_;++y){var v=a.dot(f[y],a.sub(u,d[y]));if(v>p)return;v>m&&(m=v,l=y)}var g=l,b=g+1<_?g+1:0,x=d[g],A=d[b];if(m<r.EPSILON)return t.pointCount=1,t.type=h.e_faceA,t.localNormal.set(f[l]),t.localPoint.setCombine(.5,x,.5,A),t.points[0].localPoint=o.m_p,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=h.e_vertex);var w=a.dot(a.sub(u,x),a.sub(A,x)),B=a.dot(a.sub(u,A),a.sub(x,A));if(w<=0){if(a.distanceSquared(u,x)>p*p)return;t.pointCount=1,t.type=h.e_faceA,t.localNormal.setCombine(1,u,-1,x),t.localNormal.normalize(),t.localPoint=x,t.points[0].localPoint.set(o.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}else if(B<=0){if(a.distanceSquared(u,A)>p*p)return;t.pointCount=1,t.type=h.e_faceA,t.localNormal.setCombine(1,u,-1,A),t.localNormal.normalize(),t.localPoint.set(A),t.points[0].localPoint.set(o.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}else{var T=a.mid(x,A);if((m=a.dot(u,f[g])-a.dot(T,f[g]))>p)return;t.pointCount=1,t.type=h.e_faceA,t.localNormal.set(f[g]),t.localPoint.set(T),t.points[0].localPoint.set(o.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}}(t,i.getShape(),e,p.getShape(),m)}))},1867:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(2274),r=(i(4175),i(5387),i(8850)),s=i(6306),a=(i(3766),i(1099),i(2322),i(8730)),h=i(226),c=i(3581),u=i(2642),l=i(3335);function m(t,e,i,a,c){t.pointCount=0;var u=r.mulTVec2(i,r.mulVec2(c,a.m_p)),l=e.m_vertex1,m=e.m_vertex2,p=s.sub(m,l),_=s.dot(p,s.sub(m,u)),d=s.dot(p,s.sub(u,l)),f=e.m_radius+a.m_radius;if(d<=0){var y=s.clone(l),v=s.sub(u,y);if(s.dot(v,v)>f*f)return;if(e.m_hasVertex0){var g=e.m_vertex0,b=l,x=s.sub(b,g);if(s.dot(x,s.sub(b,u))>0)return}return t.type=h.e_circles,t.localNormal.setZero(),t.localPoint.set(y),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=h.e_vertex)}if(_<=0){if(y=s.clone(m),v=s.sub(u,y),s.dot(v,v)>f*f)return;if(e.m_hasVertex3){var A=e.m_vertex3,w=m,B=s.sub(A,w);if(s.dot(B,s.sub(u,w))>0)return}return t.type=h.e_circles,t.localNormal.setZero(),t.localPoint.set(y),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=h.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=h.e_vertex)}var T=s.dot(p,p);if(o&&n.assert(T>0),y=s.combine(_/T,l,d/T,m),v=s.sub(u,y),!(s.dot(v,v)>f*f)){var E=s.neo(-p.y,p.x);s.dot(E,s.sub(u,l))<0&&E.set(-E.x,-E.y),E.normalize(),t.type=h.e_faceA,t.localNormal=E,t.localPoint.set(l),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=h.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=h.e_vertex}}a.addType(c.TYPE,l.TYPE,(function(t,e,i,r,s,a,h){o&&n.assert(i.getType()==c.TYPE),o&&n.assert(a.getType()==l.TYPE),m(t,i.getShape(),e,a.getShape(),s)})),a.addType(u.TYPE,l.TYPE,(function(t,e,i,r,s,a,h){o&&n.assert(i.getType()==u.TYPE),o&&n.assert(a.getType()==l.TYPE);var p=i.getShape(),_=new c;p.getChildEdge(_,r),m(t,_,e,a.getShape(),s)}))},9221:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(2274),r=(i(4175),i(5387)),s=i(8850),a=i(6306),h=i(3766),c=i(1099),u=(i(2322),i(8730)),l=i(226),m=i(3581),p=i(2642),_=i(8901);function d(){this.type,this.index,this.separation}u.addType(m.TYPE,_.TYPE,(function(t,e,i,r,s,a,h){o&&n.assert(i.getType()==m.TYPE),o&&n.assert(a.getType()==_.TYPE),b(t,i.getShape(),e,a.getShape(),s)})),u.addType(p.TYPE,_.TYPE,(function(t,e,i,r,s,a,h){o&&n.assert(i.getType()==p.TYPE),o&&n.assert(a.getType()==_.TYPE);var c=i.getShape(),u=new m;c.getChildEdge(u,r),b(t,u,e,a.getShape(),s)}));var f=new d,y=new d,v=new function(){this.vertices=[],this.normals=[],this.count=0},g=new function(){this.i1,this.i2,this.v1,this.v2,this.normal=a.zero(),this.sideNormal1=a.zero(),this.sideOffset1,this.sideNormal2=a.zero(),this.sideOffset2};function b(t,e,i,o,n){var u=s.mulTXf(i,n),m=s.mulVec2(u,o.m_centroid),p=e.m_vertex0,_=e.m_vertex1,d=e.m_vertex2,b=e.m_vertex3,x=e.m_hasVertex0,A=e.m_hasVertex3,w=a.sub(d,_);w.normalize();var B,T=a.neo(w.y,-w.x),E=a.dot(T,a.sub(m,_)),I=0,C=0,S=!1,M=!1;if(x){var P=a.sub(_,p);P.normalize();var D=a.neo(P.y,-P.x);S=a.cross(P,w)>=0,I=a.dot(D,m)-a.dot(D,p)}if(A){var O=a.sub(b,d);O.normalize();var L=a.neo(O.y,-O.x);M=a.cross(w,O)>0,C=a.dot(L,m)-a.dot(L,d)}var V=a.zero(),N=a.zero(),F=a.zero();x&&A?S&&M?(B=I>=0||E>=0||C>=0)?(V.set(T),N.set(D),F.set(L)):(V.setMul(-1,T),N.setMul(-1,T),F.setMul(-1,T)):S?(B=I>=0||E>=0&&C>=0)?(V.set(T),N.set(D),F.set(T)):(V.setMul(-1,T),N.setMul(-1,L),F.setMul(-1,T)):M?(B=C>=0||I>=0&&E>=0)?(V.set(T),N.set(T),F.set(L)):(V.setMul(-1,T),N.setMul(-1,T),F.setMul(-1,D)):(B=I>=0&&E>=0&&C>=0)?(V.set(T),N.set(T),F.set(T)):(V.setMul(-1,T),N.setMul(-1,L),F.setMul(-1,D)):x?S?(B=I>=0||E>=0)?(V.set(T),N.set(D),F.setMul(-1,T)):(V.setMul(-1,T),N.set(T),F.setMul(-1,T)):(B=I>=0&&E>=0)?(V.set(T),N.set(T),F.setMul(-1,T)):(V.setMul(-1,T),N.set(T),F.setMul(-1,D)):A?M?(B=E>=0||C>=0)?(V.set(T),N.setMul(-1,T),F.set(L)):(V.setMul(-1,T),N.setMul(-1,T),F.set(T)):(B=E>=0&&C>=0)?(V.set(T),N.setMul(-1,T),F.set(T)):(V.setMul(-1,T),N.setMul(-1,L),F.set(T)):(B=E>=0)?(V.set(T),N.setMul(-1,T),F.setMul(-1,T)):(V.setMul(-1,T),N.set(T),F.set(T)),v.count=o.m_count;for(var z=0;z<o.m_count;++z)v.vertices[z]=s.mulVec2(u,o.m_vertices[z]),v.normals[z]=h.mulVec2(u.q,o.m_normals[z]);var R=2*c.polygonRadius;for(t.pointCount=0,f.type=1,f.index=B?0:1,f.separation=1/0,z=0;z<v.count;++z)(q=a.dot(V,a.sub(v.vertices[z],_)))<f.separation&&(f.separation=q);if(-1!=f.type&&!(f.separation>R)){y.type=-1,y.index=-1,y.separation=-1/0;var k=a.neo(-V.y,V.x);for(z=0;z<v.count;++z){var q,j=a.neg(v.normals[z]),U=a.dot(j,a.sub(v.vertices[z],_)),G=a.dot(j,a.sub(v.vertices[z],d));if((q=r.min(U,G))>R){y.type=2,y.index=z,y.separation=q;break}if(a.dot(j,k)>=0){if(a.dot(a.sub(j,F),V)<-c.angularSlop)continue}else if(a.dot(a.sub(j,N),V)<-c.angularSlop)continue;q>y.separation&&(y.type=2,y.index=z,y.separation=q)}if(!(-1!=y.type&&y.separation>R)){var Y;Y=-1==y.type?f:y.separation>.98*f.separation+.001?y:f;var $=[new l.clipVertex,new l.clipVertex];if(1==Y.type){t.type=l.e_faceA;var W=0,J=a.dot(V,v.normals[0]);for(z=1;z<v.count;++z){var H=a.dot(V,v.normals[z]);H<J&&(J=H,W=z)}var X=W,K=X+1<v.count?X+1:0;$[0].v=v.vertices[X],$[0].id.cf.indexA=0,$[0].id.cf.indexB=X,$[0].id.cf.typeA=l.e_face,$[0].id.cf.typeB=l.e_vertex,$[1].v=v.vertices[K],$[1].id.cf.indexA=0,$[1].id.cf.indexB=K,$[1].id.cf.typeA=l.e_face,$[1].id.cf.typeB=l.e_vertex,B?(g.i1=0,g.i2=1,g.v1=_,g.v2=d,g.normal.set(T)):(g.i1=1,g.i2=0,g.v1=d,g.v2=_,g.normal.setMul(-1,T))}else t.type=l.e_faceB,$[0].v=_,$[0].id.cf.indexA=0,$[0].id.cf.indexB=Y.index,$[0].id.cf.typeA=l.e_vertex,$[0].id.cf.typeB=l.e_face,$[1].v=d,$[1].id.cf.indexA=0,$[1].id.cf.indexB=Y.index,$[1].id.cf.typeA=l.e_vertex,$[1].id.cf.typeB=l.e_face,g.i1=Y.index,g.i2=g.i1+1<v.count?g.i1+1:0,g.v1=v.vertices[g.i1],g.v2=v.vertices[g.i2],g.normal.set(v.normals[g.i1]);g.sideNormal1.set(g.normal.y,-g.normal.x),g.sideNormal2.setMul(-1,g.sideNormal1),g.sideOffset1=a.dot(g.sideNormal1,g.v1),g.sideOffset2=a.dot(g.sideNormal2,g.v2);var Z=[new l.clipVertex,new l.clipVertex],Q=[new l.clipVertex,new l.clipVertex];if(!(l.clipSegmentToLine(Z,$,g.sideNormal1,g.sideOffset1,g.i1)<c.maxManifoldPoints||l.clipSegmentToLine(Q,Z,g.sideNormal2,g.sideOffset2,g.i2)<c.maxManifoldPoints)){1==Y.type?(t.localNormal=a.clone(g.normal),t.localPoint=a.clone(g.v1)):(t.localNormal=a.clone(o.m_normals[g.i1]),t.localPoint=a.clone(o.m_vertices[g.i1]));var tt=0;for(z=0;z<c.maxManifoldPoints;++z)if(a.dot(g.normal,a.sub(Q[z].v,g.v1))<=R){var et=t.points[tt];1==Y.type?(et.localPoint=s.mulT(u,Q[z].v),et.id=Q[z].id):(et.localPoint=Q[z].v,et.id.cf.typeA=Q[z].id.cf.typeB,et.id.cf.typeB=Q[z].id.cf.typeA,et.id.cf.indexA=Q[z].id.cf.indexB,et.id.cf.indexB=Q[z].id.cf.indexA),++tt}t.pointCount=tt}}}}},6891:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT,n=i(2274),r=(i(5387),i(8850)),s=i(3766),a=i(6306),h=(i(3406),i(1099)),c=i(226),u=i(8730),l=(i(2322),i(8901));function m(t,e,i,o){for(var n=t.m_count,h=i.m_count,c=t.m_normals,u=t.m_vertices,l=i.m_vertices,p=r.mulTXf(o,e),_=0,d=-1/0,f=0;f<n;++f){for(var y=s.mulVec2(p.q,c[f]),v=r.mulVec2(p,u[f]),g=1/0,b=0;b<h;++b){var x=a.dot(y,l[b])-a.dot(y,v);x<g&&(g=x)}g>d&&(d=g,_=f)}m._maxSeparation=d,m._bestIndex=_}function p(t,e,i,u,l){t.pointCount=0;var p=e.m_radius+u.m_radius;m(e,i,u,l);var _=m._bestIndex,d=m._maxSeparation;if(!(d>p)){m(u,l,e,i);var f=m._bestIndex,y=m._maxSeparation;if(!(y>p)){var v,g,b,x,A,w;y>d+.1*h.linearSlop?(v=u,g=e,b=l,x=i,A=f,t.type=c.e_faceB,w=1):(v=e,g=u,b=i,x=l,A=_,t.type=c.e_faceA,w=0);var B=[new c.clipVertex,new c.clipVertex];!function(t,e,i,h,u,l){var m=e.m_normals,p=u.m_count,_=u.m_vertices,d=u.m_normals;o&&n.assert(0<=h&&h<e.m_count);for(var f=s.mulT(l.q,s.mulVec2(i.q,m[h])),y=0,v=1/0,g=0;g<p;++g){var b=a.dot(f,d[g]);b<v&&(v=b,y=g)}var x=y,A=x+1<p?x+1:0;t[0].v=r.mulVec2(l,_[x]),t[0].id.cf.indexA=h,t[0].id.cf.indexB=x,t[0].id.cf.typeA=c.e_face,t[0].id.cf.typeB=c.e_vertex,t[1].v=r.mulVec2(l,_[A]),t[1].id.cf.indexA=h,t[1].id.cf.indexB=A,t[1].id.cf.typeA=c.e_face,t[1].id.cf.typeB=c.e_vertex}(B,v,b,A,g,x);var T=v.m_count,E=v.m_vertices,I=A,C=A+1<T?A+1:0,S=E[I],M=E[C],P=a.sub(M,S);P.normalize();var D=a.cross(P,1),O=a.combine(.5,S,.5,M),L=s.mulVec2(b.q,P),V=a.cross(L,1);S=r.mulVec2(b,S),M=r.mulVec2(b,M);var N=a.dot(V,S),F=-a.dot(L,S)+p,z=a.dot(L,M)+p,R=[new c.clipVertex,new c.clipVertex],k=[new c.clipVertex,new c.clipVertex];if(!(c.clipSegmentToLine(R,B,a.neg(L),F,I)<2||c.clipSegmentToLine(k,R,L,z,C)<2)){t.localNormal=D,t.localPoint=O;for(var q=0,j=0;j<k.length;++j)if(a.dot(V,k[j].v)-N<=p){var U=t.points[q];if(U.localPoint.set(r.mulTVec2(x,k[j].v)),U.id=k[j].id,w){var G=U.id.cf,Y=G.indexA,$=G.indexB,W=G.typeA,J=G.typeB;G.indexA=$,G.indexB=Y,G.typeA=J,G.typeB=W}++q}t.pointCount=q}}}}t.exports=p,u.addType(l.TYPE,l.TYPE,(function(t,e,i,r,s,a,h){o&&n.assert(i.getType()==l.TYPE),o&&n.assert(a.getType()==l.TYPE),p(t,i.getShape(),e,a.getShape(),s)}))},3581:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=c;var o=i(4175),n=(i(4896),i(1099)),r=i(2322),s=(i(5387),i(8850)),a=i(3766),h=i(6306);function c(t,e){if(!(this instanceof c))return new c(t,e);c._super.call(this),this.m_type=c.TYPE,this.m_radius=n.polygonRadius,this.m_vertex1=t?h.clone(t):h.zero(),this.m_vertex2=e?h.clone(e):h.zero(),this.m_vertex0=h.zero(),this.m_vertex3=h.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1}i(3406),c._super=r,c.prototype=o(c._super.prototype),c.TYPE="edge",r.TYPES[c.TYPE]=c,c.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}},c._deserialize=function(t){var e=new c(t.vertex1,t.vertex2);return e.hasVertex0&&e.setPrev(t.vertex0),e.hasVertex3&&e.setNext(t.vertex3),e},c.prototype.setNext=function(t){return t?(this.m_vertex3.set(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},c.prototype.setPrev=function(t){return t?(this.m_vertex0.set(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},c.prototype._set=function(t,e){return this.m_vertex1.set(t),this.m_vertex2.set(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},c.prototype._clone=function(){var t=new c;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.set(this.m_vertex1),t.m_vertex2.set(this.m_vertex2),t.m_vertex0.set(this.m_vertex0),t.m_vertex3.set(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t},c.prototype.getChildCount=function(){return 1},c.prototype.testPoint=function(t,e){return!1},c.prototype.rayCast=function(t,e,i,o){var n=a.mulTVec2(i.q,h.sub(e.p1,i.p)),r=a.mulTVec2(i.q,h.sub(e.p2,i.p)),s=h.sub(r,n),c=this.m_vertex1,u=this.m_vertex2,l=h.sub(u,c),m=h.neo(l.y,-l.x);m.normalize();var p=h.dot(m,h.sub(c,n)),_=h.dot(m,s);if(0==_)return!1;var d=p/_;if(d<0||e.maxFraction<d)return!1;var f=h.add(n,h.mul(d,s)),y=h.sub(u,c),v=h.dot(y,y);if(0==v)return!1;var g=h.dot(h.sub(f,c),y)/v;return!(g<0||1<g||(t.fraction=d,t.normal=p>0?a.mulVec2(i.q,m).neg():a.mulVec2(i.q,m),0))},c.prototype.computeAABB=function(t,e,i){var o=s.mulVec2(e,this.m_vertex1),n=s.mulVec2(e,this.m_vertex2);t.combinePoints(o,n),t.extend(this.m_radius)},c.prototype.computeMass=function(t,e){t.mass=0,t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},c.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}},8901:(t,e,i)=>{"undefined"!=typeof DEBUG&&DEBUG;var o="undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var n=i(2274),r=i(4175),s=(i(4896),i(5387)),a=i(8850),h=i(3766),c=i(6306),u=(i(3406),i(1099)),l=i(2322);function m(t){if(!(this instanceof m))return new m(t);m._super.call(this),this.m_type=m.TYPE,this.m_radius=u.polygonRadius,this.m_centroid=c.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,t&&t.length&&this._set(t)}m._super=l,m.prototype=r(m._super.prototype),m.TYPE="polygon",l.TYPES[m.TYPE]=m,m.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}},m._deserialize=function(t,e,i){return new m(t.vertices&&t.vertices.map((t=>c._deserialize(t))))},m.prototype.getVertex=function(t){return o&&n.assert(0<=t&&t<this.m_count),this.m_vertices[t]},m.prototype._clone=function(){var t=new m;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.set(this.m_centroid);for(var e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t},m.prototype.getChildCount=function(){return 1},m.prototype._reset=function(){this._set(this.m_vertices)},m.prototype._set=function(t){if(o&&n.assert(3<=t.length&&t.length<=u.maxPolygonVertices),t.length<3)this._setAsBox(1,1);else{for(var e=s.min(t.length,u.maxPolygonVertices),i=[],r=0;r<e;++r){for(var a=t[r],h=!0,l=0;l<i.length;++l)if(c.distanceSquared(a,i[l])<.25*u.linearSlopSquared){h=!1;break}h&&i.push(a)}if((e=i.length)<3)return o&&n.assert(!1),void this._setAsBox(1,1);var m=0,p=i[0].x;for(r=1;r<e;++r){var _=i[r].x;(_>p||_===p&&i[r].y<i[m].y)&&(m=r,p=_)}for(var d=[],f=0,y=m;;){d[f]=y;var v=0;for(l=1;l<e;++l)if(v!==y){var g=c.sub(i[v],i[d[f]]),b=(a=c.sub(i[l],i[d[f]]),c.cross(g,a));b<0&&(v=l),0===b&&a.lengthSquared()>g.lengthSquared()&&(v=l)}else v=l;if(++f,y=v,v===m)break}if(f<3)return o&&n.assert(!1),void this._setAsBox(1,1);for(this.m_count=f,this.m_vertices=[],r=0;r<f;++r)this.m_vertices[r]=i[d[r]];for(r=0;r<f;++r){var x=r,A=r+1<f?r+1:0,w=c.sub(this.m_vertices[A],this.m_vertices[x]);o&&n.assert(w.lengthSquared()>s.EPSILON*s.EPSILON),this.m_normals[r]=c.cross(w,1),this.m_normals[r].normalize()}this.m_centroid=function(t,e){o&&n.assert(e>=3);for(var i=c.zero(),r=0,a=c.zero(),h=1/3,u=0;u<e;++u){var l=a,m=t[u],p=u+1<e?t[u+1]:t[0],_=c.sub(m,l),d=c.sub(p,l),f=.5*c.cross(_,d);r+=f,i.addMul(f*h,l),i.addMul(f*h,m),i.addMul(f*h,p)}return o&&n.assert(r>s.EPSILON),i.mul(1/r),i}(this.m_vertices,f)}},m.prototype._setAsBox=function(t,e,i,o){if(this.m_vertices[0]=c.neo(t,-e),this.m_vertices[1]=c.neo(t,e),this.m_vertices[2]=c.neo(-t,e),this.m_vertices[3]=c.neo(-t,-e),this.m_normals[0]=c.neo(1,0),this.m_normals[1]=c.neo(0,1),this.m_normals[2]=c.neo(-1,0),this.m_normals[3]=c.neo(0,-1),this.m_count=4,c.isValid(i)){o=o||0,this.m_centroid.set(i);var n=a.identity();n.p.set(i),n.q.set(o);for(var r=0;r<this.m_count;++r)this.m_vertices[r]=a.mulVec2(n,this.m_vertices[r]),this.m_normals[r]=h.mulVec2(n.q,this.m_normals[r])}},m.prototype.testPoint=function(t,e){for(var i=h.mulTVec2(t.q,c.sub(e,t.p)),o=0;o<this.m_count;++o)if(c.dot(this.m_normals[o],c.sub(i,this.m_vertices[o]))>0)return!1;return!0},m.prototype.rayCast=function(t,e,i,r){for(var s=h.mulTVec2(i.q,c.sub(e.p1,i.p)),a=h.mulTVec2(i.q,c.sub(e.p2,i.p)),u=c.sub(a,s),l=0,m=e.maxFraction,p=-1,_=0;_<this.m_count;++_){var d=c.dot(this.m_normals[_],c.sub(this.m_vertices[_],s)),f=c.dot(this.m_normals[_],u);if(0==f){if(d<0)return!1}else f<0&&d<l*f?(l=d/f,p=_):f>0&&d<m*f&&(m=d/f);if(m<l)return!1}return o&&n.assert(0<=l&&l<=e.maxFraction),p>=0&&(t.fraction=l,t.normal=h.mulVec2(i.q,this.m_normals[p]),!0)},m.prototype.computeAABB=function(t,e,i){for(var o=1/0,n=1/0,r=-1/0,h=-1/0,c=0;c<this.m_count;++c){var u=a.mulVec2(e,this.m_vertices[c]);o=s.min(o,u.x),r=s.max(r,u.x),n=s.min(n,u.y),h=s.max(h,u.y)}t.lowerBound.set(o,n),t.upperBound.set(r,h),t.extend(this.m_radius)},m.prototype.computeMass=function(t,e){o&&n.assert(this.m_count>=3);for(var i=c.zero(),r=0,a=0,h=c.zero(),u=0;u<this.m_count;++u)h.add(this.m_vertices[u]);h.mul(1/this.m_count);var l=1/3;for(u=0;u<this.m_count;++u){var m=c.sub(this.m_vertices[u],h),p=u+1<this.m_count?c.sub(this.m_vertices[u+1],h):c.sub(this.m_vertices[0],h),_=c.cross(m,p),d=.5*_;r+=d,i.addCombine(d*l,m,d*l,p);var f=m.x,y=m.y,v=p.x,g=p.y;a+=.25*l*_*(f*f+v*f+v*v+(y*y+g*y+g*g))}t.mass=e*r,o&&n.assert(r>s.EPSILON),i.mul(1/r),t.center.setCombine(1,i,1,h),t.I=e*a,t.I+=t.mass*(c.dot(t.center,t.center)-c.dot(i,i))},m.prototype.validate=function(){for(var t=0;t<this.m_count;++t)for(var e=t,i=t<this.m_count-1?e+1:0,o=this.m_vertices[e],n=c.sub(this.m_vertices[i],o),r=0;r<this.m_count;++r)if(r!=e&&r!=i){var s=c.sub(this.m_vertices[r],o);if(c.cross(n,s)<0)return!1}return!0},m.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}},5706:t=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports=function(t){var e=[],i=t.max||1/0,o=t.create,n=t.allocate,r=t.release,s=t.discard,a=0,h=0,c=0,u=0;this.max=function(t){return"number"==typeof t?(i=t,this):i},this.size=function(){return e.length},this.allocate=function(){var t;return e.length>0?t=e.shift():(a++,t="function"==typeof o?o():{}),h++,"function"==typeof n&&n(t),t},this.release=function(t){e.length<i?(c++,"function"==typeof r&&r(t),e.push(t)):(u++,"function"==typeof s&&(t=s(t)))},this.toString=function(){return" +"+a+" >"+h+" <"+c+" -"+u+" ="+e.length+"/"+i}}},9205:t=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,t.exports.now=function(){return Date.now()},t.exports.diff=function(t){return Date.now()-t}},2274:(t,e)=>{var i="undefined"!=typeof DEBUG&&DEBUG,o="undefined"!=typeof ASSERT&&ASSERT;e.debug=function(){i&&console.log.apply(console,arguments)},e.assert=function(t,e,i){if(o&&!t)throw i&&console.log(i),new Error(e)}},4175:t=>{if("function"==typeof Object.create)t.exports=function(t,e){return Object.create.call(Object,t,e)};else{function e(){}t.exports=function(t,i){if(i)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return e.prototype=t,new e}}},4896:t=>{"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,Object.prototype.propertyIsEnumerable,t.exports=function(t,e){for(var i in null==t&&(t={}),e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i]);if("function"==typeof Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),n=0;n<o.length;n++){var r=o[n];e.propertyIsEnumerable(r)&&void 0===t[i]&&(t[r]=e[r])}return t}},6099:(t,e,i)=>{!function(t){t.parser=function(t,e){return new n(t,e)},t.SAXParser=n,t.SAXStream=s,t.createStream=function(t,e){return new s(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,o=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(e,i){if(!(this instanceof n))return new n(e,i);var r=this;!function(t){for(var e=0,i=o.length;e<i;e++)t[o[e]]=""}(r),r.q=r.c="",r.bufferCheckPosition=t.MAX_BUFFER_LENGTH,r.opt=i||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!e,r.noscript=!(!e&&!r.opt.noscript),r.state=A.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=r.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(c)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),B(r,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),n.prototype={end:function(){S(this)},write:function(e){var i=this;if(this.error)throw this.error;if(i.closed)return C(i,"Cannot write after close. Assign an onready handler.");if(null===e)return S(i);"object"==typeof e&&(e=e.toString());for(var n=0,r="";r=z(e,n++),i.c=r,r;)switch(i.trackPosition&&(i.position++,"\n"===r?(i.line++,i.column=0):i.column++),i.state){case A.BEGIN:if(i.state=A.BEGIN_WHITESPACE,"\ufeff"===r)continue;F(i,r);continue;case A.BEGIN_WHITESPACE:F(i,r);continue;case A.TEXT:if(i.sawRoot&&!i.closedRoot){for(var s=n-1;r&&"<"!==r&&"&"!==r;)(r=z(e,n++))&&i.trackPosition&&(i.position++,"\n"===r?(i.line++,i.column=0):i.column++);i.textNode+=e.substring(s,n-1)}"<"!==r||i.sawRoot&&i.closedRoot&&!i.strict?(_(r)||i.sawRoot&&!i.closedRoot||M(i,"Text data outside of root node."),"&"===r?i.state=A.TEXT_ENTITY:i.textNode+=r):(i.state=A.OPEN_WAKA,i.startTagPosition=i.position);continue;case A.SCRIPT:"<"===r?i.state=A.SCRIPT_ENDING:i.script+=r;continue;case A.SCRIPT_ENDING:"/"===r?i.state=A.CLOSE_TAG:(i.script+="<"+r,i.state=A.SCRIPT);continue;case A.OPEN_WAKA:if("!"===r)i.state=A.SGML_DECL,i.sgmlDecl="";else if(_(r));else if(y(u,r))i.state=A.OPEN_TAG,i.tagName=r;else if("/"===r)i.state=A.CLOSE_TAG,i.tagName="";else if("?"===r)i.state=A.PROC_INST,i.procInstName=i.procInstBody="";else{if(M(i,"Unencoded <"),i.startTagPosition+1<i.position){var a=i.position-i.startTagPosition;r=new Array(a).join(" ")+r}i.textNode+="<"+r,i.state=A.TEXT}continue;case A.SGML_DECL:"[CDATA["===(i.sgmlDecl+r).toUpperCase()?(T(i,"onopencdata"),i.state=A.CDATA,i.sgmlDecl="",i.cdata=""):i.sgmlDecl+r==="--"?(i.state=A.COMMENT,i.comment="",i.sgmlDecl=""):"DOCTYPE"===(i.sgmlDecl+r).toUpperCase()?(i.state=A.DOCTYPE,(i.doctype||i.sawRoot)&&M(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):">"===r?(T(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=A.TEXT):d(r)?(i.state=A.SGML_DECL_QUOTED,i.sgmlDecl+=r):i.sgmlDecl+=r;continue;case A.SGML_DECL_QUOTED:r===i.q&&(i.state=A.SGML_DECL,i.q=""),i.sgmlDecl+=r;continue;case A.DOCTYPE:">"===r?(i.state=A.TEXT,T(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=r,"["===r?i.state=A.DOCTYPE_DTD:d(r)&&(i.state=A.DOCTYPE_QUOTED,i.q=r));continue;case A.DOCTYPE_QUOTED:i.doctype+=r,r===i.q&&(i.q="",i.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:i.doctype+=r,"]"===r?i.state=A.DOCTYPE:d(r)&&(i.state=A.DOCTYPE_DTD_QUOTED,i.q=r);continue;case A.DOCTYPE_DTD_QUOTED:i.doctype+=r,r===i.q&&(i.state=A.DOCTYPE_DTD,i.q="");continue;case A.COMMENT:"-"===r?i.state=A.COMMENT_ENDING:i.comment+=r;continue;case A.COMMENT_ENDING:"-"===r?(i.state=A.COMMENT_ENDED,i.comment=I(i.opt,i.comment),i.comment&&T(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+r,i.state=A.COMMENT);continue;case A.COMMENT_ENDED:">"!==r?(M(i,"Malformed comment"),i.comment+="--"+r,i.state=A.COMMENT):i.state=A.TEXT;continue;case A.CDATA:"]"===r?i.state=A.CDATA_ENDING:i.cdata+=r;continue;case A.CDATA_ENDING:"]"===r?i.state=A.CDATA_ENDING_2:(i.cdata+="]"+r,i.state=A.CDATA);continue;case A.CDATA_ENDING_2:">"===r?(i.cdata&&T(i,"oncdata",i.cdata),T(i,"onclosecdata"),i.cdata="",i.state=A.TEXT):"]"===r?i.cdata+="]":(i.cdata+="]]"+r,i.state=A.CDATA);continue;case A.PROC_INST:"?"===r?i.state=A.PROC_INST_ENDING:_(r)?i.state=A.PROC_INST_BODY:i.procInstName+=r;continue;case A.PROC_INST_BODY:if(!i.procInstBody&&_(r))continue;"?"===r?i.state=A.PROC_INST_ENDING:i.procInstBody+=r;continue;case A.PROC_INST_ENDING:">"===r?(T(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=A.TEXT):(i.procInstBody+="?"+r,i.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:y(l,r)?i.tagName+=r:(P(i),">"===r?L(i):"/"===r?i.state=A.OPEN_TAG_SLASH:(_(r)||M(i,"Invalid character in tag name"),i.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:">"===r?(L(i,!0),V(i)):(M(i,"Forward-slash in opening tag not followed by >"),i.state=A.ATTRIB);continue;case A.ATTRIB:if(_(r))continue;">"===r?L(i):"/"===r?i.state=A.OPEN_TAG_SLASH:y(u,r)?(i.attribName=r,i.attribValue="",i.state=A.ATTRIB_NAME):M(i,"Invalid attribute name");continue;case A.ATTRIB_NAME:"="===r?i.state=A.ATTRIB_VALUE:">"===r?(M(i,"Attribute without value"),i.attribValue=i.attribName,O(i),L(i)):_(r)?i.state=A.ATTRIB_NAME_SAW_WHITE:y(l,r)?i.attribName+=r:M(i,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if("="===r)i.state=A.ATTRIB_VALUE;else{if(_(r))continue;M(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",T(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",">"===r?L(i):y(u,r)?(i.attribName=r,i.state=A.ATTRIB_NAME):(M(i,"Invalid attribute name"),i.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(_(r))continue;d(r)?(i.q=r,i.state=A.ATTRIB_VALUE_QUOTED):(M(i,"Unquoted attribute value"),i.state=A.ATTRIB_VALUE_UNQUOTED,i.attribValue=r);continue;case A.ATTRIB_VALUE_QUOTED:if(r!==i.q){"&"===r?i.state=A.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=r;continue}O(i),i.q="",i.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:_(r)?i.state=A.ATTRIB:">"===r?L(i):"/"===r?i.state=A.OPEN_TAG_SLASH:y(u,r)?(M(i,"No whitespace between attributes"),i.attribName=r,i.attribValue="",i.state=A.ATTRIB_NAME):M(i,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!f(r)){"&"===r?i.state=A.ATTRIB_VALUE_ENTITY_U:i.attribValue+=r;continue}O(i),">"===r?L(i):i.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(i.tagName)">"===r?V(i):y(l,r)?i.tagName+=r:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=A.SCRIPT):(_(r)||M(i,"Invalid tagname in closing tag"),i.state=A.CLOSE_TAG_SAW_WHITE);else{if(_(r))continue;v(u,r)?i.script?(i.script+="</"+r,i.state=A.SCRIPT):M(i,"Invalid tagname in closing tag."):i.tagName=r}continue;case A.CLOSE_TAG_SAW_WHITE:if(_(r))continue;">"===r?V(i):M(i,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var h,c;switch(i.state){case A.TEXT_ENTITY:h=A.TEXT,c="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:h=A.ATTRIB_VALUE_QUOTED,c="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:h=A.ATTRIB_VALUE_UNQUOTED,c="attribValue"}";"===r?(i[c]+=N(i),i.entity="",i.state=h):y(i.entity.length?p:m,r)?i.entity+=r:(M(i,"Invalid character in entity name"),i[c]+="&"+i.entity+r,i.entity="",i.state=h);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&function(e){for(var i=Math.max(t.MAX_BUFFER_LENGTH,10),n=0,r=0,s=o.length;r<s;r++){var a=e[o[r]].length;if(a>i)switch(o[r]){case"textNode":E(e);break;case"cdata":T(e,"oncdata",e.cdata),e.cdata="";break;case"script":T(e,"onscript",e.script),e.script="";break;default:C(e,"Max buffer length exceeded: "+o[r])}n=Math.max(n,a)}var h=t.MAX_BUFFER_LENGTH-n;e.bufferCheckPosition=h+e.position}(i),i},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;E(t=this),""!==t.cdata&&(T(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(T(t,"onscript",t.script),t.script="")}};try{e=Object(function(){var t=new Error("Cannot find module 'stream'");throw t.code="MODULE_NOT_FOUND",t}()).Stream}catch(t){e=function(){}}var r=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function s(t,i){if(!(this instanceof s))return new s(t,i);e.apply(this),this._parser=new n(t,i),this.writable=!0,this.readable=!0;var o=this;this._parser.onend=function(){o.emit("end")},this._parser.onerror=function(t){o.emit("error",t),o._parser.error=null},this._decoder=null,r.forEach((function(t){Object.defineProperty(o,"on"+t,{get:function(){return o._parser["on"+t]},set:function(e){if(!e)return o.removeAllListeners(t),o._parser["on"+t]=e,e;o.on(t,e)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(e.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=i(2553).s;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(t,i){var o=this;return o._parser["on"+t]||-1===r.indexOf(t)||(o._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),o.emit.apply(o,e)}),e.prototype.on.call(o,t,i)};var a="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",c={xml:a,xmlns:h},u=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,l=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function _(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function d(t){return'"'===t||"'"===t}function f(t){return">"===t||_(t)}function y(t,e){return t.test(e)}function v(t,e){return!y(t,e)}var g,b,x,A=0;for(var w in t.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var i=t.ENTITIES[e],o="number"==typeof i?String.fromCharCode(i):i;t.ENTITIES[e]=o})),t.STATE)t.STATE[t.STATE[w]]=w;function B(t,e,i){t[e]&&t[e](i)}function T(t,e,i){t.textNode&&E(t),B(t,e,i)}function E(t){t.textNode=I(t.opt,t.textNode),t.textNode&&B(t,"ontext",t.textNode),t.textNode=""}function I(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function C(t,e){return E(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,B(t,"onerror",e),t}function S(t){return t.sawRoot&&!t.closedRoot&&M(t,"Unclosed root tag"),t.state!==A.BEGIN&&t.state!==A.BEGIN_WHITESPACE&&t.state!==A.TEXT&&C(t,"Unexpected end"),E(t),t.c="",t.closed=!0,B(t,"onend"),n.call(t,t.strict,t.opt),t}function M(t,e){if("object"!=typeof t||!(t instanceof n))throw new Error("bad call to strictFail");t.strict&&C(t,e)}function P(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,i=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(i.ns=e.ns),t.attribList.length=0,T(t,"onopentagstart",i)}function D(t,e){var i=t.indexOf(":")<0?["",t]:t.split(":"),o=i[0],n=i[1];return e&&"xmlns"===t&&(o="xmlns",n=""),{prefix:o,local:n}}function O(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=D(t.attribName,!0),i=e.prefix,o=e.local;if("xmlns"===i)if("xml"===o&&t.attribValue!==a)M(t,"xml: prefix must be bound to "+a+"\nActual: "+t.attribValue);else if("xmlns"===o&&t.attribValue!==h)M(t,"xmlns: prefix must be bound to "+h+"\nActual: "+t.attribValue);else{var n=t.tag,r=t.tags[t.tags.length-1]||t;n.ns===r.ns&&(n.ns=Object.create(r.ns)),n.ns[o]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,T(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function L(t,e){if(t.opt.xmlns){var i=t.tag,o=D(t.tagName);i.prefix=o.prefix,i.local=o.local,i.uri=i.ns[o.prefix]||"",i.prefix&&!i.uri&&(M(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),i.uri=o.prefix);var n=t.tags[t.tags.length-1]||t;i.ns&&n.ns!==i.ns&&Object.keys(i.ns).forEach((function(e){T(t,"onopennamespace",{prefix:e,uri:i.ns[e]})}));for(var r=0,s=t.attribList.length;r<s;r++){var a=t.attribList[r],h=a[0],c=a[1],u=D(h,!0),l=u.prefix,m=u.local,p=""===l?"":i.ns[l]||"",_={name:h,value:c,prefix:l,local:m,uri:p};l&&"xmlns"!==l&&!p&&(M(t,"Unbound namespace prefix: "+JSON.stringify(l)),_.uri=l),t.tag.attributes[h]=_,T(t,"onattribute",_)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),T(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=A.TEXT:t.state=A.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function V(t){if(!t.tagName)return M(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=A.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=A.SCRIPT);T(t,"onscript",t.script),t.script=""}var e=t.tags.length,i=t.tagName;t.strict||(i=i[t.looseCase]());for(var o=i;e--&&t.tags[e].name!==o;)M(t,"Unexpected close tag");if(e<0)return M(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=A.TEXT);t.tagName=i;for(var n=t.tags.length;n-- >e;){var r=t.tag=t.tags.pop();t.tagName=t.tag.name,T(t,"onclosetag",t.tagName);var s={};for(var a in r.ns)s[a]=r.ns[a];var h=t.tags[t.tags.length-1]||t;t.opt.xmlns&&r.ns!==h.ns&&Object.keys(r.ns).forEach((function(e){var i=r.ns[e];T(t,"onclosenamespace",{prefix:e,uri:i})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=A.TEXT}function N(t){var e,i=t.entity,o=i.toLowerCase(),n="";return t.ENTITIES[i]?t.ENTITIES[i]:t.ENTITIES[o]?t.ENTITIES[o]:("#"===(i=o).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),n=(e=parseInt(i,16)).toString(16)):(i=i.slice(1),n=(e=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),isNaN(e)||n.toLowerCase()!==i?(M(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function F(t,e){"<"===e?(t.state=A.OPEN_WAKA,t.startTagPosition=t.position):_(e)||(M(t,"Non-whitespace before first tag."),t.textNode=e,t.state=A.TEXT)}function z(t,e){var i="";return e<t.length&&(i=t.charAt(e)),i}A=t.STATE,String.fromCodePoint||(g=String.fromCharCode,b=Math.floor,x=function(){var t,e,i=16384,o=[],n=-1,r=arguments.length;if(!r)return"";for(var s="";++n<r;){var a=Number(arguments[n]);if(!isFinite(a)||a<0||a>1114111||b(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?o.push(a):(t=55296+((a-=65536)>>10),e=a%1024+56320,o.push(t,e)),(n+1===r||o.length>i)&&(s+=g.apply(null,o),o.length=0)}return s},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:x,configurable:!0,writable:!0}):String.fromCodePoint=x)}(e)},4889:function(t,e,i){!function(t,e){"use strict";if(!t.setImmediate){var i,o,n,r,s,a=1,h={},c=!1,u=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?i=function(t){process.nextTick((function(){p(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?(r="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(r)&&p(+e.data.slice(r.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(r+e,"*")}):t.MessageChannel?((n=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){n.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(o=u.documentElement,i=function(t){var e=u.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):i=function(t){setTimeout(p,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),o=0;o<e.length;o++)e[o]=arguments[o+1];var n={callback:t,args:e};return h[a]=n,i(a),a++},l.clearImmediate=m}function m(t){delete h[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=h[t];if(e){c=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(void 0,i)}}(e)}finally{m(t),c=!1}}}}}("undefined"==typeof self?void 0===i.g?this:i.g:self)},2553:(t,e,i)=>{"use strict";var o=i(396).Buffer,n=o.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(o.isEncoding===n||!n(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=h,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=l,e=3;break;default:return this.write=m,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var o=i.charCodeAt(i.length-1);if(o>=55296&&o<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function u(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function l(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function m(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.s=r,r.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},r.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},r.prototype.text=function(t,e){var i=function(t,e,i){var o=e.length-1;if(o<i)return 0;var n=s(e[o]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--o<i||-2===n?0:(n=s(e[o]))>=0?(n>0&&(t.lastNeed=n-2),n):--o<i||-2===n?0:(n=s(e[o]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var o=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,o),t.toString("utf8",e,o)},r.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},396:(t,e,i)=>{var o=i(8764),n=o.Buffer;function r(t,e){for(var i in t)e[i]=t[i]}function s(t,e,i){return n(t,e,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=o:(r(o,e),e.Buffer=s),r(n,s),s.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return n(t,e,i)},s.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var o=n(t);return void 0!==e?"string"==typeof i?o.fill(e,i):o.fill(e):o.fill(0),o},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o.SlowBuffer(t)}},5475:function(t,e,i){var o=void 0!==i.g&&i.g||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(n.call(setTimeout,o,arguments),clearTimeout)},e.setInterval=function(){return new r(n.call(setInterval,o,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(o,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i(4889),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==i.g&&i.g.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==i.g&&i.g.clearImmediate||this&&this.clearImmediate},138:function(t,e,i){"use strict";var o=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(n,r){function s(t){try{h(o.next(t))}catch(t){r(t)}}function a(t){try{h(o.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}h((o=o.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var i,o,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};e.__esModule=!0;var r=i(3875),s=i(5590);function a(t,e){return o(this,void 0,void 0,(function(){return n(this,(function(i){switch(i.label){case 0:return[4,s.svg2planck(t,e)];case 1:return[2,h(i.sent(),r.World(),r.Transform.identity())]}}))}))}function h(t,e,i){var o;if(s.util.isShape(t))for(var n=e.createBody({position:i.p,angle:i.q.getAngle()}),a=0,c=s.converters.convertShape(t);a<c.length;a++){var u=c[a];n.createFixture(u)}else if(t.$$){(null===(o=t.$)||void 0===o?void 0:o.transform)&&(i=r.Transform.mul(i,t.$.transform));for(var l=0,m=t.$$;l<m.length;l++)h(m[l],e,i)}return e}document.getElementById("input").addEventListener("change",(function(t){return function(t){if(t){var e=new FileReader;e.onload=function(t){var e;(null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.result)&&function(t){o(this,void 0,void 0,(function(){var e;return n(this,(function(i){switch(i.label){case 0:return[4,a(t,{meterPerPixelRatio:.02,scaleY:1})];case 1:return e=i.sent(),window.planck.testbed("svg2planck",(function(t){return t.scaleY=1,e})),[2]}}))}))}(t.target.result)},e.readAsBinaryString(t)}}(t.target.files[0])}))},306:function(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},4096:function(t,e,i){(function(){"use strict";var t,o,n,r,s,a={}.hasOwnProperty;t=i(5532),o=i(8381).defaults,r=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+n(t)+"]]>"},n=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,i,n;for(e in this.options={},i=o[.2])a.call(i,e)&&(n=i[e],this.options[e]=n);for(e in t)a.call(t,e)&&(n=t[e],this.options[e]=n)}return e.prototype.buildObject=function(e){var i,n,h,c,u,l;return i=this.options.attrkey,n=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===o[.2].rootName?e=e[u=Object.keys(e)[0]]:u=this.options.rootName,l=this,h=function(t,e){var o,c,u,m,p,_;if("object"!=typeof e)l.options.cdata&&r(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(m in e)if(a.call(e,m))for(p in c=e[m])u=c[p],t=h(t.ele(p),u).up()}else for(p in e)if(a.call(e,p))if(c=e[p],p===i){if("object"==typeof c)for(o in c)_=c[o],t=t.att(o,_)}else if(p===n)t=l.options.cdata&&r(c)?t.raw(s(c)):t.txt(c);else if(Array.isArray(c))for(m in c)a.call(c,m)&&(t="string"==typeof(u=c[m])?l.options.cdata&&r(u)?t.ele(p).raw(s(u)).up():t.ele(p,u).up():h(t.ele(p),u).up());else"object"==typeof c?t=h(t.ele(p),c).up():"string"==typeof c&&l.options.cdata&&r(c)?t=t.ele(p).raw(s(c)).up():(null==c&&(c=""),t=t.ele(p,c.toString()).up());return t},c=t.create(u,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),h(c,e).end(this.options.renderOpts)},e}()}).call(this)},8381:function(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},9082:function(t,e,i){(function(){"use strict";var t,o,n,r,s,a,h,c,u=function(t,e){return function(){return t.apply(e,arguments)}},l={}.hasOwnProperty;h=i(6099),n=i(7187),t=i(306),a=i(7526),c=i(5475).setImmediate,o=i(8381).defaults,r=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},s=function(t,e,i){var o,n;for(o=0,n=t.length;o<n;o++)e=(0,t[o])(e,i);return e},e.Parser=function(i){function n(t){var i,n,r;if(this.parseStringPromise=u(this.parseStringPromise,this),this.parseString=u(this.parseString,this),this.reset=u(this.reset,this),this.assignOrPush=u(this.assignOrPush,this),this.processAsync=u(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(i in this.options={},n=o[.2])l.call(n,i)&&(r=n[i],this.options[i]=r);for(i in t)l.call(t,i)&&(r=t[i],this.options[i]=r);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(a.normalize)),this.reset()}return function(t,e){for(var i in e)l.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(n,i),n.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),c(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},n.prototype.assignOrPush=function(t,e,i){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(i)):this.options.explicitArray?t[e]=[i]:t[e]=i},n.prototype.reset=function(){var t,e,i,o,n;return this.removeAllListeners(),this.saxParser=h.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(n=this,function(t){if(n.saxParser.resume(),!n.saxParser.errThrown)return n.saxParser.errThrown=!0,n.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,o=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(i){return function(n){var r,a,h,c,u;if((h={})[e]="",!i.options.ignoreAttrs)for(r in u=n.attributes)l.call(u,r)&&(t in h||i.options.mergeAttrs||(h[t]={}),a=i.options.attrValueProcessors?s(i.options.attrValueProcessors,n.attributes[r],r):n.attributes[r],c=i.options.attrNameProcessors?s(i.options.attrNameProcessors,r):r,i.options.mergeAttrs?i.assignOrPush(h,c,a):h[t][c]=a);return h["#name"]=i.options.tagNameProcessors?s(i.options.tagNameProcessors,n.name):n.name,i.options.xmlns&&(h[i.options.xmlnskey]={uri:n.uri,local:n.local}),o.push(h)}}(this),this.saxParser.onclosetag=function(t){return function(){var i,n,a,h,c,u,m,p,_,d;if(u=o.pop(),c=u["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete u["#name"],!0===u.cdata&&(i=u.cdata,delete u.cdata),_=o[o.length-1],u[e].match(/^\s*$/)&&!i?(n=u[e],delete u[e]):(t.options.trim&&(u[e]=u[e].trim()),t.options.normalize&&(u[e]=u[e].replace(/\s{2,}/g," ").trim()),u[e]=t.options.valueProcessors?s(t.options.valueProcessors,u[e],c):u[e],1===Object.keys(u).length&&e in u&&!t.EXPLICIT_CHARKEY&&(u=u[e])),r(u)&&(u=""!==t.options.emptyTag?t.options.emptyTag:n),null!=t.options.validator&&(d="/"+function(){var t,e,i;for(i=[],t=0,e=o.length;t<e;t++)h=o[t],i.push(h["#name"]);return i}().concat(c).join("/"),function(){var e;try{u=t.options.validator(d,_&&_[c],u)}catch(i){return e=i,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof u)if(t.options.preserveChildrenOrder){if(_){for(a in _[t.options.childkey]=_[t.options.childkey]||[],m={},u)l.call(u,a)&&(m[a]=u[a]);_[t.options.childkey].push(m),delete u["#name"],1===Object.keys(u).length&&e in u&&!t.EXPLICIT_CHARKEY&&(u=u[e])}}else h={},t.options.attrkey in u&&(h[t.options.attrkey]=u[t.options.attrkey],delete u[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in u&&(h[t.options.charkey]=u[t.options.charkey],delete u[t.options.charkey]),Object.getOwnPropertyNames(u).length>0&&(h[t.options.childkey]=u),u=h;return o.length>0?t.assignOrPush(_,c,u):(t.options.explicitRoot&&(p=u,(u={})[c]=p),t.resultObject=u,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),i=function(t){return function(i){var n,r;if(r=o[o.length-1])return r[e]+=i,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==i.replace(/\\n/g,"").trim())&&(r[t.options.childkey]=r[t.options.childkey]||[],(n={"#name":"__text__"})[e]=i,t.options.normalize&&(n[e]=n[e].replace(/\s{2,}/g," ").trim()),r[t.options.childkey].push(n)),r}}(this),this.saxParser.ontext=i,this.saxParser.oncdata=function(t){var e;if(e=i(t))return e.cdata=!0}},n.prototype.parseString=function(e,i){var o;null!=i&&"function"==typeof i&&(this.on("end",(function(t){return this.reset(),i(null,t)})),this.on("error",(function(t){return this.reset(),i(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,c(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(o=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",o),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw o}},n.prototype.parseStringPromise=function(t){return new Promise((e=this,function(i,o){return e.parseString(t,(function(t,e){return t?o(t):i(e)}))}));var e},n}(n),e.parseString=function(t,i,o){var n,r;return null!=o?("function"==typeof o&&(n=o),"object"==typeof i&&(r=i)):("function"==typeof i&&(n=i),r={}),new e.Parser(r).parseString(t,n)},e.parseStringPromise=function(t,i){var o;return"object"==typeof i&&(o=i),new e.Parser(o).parseStringPromise(t)}}).call(this)},7526:function(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},5055:function(t,e,i){(function(){"use strict";var t,o,n,r,s={}.hasOwnProperty;o=i(8381),t=i(4096),n=i(9082),r=i(7526),e.defaults=o.defaults,e.processors=r,e.ValidationError=function(t){function e(t){this.message=t}return function(t,e){for(var i in e)s.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(e,Error),e}(),e.Builder=t.Builder,e.Parser=n.Parser,e.parseString=n.parseString,e.parseStringPromise=n.parseStringPromise}).call(this)},7557:function(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},9335:function(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},8369:function(t){(function(){var e,i,o,n,r,s,a,h=[].slice,c={}.hasOwnProperty;e=function(){var t,e,i,o,n,s;if(s=arguments[0],n=2<=arguments.length?h.call(arguments,1):[],r(Object.assign))Object.assign.apply(null,arguments);else for(t=0,i=n.length;t<i;t++)if(null!=(o=n[t]))for(e in o)c.call(o,e)&&(s[e]=o[e]);return s},r=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},s=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},o=function(t){return r(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},n=function(t){var e;if(o(t))return!t.length;for(e in t)if(c.call(t,e))return!1;return!0},a=function(t){var e,i;return s(t)&&(i=Object.getPrototypeOf(t))&&(e=i.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},i=function(t){return r(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=r,t.exports.isObject=s,t.exports.isArray=o,t.exports.isEmpty=n,t.exports.isPlainObject=a,t.exports.getValue=i}).call(this)},594:function(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},2750:function(t,e,i){(function(){var e;e=i(9335),i(2026),t.exports=function(){function t(t,i,o){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==i)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(o),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&t.prefix===this.prefix&&t.localName===this.localName&&t.value===this.value},t}()}).call(this)},6170:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;e=i(9335),o=i(6488),t.exports=function(t){function i(t,o){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(o)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},6488:function(t,e,i){(function(){var e,o={}.hasOwnProperty;e=i(2026),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},2096:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;e=i(9335),o=i(6488),t.exports=function(t){function i(t,o){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(o)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},383:function(t,e,i){(function(){var e,o;e=i(3933),o=i(6210),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new o(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},3933:function(t){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},1770:function(t){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},6210:function(t){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},1179:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;o=i(2026),e=i(9335),t.exports=function(t){function i(t,o,n,r,s,a){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==n)throw new Error("Missing DTD attribute name. "+this.debugInfo(o));if(!r)throw new Error("Missing DTD attribute type. "+this.debugInfo(o));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(o));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(o));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(o));this.elementName=this.stringify.name(o),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(n),this.attributeType=this.stringify.dtdAttType(r),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},6347:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;o=i(2026),e=i(9335),t.exports=function(t){function i(t,o,n){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD element name. "+this.debugInfo());n||(n="(#PCDATA)"),Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.name(o),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(n)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},9078:function(t,e,i){(function(){var e,o,n,r={}.hasOwnProperty;n=i(8369).isObject,o=i(2026),e=i(9335),t.exports=function(t){function i(t,o,r,s){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD entity name. "+this.debugInfo(r));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(r));if(this.pe=!!o,this.name=this.stringify.name(r),this.type=e.EntityDeclaration,n(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(r));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(r));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(r))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},4777:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;o=i(2026),e=i(9335),t.exports=function(t){function i(t,o,n){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD notation name. "+this.debugInfo(o));if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(o));this.name=this.stringify.name(o),this.type=e.NotationDeclaration,null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),i.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},9077:function(t,e,i){(function(){var e,o,n,r={}.hasOwnProperty;n=i(8369).isObject,o=i(2026),e=i(9335),t.exports=function(t){function i(t,o,r,s){var a;i.__super__.constructor.call(this,t),n(o)&&(o=(a=o).version,r=a.encoding,s=a.standalone),o||(o="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(o),null!=r&&(this.encoding=this.stringify.xmlEncoding(r)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},6544:function(t,e,i){(function(){var e,o,n,r,s,a,h,c,u={}.hasOwnProperty;c=i(8369).isObject,h=i(2026),e=i(9335),o=i(1179),r=i(9078),n=i(6347),s=i(4777),a=i(663),t.exports=function(t){function i(t,o,n){var r,s,a,h,u,l;if(i.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(s=0,a=(h=t.children).length;s<a;s++)if((r=h[s]).type===e.Element){this.name=r.name;break}this.documentObject=t,c(o)&&(o=(u=o).pubID,n=u.sysID),null==n&&(n=(l=[o,n])[0],o=l[1]),null!=o&&(this.pubID=this.stringify.dtdPubID(o)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(t,e){for(var i in e)u.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"entities",{get:function(){var t,i,o,n,r;for(n={},i=0,o=(r=this.children).length;i<o;i++)(t=r[i]).type!==e.EntityDeclaration||t.pe||(n[t.name]=t);return new a(n)}}),Object.defineProperty(i.prototype,"notations",{get:function(){var t,i,o,n,r;for(n={},i=0,o=(r=this.children).length;i<o;i++)(t=r[i]).type===e.NotationDeclaration&&(n[t.name]=t);return new a(n)}}),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),i.prototype.element=function(t,e){var i;return i=new n(this,t,e),this.children.push(i),this},i.prototype.attList=function(t,e,i,n,r){var s;return s=new o(this,t,e,i,n,r),this.children.push(s),this},i.prototype.entity=function(t,e){var i;return i=new r(this,!1,t,e),this.children.push(i),this},i.prototype.pEntity=function(t,e){var i;return i=new r(this,!0,t,e),this.children.push(i),this},i.prototype.notation=function(t,e){var i;return i=new s(this,t,e),this.children.push(i),this},i.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},i.prototype.ele=function(t,e){return this.element(t,e)},i.prototype.att=function(t,e,i,o,n){return this.attList(t,e,i,o,n)},i.prototype.ent=function(t,e){return this.entity(t,e)},i.prototype.pent=function(t,e){return this.pEntity(t,e)},i.prototype.not=function(t,e){return this.notation(t,e)},i.prototype.up=function(){return this.root()||this.documentObject},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.name===this.name&&t.publicId===this.publicId&&t.systemId===this.systemId},i}(h)}).call(this)},6934:function(t,e,i){(function(){var e,o,n,r,s,a,h,c={}.hasOwnProperty;h=i(8369).isPlainObject,n=i(1770),o=i(383),r=i(2026),e=i(9335),a=i(5549),s=i(6434),t.exports=function(t){function i(t){i.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new o,t||(t={}),t.writer||(t.writer=new s),this.options=t,this.stringify=new a(t)}return function(t,e){for(var i in e)c.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"implementation",{value:new n}),Object.defineProperty(i.prototype,"doctype",{get:function(){var t,i,o,n;for(i=0,o=(n=this.children).length;i<o;i++)if((t=n[i]).type===e.DocType)return t;return null}}),Object.defineProperty(i.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(i.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(i.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(i.prototype,"origin",{get:function(){return null}}),Object.defineProperty(i.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(i.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(i.prototype,"contentType",{get:function(){return null}}),i.prototype.end=function(t){var e;return e={},t?h(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},i.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},i.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.renameNode=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createNodeIterator=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTreeWalker=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(r)}).call(this)},9227:function(t,e,i){(function(){var e,o,n,r,s,a,h,c,u,l,m,p,_,d,f,y,v,g,b,x,A,w,B,T={}.hasOwnProperty;B=i(8369),A=B.isObject,x=B.isFunction,w=B.isPlainObject,b=B.getValue,e=i(9335),p=i(6934),_=i(2161),r=i(6170),s=i(2096),f=i(9406),g=i(3595),d=i(9181),l=i(9077),m=i(6544),a=i(1179),c=i(9078),h=i(6347),u=i(4777),n=i(2750),v=i(5549),y=i(6434),o=i(594),t.exports=function(){function t(t,i,o){var n;this.name="?xml",this.type=e.Document,t||(t={}),n={},t.writer?w(t.writer)&&(n=t.writer,t.writer=new y):t.writer=new y,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(n),this.stringify=new v(t),this.onDataCallback=i||function(){},this.onEndCallback=o||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var i,o,n,r,s,a,h,c;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(o in n={},h=t.attribs)T.call(h,o)&&(i=h[o],n[o]=i.value);this.node(t.name,n);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(s=0,a=(c=t.children).length;s<a;s++)r=c[s],this.createChildNode(r),r.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,i){var o;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=b(t),null==e&&(e={}),e=b(e),A(e)||(i=(o=[e,i])[0],e=o[1]),this.currentNode=new _(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=i&&this.text(i),this},t.prototype.element=function(t,i,o){var n,r,s,a,h,c;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||A(t)||x(t))for(a=this.options.noValidation,this.options.noValidation=!0,(c=new p(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,r=0,s=(h=c.children).length;r<s;r++)n=h[r],this.createChildNode(n),n.type===e.Element&&this.up();else this.node(t,i,o);return this},t.prototype.attribute=function(t,e){var i,o;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=b(t)),A(t))for(i in t)T.call(t,i)&&(o=t[i],this.attribute(i,o));else x(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new n(this,t,""):null!=e&&(this.currentNode.attribs[t]=new n(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new g(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new r(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new f(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var i,o,n,r,s;if(this.openCurrent(),null!=t&&(t=b(t)),null!=e&&(e=b(e)),Array.isArray(t))for(i=0,r=t.length;i<r;i++)o=t[i],this.instruction(o);else if(A(t))for(o in t)T.call(t,o)&&(n=t[o],this.instruction(o,n));else x(e)&&(e=e.apply()),s=new d(this,t,e),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,i){var o;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return o=new l(this,t,e,i),this.onData(this.writer.declaration(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,i){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new m(this,e,i),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var i;return this.openCurrent(),i=new h(this,t,e),this.onData(this.writer.dtdElement(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,i,o,n){var r;return this.openCurrent(),r=new a(this,t,e,i,o,n),this.onData(this.writer.dtdAttList(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var i;return this.openCurrent(),i=new c(this,!1,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var i;return this.openCurrent(),i=new c(this,!0,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var i;return this.openCurrent(),i=new u(this,t,e),this.onData(this.writer.dtdNotation(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var i,n,r,s;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),n="",t.type===e.Element){for(r in this.writerOptions.state=o.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,s=t.attribs)T.call(s,r)&&(i=s[r],n+=this.writer.attribute(i,this.writerOptions,this.currentLevel));n+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=o.InsideTag}else this.writerOptions.state=o.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.children?(n+=" [",this.writerOptions.state=o.InsideTag):(this.writerOptions.state=o.CloseTag,n+=">"),n+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(n,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var i;if(!t.isClosed)return"",this.writerOptions.state=o.CloseTag,i=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=o.None,this.onData(i,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.dtd=function(t,e,i){return this.doctype(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},8833:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;o=i(2026),e=i(9335),t.exports=function(t){function i(t){i.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return""},i}(o)}).call(this)},2161:function(t,e,i){(function(){var e,o,n,r,s,a,h,c,u={}.hasOwnProperty;c=i(8369),h=c.isObject,a=c.isFunction,s=c.getValue,r=i(2026),e=i(9335),o=i(2750),n=i(663),t.exports=function(t){function i(t,o,n){var r,s,a,h;if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(o),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=n&&this.attribute(n),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,a=(h=t.children).length;s<a;s++)if((r=h[s]).type===e.DocType){r.name=this.name;break}}return function(t,e){for(var i in e)u.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(i.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(i.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),i.prototype.clone=function(){var t,e,i,o;for(e in(i=Object.create(this)).isRoot&&(i.documentObject=null),i.attribs={},o=this.attribs)u.call(o,e)&&(t=o[e],i.attribs[e]=t.clone());return i.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=i,i.children.push(e)})),i},i.prototype.attribute=function(t,e){var i,n;if(null!=t&&(t=s(t)),h(t))for(i in t)u.call(t,i)&&(n=t[i],this.attribute(i,n));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new o(this,t,""):null!=e&&(this.attribs[t]=new o(this,t,e));return this},i.prototype.removeAttribute=function(t){var e,i,o;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(i=0,o=t.length;i<o;i++)e=t[i],delete this.attribs[e];else delete this.attribs[t];return this},i.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},i.prototype.att=function(t,e){return this.attribute(t,e)},i.prototype.a=function(t,e){return this.attribute(t,e)},i.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},i.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},i.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},i.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},i.prototype.setIdAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.isEqualNode=function(t){var e,o,n;if(!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=o=0,n=this.attribs.length-1;0<=n?o<=n:o>=n;e=0<=n?++o:--o)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},i}(r)}).call(this)},663:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},2026:function(t,e,i){(function(){var e,o,n,r,s,a,h,c,u,l,m,p,_,d,f,y,v,g={}.hasOwnProperty;v=i(8369),y=v.isObject,f=v.isFunction,d=v.isEmpty,_=v.getValue,c=null,n=null,r=null,s=null,a=null,m=null,p=null,l=null,h=null,o=null,u=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,c||(c=i(2161),n=i(6170),r=i(2096),s=i(9077),a=i(6544),m=i(9406),p=i(3595),l=i(9181),h=i(8833),o=i(9335),u=i(2390),i(663),e=i(7557))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,i,n,r;if(this.nodeType===o.Element||this.nodeType===o.DocumentFragment){for(r="",e=0,i=(n=this.children).length;e<i;e++)(t=n[e]).textContent&&(r+=t.textContent);return r}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,i,o,n,r;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),r=[],i=0,o=(n=this.children).length;i<o;i++)e=n[i],r.push(e.setParent(this));return r},t.prototype.element=function(t,e,i){var o,n,r,s,a,h,c,u,l,m,p;if(h=null,null===e&&null==i&&(e=(l=[{},null])[0],i=l[1]),null==e&&(e={}),e=_(e),y(e)||(i=(m=[e,i])[0],e=m[1]),null!=t&&(t=_(t)),Array.isArray(t))for(r=0,c=t.length;r<c;r++)n=t[r],h=this.element(n);else if(f(t))h=this.element(t.apply());else if(y(t)){for(a in t)if(g.call(t,a))if(p=t[a],f(p)&&(p=p.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))h=this.attribute(a.substr(this.stringify.convertAttKey.length),p);else if(!this.options.separateArrayItems&&Array.isArray(p)&&d(p))h=this.dummy();else if(y(p)&&d(p))h=this.element(a);else if(this.options.keepNullNodes||null!=p)if(!this.options.separateArrayItems&&Array.isArray(p))for(s=0,u=p.length;s<u;s++)n=p[s],(o={})[a]=n,h=this.element(o);else y(p)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?h=this.element(p):(h=this.element(a)).element(p):h=this.element(a,p);else h=this.dummy()}else h=this.options.keepNullNodes||null!==i?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(i):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(i):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(i):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(i):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),i):this.node(t,e,i):this.dummy();if(null==h)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return h},t.prototype.insertBefore=function(t,e,i){var o,n,r,s,a;if(null!=t?t.type:void 0)return s=e,(r=t).setParent(this),s?(n=children.indexOf(s),a=children.splice(n),children.push(r),Array.prototype.push.apply(children,a)):children.push(r),r;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),a=this.parent.children.splice(n),o=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,a),o},t.prototype.insertAfter=function(t,e,i){var o,n,r;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n+1),o=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,r),o},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,i){var o,n;return null!=t&&(t=_(t)),e||(e={}),e=_(e),y(e)||(i=(n=[e,i])[0],e=n[1]),o=new c(this,t,e),null!=i&&o.text(i),this.children.push(o),o},t.prototype.text=function(t){var e;return y(t)&&this.element(t),e=new p(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new n(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new r(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.commentAfter=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.raw=function(t){var e;return e=new m(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new h(this)},t.prototype.instruction=function(t,e){var i,o,n,r,s;if(null!=t&&(t=_(t)),null!=e&&(e=_(e)),Array.isArray(t))for(r=0,s=t.length;r<s;r++)i=t[r],this.instruction(i);else if(y(t))for(i in t)g.call(t,i)&&(o=t[i],this.instruction(i,o));else f(e)&&(e=e.apply()),n=new l(this,t,e),this.children.push(n);return this},t.prototype.instructionBefore=function(t,e){var i,o;return i=this.parent.children.indexOf(this),o=this.parent.children.splice(i),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,o),this},t.prototype.instructionAfter=function(t,e){var i,o;return i=this.parent.children.indexOf(this),o=this.parent.children.splice(i+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,o),this},t.prototype.declaration=function(t,e,i){var n,r;return n=this.document(),r=new s(n,t,e,i),0===n.children.length?n.children.unshift(r):n.children[0].type===o.Declaration?n.children[0]=r:n.children.unshift(r),n.root()||n},t.prototype.dtd=function(t,e){var i,n,r,s,h,c,u,l,m;for(i=this.document(),n=new a(i,t,e),r=s=0,c=(l=i.children).length;s<c;r=++s)if(l[r].type===o.DocType)return i.children[r]=n,n;for(r=h=0,u=(m=i.children).length;h<u;r=++h)if(m[r].isRoot)return i.children.splice(r,0,n),n;return i.children.push(n),n},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===o.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===o.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,i;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(i=this.parent)?i.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,i){return this.element(t,e,i)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var i,o;return(i=this)===t?0:this.document()!==t.document()?(o=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?o|=e.Preceding:o|=e.Following,o):i.isAncestor(t)?e.Contains|e.Preceding:i.isDescendant(t)?e.Contains|e.Following:i.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,i,o;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=i=0,o=this.children.length-1;0<=o?i<=o:i>=o;e=0<=o?++i:--i)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,i,o,n;for(i=0,o=(n=this.children).length;i<o;i++){if(t===(e=n[i]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e<i},t.prototype.isFollowing=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e>i},t.prototype.treePosition=function(t){var e,i;return i=0,e=!1,this.foreachTreeNode(this.document(),(function(o){if(i++,!e&&o===t)return e=!0})),e?i:-1},t.prototype.foreachTreeNode=function(t,e){var i,o,n,r,s;for(t||(t=this.document()),o=0,n=(r=t.children).length;o<n;o++){if(s=e(i=r[o]))return s;if(s=this.foreachTreeNode(i,e))return s}},t}()}).call(this)},2390:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},9181:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;e=i(9335),o=i(6488),t.exports=function(t){function i(t,o,n){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(o),this.name=this.target,n&&(this.value=this.stringify.insValue(n))}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},i}(o)}).call(this)},9406:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;e=i(9335),o=i(2026),t.exports=function(t){function i(t,o){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(o)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},i}(o)}).call(this)},1996:function(t,e,i){(function(){var e,o,n,r={}.hasOwnProperty;e=i(9335),n=i(751),o=i(594),t.exports=function(t){function i(t,e){this.stream=t,i.__super__.constructor.call(this,e)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),i.prototype.endline=function(t,e,n){return t.isLastRootNode&&e.state===o.CloseTag?"":i.__super__.endline.call(this,t,e,n)},i.prototype.document=function(t,e){var i,o,n,r,s,a,h,c,u;for(o=n=0,s=(h=t.children).length;n<s;o=++n)(i=h[o]).isLastRootNode=o===t.children.length-1;for(e=this.filterOptions(e),u=[],r=0,a=(c=t.children).length;r<a;r++)i=c[r],u.push(this.writeChildNode(i,e,0));return u},i.prototype.attribute=function(t,e,o){return this.stream.write(i.__super__.attribute.call(this,t,e,o))},i.prototype.cdata=function(t,e,o){return this.stream.write(i.__super__.cdata.call(this,t,e,o))},i.prototype.comment=function(t,e,o){return this.stream.write(i.__super__.comment.call(this,t,e,o))},i.prototype.declaration=function(t,e,o){return this.stream.write(i.__super__.declaration.call(this,t,e,o))},i.prototype.docType=function(t,e,i){var n,r,s,a;if(i||(i=0),this.openNode(t,e,i),e.state=o.OpenTag,this.stream.write(this.indent(t,e,i)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,i)),e.state=o.InsideTag,r=0,s=(a=t.children).length;r<s;r++)n=a[r],this.writeChildNode(n,e,i+1);e.state=o.CloseTag,this.stream.write("]")}return e.state=o.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,i)),e.state=o.None,this.closeNode(t,e,i)},i.prototype.element=function(t,i,n){var s,a,h,c,u,l,m,p,_;for(m in n||(n=0),this.openNode(t,i,n),i.state=o.OpenTag,this.stream.write(this.indent(t,i,n)+"<"+t.name),p=t.attribs)r.call(p,m)&&(s=p[m],this.attribute(s,i,n));if(c=0===(h=t.children.length)?null:t.children[0],0===h||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(this.stream.write(">"),i.state=o.CloseTag,this.stream.write("</"+t.name+">")):(i.state=o.CloseTag,this.stream.write(i.spaceBeforeSlash+"/>"));else if(!i.pretty||1!==h||c.type!==e.Text&&c.type!==e.Raw||null==c.value){for(this.stream.write(">"+this.endline(t,i,n)),i.state=o.InsideTag,u=0,l=(_=t.children).length;u<l;u++)a=_[u],this.writeChildNode(a,i,n+1);i.state=o.CloseTag,this.stream.write(this.indent(t,i,n)+"</"+t.name+">")}else this.stream.write(">"),i.state=o.InsideTag,i.suppressPrettyCount++,this.writeChildNode(c,i,n+1),i.suppressPrettyCount--,i.state=o.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,i,n)),i.state=o.None,this.closeNode(t,i,n)},i.prototype.processingInstruction=function(t,e,o){return this.stream.write(i.__super__.processingInstruction.call(this,t,e,o))},i.prototype.raw=function(t,e,o){return this.stream.write(i.__super__.raw.call(this,t,e,o))},i.prototype.text=function(t,e,o){return this.stream.write(i.__super__.text.call(this,t,e,o))},i.prototype.dtdAttList=function(t,e,o){return this.stream.write(i.__super__.dtdAttList.call(this,t,e,o))},i.prototype.dtdElement=function(t,e,o){return this.stream.write(i.__super__.dtdElement.call(this,t,e,o))},i.prototype.dtdEntity=function(t,e,o){return this.stream.write(i.__super__.dtdEntity.call(this,t,e,o))},i.prototype.dtdNotation=function(t,e,o){return this.stream.write(i.__super__.dtdNotation.call(this,t,e,o))},i}(n)}).call(this)},6434:function(t,e,i){(function(){var e,o={}.hasOwnProperty;e=i(751),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var i,o,n,r,s;for(e=this.filterOptions(e),r="",o=0,n=(s=t.children).length;o<n;o++)i=s[o],r+=this.writeChildNode(i,e,0);return e.pretty&&r.slice(-e.newline.length)===e.newline&&(r=r.slice(0,-e.newline.length)),r},e}(e)}).call(this)},5549:function(t){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty;t.exports=function(){function t(t){var o,n,r;for(o in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),n=t.stringify||{})i.call(n,o)&&(r=n[o],this[o]=r)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,i;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+i.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+i.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},3595:function(t,e,i){(function(){var e,o,n={}.hasOwnProperty;e=i(9335),o=i(6488),t.exports=function(t){function i(t,o){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(o)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"wholeText",{get:function(){var t,e,i;for(i="",e=this.previousSibling;e;)i=e.data+i,e=e.previousSibling;for(i+=this.data,t=this.nextSibling;t;)i+=t.data,t=t.nextSibling;return i}}),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},i.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(o)}).call(this)},751:function(t,e,i){(function(){var e,o,n,r={}.hasOwnProperty;n=i(8369).assign,e=i(9335),i(9077),i(6544),i(6170),i(2096),i(2161),i(9406),i(3595),i(9181),i(8833),i(1179),i(6347),i(9078),i(4777),o=i(594),t.exports=function(){function t(t){var e,i,o;for(e in t||(t={}),this.options=t,i=t.writer||{})r.call(i,e)&&(o=i[e],this["_"+e]=this[e],this[e]=o)}return t.prototype.filterOptions=function(t){var e,i,r,s,a,h,c,u;return t||(t={}),t=n({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(i=t.indent)?i:"  ",e.newline=null!=(r=t.newline)?r:"\n",e.offset=null!=(s=t.offset)?s:0,e.dontPrettyTextNodes=null!=(a=null!=(h=t.dontPrettyTextNodes)?h:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(c=null!=(u=t.spaceBeforeSlash)?u:t.spacebeforeslash)?c:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=o.None,e},t.prototype.indent=function(t,e,i){var o;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(o=(i||0)+e.offset+1)>0?new Array(o).join(e.indent):""},t.prototype.endline=function(t,e,i){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,i){var o;return this.openAttribute(t,e,i),o=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,i),o},t.prototype.cdata=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<![CDATA[",e.state=o.InsideTag,n+=t.value,e.state=o.CloseTag,n+="]]>"+this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.comment=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"\x3c!-- ",e.state=o.InsideTag,n+=t.value,e.state=o.CloseTag,n+=" --\x3e"+this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.declaration=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<?xml",e.state=o.InsideTag,n+=' version="'+t.version+'"',null!=t.encoding&&(n+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(n+=' standalone="'+t.standalone+'"'),e.state=o.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.docType=function(t,e,i){var n,r,s,a,h;if(i||(i=0),this.openNode(t,e,i),e.state=o.OpenTag,a=this.indent(t,e,i),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,i),e.state=o.InsideTag,r=0,s=(h=t.children).length;r<s;r++)n=h[r],a+=this.writeChildNode(n,e,i+1);e.state=o.CloseTag,a+="]"}return e.state=o.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),a},t.prototype.element=function(t,i,n){var s,a,h,c,u,l,m,p,_,d,f,y,v,g;for(_ in n||(n=0),d=!1,f="",this.openNode(t,i,n),i.state=o.OpenTag,f+=this.indent(t,i,n)+"<"+t.name,y=t.attribs)r.call(y,_)&&(s=y[_],f+=this.attribute(s,i,n));if(c=0===(h=t.children.length)?null:t.children[0],0===h||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(f+=">",i.state=o.CloseTag,f+="</"+t.name+">"+this.endline(t,i,n)):(i.state=o.CloseTag,f+=i.spaceBeforeSlash+"/>"+this.endline(t,i,n));else if(!i.pretty||1!==h||c.type!==e.Text&&c.type!==e.Raw||null==c.value){if(i.dontPrettyTextNodes)for(u=0,m=(v=t.children).length;u<m;u++)if(((a=v[u]).type===e.Text||a.type===e.Raw)&&null!=a.value){i.suppressPrettyCount++,d=!0;break}for(f+=">"+this.endline(t,i,n),i.state=o.InsideTag,l=0,p=(g=t.children).length;l<p;l++)a=g[l],f+=this.writeChildNode(a,i,n+1);i.state=o.CloseTag,f+=this.indent(t,i,n)+"</"+t.name+">",d&&i.suppressPrettyCount--,f+=this.endline(t,i,n),i.state=o.None}else f+=">",i.state=o.InsideTag,i.suppressPrettyCount++,d=!0,f+=this.writeChildNode(c,i,n+1),i.suppressPrettyCount--,d=!1,i.state=o.CloseTag,f+="</"+t.name+">"+this.endline(t,i,n);return this.closeNode(t,i,n),f},t.prototype.writeChildNode=function(t,i,o){switch(t.type){case e.CData:return this.cdata(t,i,o);case e.Comment:return this.comment(t,i,o);case e.Element:return this.element(t,i,o);case e.Raw:return this.raw(t,i,o);case e.Text:return this.text(t,i,o);case e.ProcessingInstruction:return this.processingInstruction(t,i,o);case e.Dummy:return"";case e.Declaration:return this.declaration(t,i,o);case e.DocType:return this.docType(t,i,o);case e.AttributeDeclaration:return this.dtdAttList(t,i,o);case e.ElementDeclaration:return this.dtdElement(t,i,o);case e.EntityDeclaration:return this.dtdEntity(t,i,o);case e.NotationDeclaration:return this.dtdNotation(t,i,o);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<?",e.state=o.InsideTag,n+=t.target,t.value&&(n+=" "+t.value),e.state=o.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.raw=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i),e.state=o.InsideTag,n+=t.value,e.state=o.CloseTag,n+=this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.text=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i),e.state=o.InsideTag,n+=t.value,e.state=o.CloseTag,n+=this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.dtdAttList=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<!ATTLIST",e.state=o.InsideTag,n+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(n+=" "+t.defaultValueType),t.defaultValue&&(n+=' "'+t.defaultValue+'"'),e.state=o.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.dtdElement=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<!ELEMENT",e.state=o.InsideTag,n+=" "+t.name+" "+t.value,e.state=o.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.dtdEntity=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<!ENTITY",e.state=o.InsideTag,t.pe&&(n+=" %"),n+=" "+t.name,t.value?n+=' "'+t.value+'"':(t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.nData&&(n+=" NDATA "+t.nData)),e.state=o.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.dtdNotation=function(t,e,i){var n;return this.openNode(t,e,i),e.state=o.OpenTag,n=this.indent(t,e,i)+"<!NOTATION",e.state=o.InsideTag,n+=" "+t.name,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?n+=' PUBLIC "'+t.pubID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),e.state=o.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=o.None,this.closeNode(t,e,i),n},t.prototype.openNode=function(t,e,i){},t.prototype.closeNode=function(t,e,i){},t.prototype.openAttribute=function(t,e,i){},t.prototype.closeAttribute=function(t,e,i){},t}()}).call(this)},5532:function(t,e,i){(function(){var e,o,n,r,s,a,h,c,u,l;l=i(8369),c=l.assign,u=l.isFunction,n=i(1770),r=i(6934),s=i(9227),h=i(6434),a=i(1996),e=i(9335),o=i(594),t.exports.create=function(t,e,i,o){var n,s;if(null==t)throw new Error("Root element needs a name.");return o=c({},e,i,o),s=(n=new r(o)).element(t),o.headless||(n.declaration(o),null==o.pubID&&null==o.sysID||n.dtd(o)),s},t.exports.begin=function(t,e,i){var o;return u(t)&&(e=(o=[t,e])[0],i=o[1],t={}),e?new s(t,e,i):new r(t)},t.exports.stringWriter=function(t){return new h(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new n,t.exports.nodeType=e,t.exports.writerState=o}).call(this)}},e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={exports:{}};return t[o].call(n.exports,n,n.exports,i),n.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i(138)})();
//# sourceMappingURL=bundle.js.map